<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>INSLooselyCoupledKalmanEpochEstimator.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">com.irurueta:irurueta-navigation</a> &gt; <a href="index.source.html" class="el_package">com.irurueta.navigation.inertial</a> &gt; <span class="el_source">INSLooselyCoupledKalmanEpochEstimator.java</span></div><h1>INSLooselyCoupledKalmanEpochEstimator.java</h1><pre class="source lang-java linenums">/*
 * Copyright (C) 2019 Alberto Irurueta Carro (alberto@irurueta.com)
 *
 * Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *         http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
package com.irurueta.navigation.inertial;

import com.irurueta.algebra.AlgebraException;
import com.irurueta.algebra.Matrix;
import com.irurueta.algebra.Utils;
import com.irurueta.geometry.Point3D;
import com.irurueta.navigation.frames.converters.ECEFtoNEDPositionVelocityConverter;
import com.irurueta.navigation.geodesic.Constants;
import com.irurueta.navigation.gnss.ECEFPositionAndVelocity;
import com.irurueta.navigation.inertial.estimators.ECEFGravityEstimator;
import com.irurueta.units.Time;
import com.irurueta.units.TimeConverter;
import com.irurueta.units.TimeUnit;

/**
 * Implements one cycle of the loosely coupled INS/GNSS
 * Kalman filter plus closed-loop correction of all inertial states.
 * This implementation is based on the equations defined in &quot;Principles of GNSS, Inertial, and Multisensor
 * Integrated Navigation Systems, Second Edition&quot; and on the companion software available at:
 * https://github.com/ymjdz/MATLAB-Codes/blob/master/LC_KF_Epoch.m
 */
<span class="nc" id="L37">public class INSLooselyCoupledKalmanEpochEstimator {</span>

    /**
     * Speed of light in the vacuum expressed in meters per second (m/s).
     */
    public static final double SPEED_OF_LIGHT = Constants.SPEED_OF_LIGHT;

    /**
     * Earth rotation rate expressed in radians per second (rad/s).
     */
    public static final double EARTH_ROTATION_RATE = Constants.EARTH_ROTATION_RATE;

    /**
     * The equatorial radius of WGS84 ellipsoid (6378137 m) defining Earth's shape.
     */
    public static final double EARTH_EQUATORIAL_RADIUS_WGS84 = Constants.EARTH_EQUATORIAL_RADIUS_WGS84;

    /**
     * Earth eccentricity as defined on the WGS84 ellipsoid.
     */
    public static final double EARTH_ECCENTRICITY = Constants.EARTH_ECCENTRICITY;

    /**
     * Number of components of position + velocity.
     */
    private static final int POS_AND_VEL_COMPONENTS = 6;

    /**
     * Estimates the update of Kalman filter state for a single epoch.
     *
     * @param userPosition        ECEF user position.
     * @param userVelocity        ECEF user velocity.
     * @param propagationInterval propagation interval expressed in seconds (s).
     * @param previousState       previous Kalman filter state.
     * @param bodyKinematics      body kinematics containing measured specific force
     *                            resolved along body frame axes.
     * @param config              Loosely Coupled Kalman filter configuration.
     * @return new state of Kalman filter.
     * @throws AlgebraException if there are numerical instabilities.
     */
    public static INSLooselyCoupledKalmanState estimate(
            final ECEFPosition userPosition,
            final ECEFVelocity userVelocity,
            final double propagationInterval,
            final INSLooselyCoupledKalmanState previousState,
            final BodyKinematics bodyKinematics,
            final INSLooselyCoupledKalmanConfig config) throws AlgebraException {
<span class="fc" id="L84">        final INSLooselyCoupledKalmanState result = new INSLooselyCoupledKalmanState();</span>
<span class="fc" id="L85">        estimate(userPosition, userVelocity, propagationInterval, previousState,</span>
                bodyKinematics, config, result);
<span class="fc" id="L87">        return result;</span>
    }

    /**
     * Estimates the update of Kalman filter state for a single epoch.
     *
     * @param userPosition        ECEF user position.
     * @param userVelocity        ECEF user velocity.
     * @param propagationInterval propagation interval expressed in seconds (s).
     * @param previousState       previous Kalman filter state.
     * @param bodyKinematics      body kinematics containing measured specific force
     *                            resolved along body frame axes.
     * @param config              Loosely Coupled Kalman filter configuration.
     * @param result              instance where new state of Kalman filter will be
     *                            stored.
     * @throws AlgebraException if there are numerical instabilities.
     */
    public static void estimate(
            final ECEFPosition userPosition,
            final ECEFVelocity userVelocity,
            final double propagationInterval,
            final INSLooselyCoupledKalmanState previousState,
            final BodyKinematics bodyKinematics,
            final INSLooselyCoupledKalmanConfig config,
            final INSLooselyCoupledKalmanState result) throws AlgebraException {

<span class="fc" id="L113">        final double fx = bodyKinematics.getFx();</span>
<span class="fc" id="L114">        final double fy = bodyKinematics.getFy();</span>
<span class="fc" id="L115">        final double fz = bodyKinematics.getFz();</span>

<span class="fc" id="L117">        estimate(userPosition, userVelocity, propagationInterval, previousState,</span>
                fx, fy, fz, config, result);
<span class="fc" id="L119">    }</span>

    /**
     * Estimates the update of Kalman filter state for a single epoch.
     *
     * @param userPosition        ECEF user position.
     * @param userVelocity        ECEF user velocity.
     * @param propagationInterval propagation interval expressed in seconds (s).
     * @param previousState       previous Kalman filter state.
     * @param bodyKinematics      body kinematics containing measured specific force
     *                            resolved along body frame axes.
     * @param previousLatitude    previous latitude solution expressed in radians (rad).
     * @param config              Loosely Coupled Kalman filter configuration.
     * @return new state of Kalman filter.
     * @throws AlgebraException if there are numerical instabilities.
     */
    public static INSLooselyCoupledKalmanState estimate(
            final ECEFPosition userPosition,
            final ECEFVelocity userVelocity,
            final double propagationInterval,
            final INSLooselyCoupledKalmanState previousState,
            final BodyKinematics bodyKinematics,
            final double previousLatitude,
            final INSLooselyCoupledKalmanConfig config) throws AlgebraException {
<span class="fc" id="L143">        final INSLooselyCoupledKalmanState result = new INSLooselyCoupledKalmanState();</span>
<span class="fc" id="L144">        estimate(userPosition, userVelocity, propagationInterval, previousState,</span>
                bodyKinematics, previousLatitude, config, result);
<span class="fc" id="L146">        return result;</span>
    }

    /**
     * Estimates the update of Kalman filter state for a single epoch.
     *
     * @param userPosition        ECEF user position.
     * @param userVelocity        ECEF user velocity.
     * @param propagationInterval propagation interval expressed in seconds (s).
     * @param previousState       previous Kalman filter state.
     * @param bodyKinematics      body kinematics containing measured specific force
     *                            resolved along body frame axes.
     * @param previousLatitude    previous latitude solution expressed in radians (rad).
     * @param config              Loosely Coupled Kalman filter configuration.
     * @param result              instance where new state of Kalman filter will be
     *                            stored.
     * @throws AlgebraException if there are numerical instabilities.
     */
    public static void estimate(
            final ECEFPosition userPosition,
            final ECEFVelocity userVelocity,
            final double propagationInterval,
            final INSLooselyCoupledKalmanState previousState,
            final BodyKinematics bodyKinematics,
            final double previousLatitude,
            final INSLooselyCoupledKalmanConfig config,
            final INSLooselyCoupledKalmanState result) throws AlgebraException {

<span class="fc" id="L174">        final double fx = bodyKinematics.getFx();</span>
<span class="fc" id="L175">        final double fy = bodyKinematics.getFy();</span>
<span class="fc" id="L176">        final double fz = bodyKinematics.getFz();</span>

<span class="fc" id="L178">        estimate(userPosition, userVelocity, propagationInterval, previousState,</span>
                fx, fy, fz, previousLatitude, config, result);
<span class="fc" id="L180">    }</span>

    /**
     * Estimates the update of Kalman filter state for a single epoch.
     *
     * @param userPosition        ECEF user position.
     * @param userVelocity        ECEF user velocity.
     * @param propagationInterval propagation interval expressed in seconds (s).
     * @param previousState       previous Kalman filter state.
     * @param fx                  measured specific force resolved along body frame
     *                            x-axis and expressed in meters per squared
     *                            second (m/s^2).
     * @param fy                  measured specific force resolved along body frame
     *                            y-axis and expressed in meters per squared
     *                            second (m/s^2).
     * @param fz                  measured specific force resolved along body frame
     *                            z-axis and expressed in meters per squared
     *                            second (m/s^2).
     * @param config              Loosely Coupled Kalman filter configuration.
     * @return new state of Kalman filter.
     * @throws AlgebraException if there are numerical instabilities.
     */
    public static INSLooselyCoupledKalmanState estimate(
            final ECEFPosition userPosition,
            final ECEFVelocity userVelocity,
            final double propagationInterval,
            final INSLooselyCoupledKalmanState previousState,
            final double fx, final double fy, final double fz,
            final INSLooselyCoupledKalmanConfig config) throws AlgebraException {
<span class="fc" id="L209">        final INSLooselyCoupledKalmanState result = new INSLooselyCoupledKalmanState();</span>
<span class="fc" id="L210">        estimate(userPosition, userVelocity, propagationInterval,</span>
                previousState, fx, fy, fz, config, result);
<span class="fc" id="L212">        return result;</span>
    }

    /**
     * Estimates the update of Kalman filter state for a single epoch.
     *
     * @param userPosition        ECEF user position.
     * @param userVelocity        ECEF user velocity.
     * @param propagationInterval propagation interval expressed in seconds (s).
     * @param previousState       previous Kalman filter state.
     * @param fx                  measured specific force resolved along body frame
     *                            x-axis and expressed in meters per squared
     *                            second (m/s^2).
     * @param fy                  measured specific force resolved along body frame
     *                            y-axis and expressed in meters per squared
     *                            second (m/s^2).
     * @param fz                  measured specific force resolved along body frame
     *                            z-axis and expressed in meters per squared
     *                            second (m/s^2).
     * @param config              Loosely Coupled Kalman filter configuration.
     * @param result              instance where new state of Kalman filter will be
     *                            stored.
     * @throws AlgebraException if there are numerical instabilities.
     */
    public static void estimate(
            final ECEFPosition userPosition,
            final ECEFVelocity userVelocity,
            final double propagationInterval,
            final INSLooselyCoupledKalmanState previousState,
            final double fx, final double fy, final double fz,
            final INSLooselyCoupledKalmanConfig config,
            final INSLooselyCoupledKalmanState result) throws AlgebraException {

<span class="fc" id="L245">        final double x = userPosition.getX();</span>
<span class="fc" id="L246">        final double y = userPosition.getY();</span>
<span class="fc" id="L247">        final double z = userPosition.getZ();</span>

<span class="fc" id="L249">        final double vx = userVelocity.getVx();</span>
<span class="fc" id="L250">        final double vy = userVelocity.getVy();</span>
<span class="fc" id="L251">        final double vz = userVelocity.getVz();</span>

<span class="fc" id="L253">        estimate(x, y, z, vx, vy, vz, propagationInterval, previousState,</span>
                fx, fy, fz, config, result);
<span class="fc" id="L255">    }</span>

    /**
     * Estimated the update of Kalman filter state for a single epoch.
     *
     * @param userPosition        ECEF user position.
     * @param userVelocity        ECEF user velocity.
     * @param propagationInterval propagation interval expressed in seconds (s).
     * @param previousState       previous Kalman filter state.
     * @param fx                  measured specific force resolved along body frame
     *                            x-axis and expressed in meters per squared
     *                            second (m/s^2).
     * @param fy                  measured specific force resolved along body frame
     *                            y-axis and expressed in meters per squared
     *                            second (m/s^2).
     * @param fz                  measured specific force resolved along body frame
     *                            z-axis and expressed in meters per squared
     *                            second (m/s^2).
     * @param previousLatitude    previous latitude solution expressed in radians (rad).
     * @param config              Loosely Coupled Kalman filter configuration.
     * @return new state of Kalman filter
     * @throws AlgebraException if there are numerical instabilities.
     */
    public static INSLooselyCoupledKalmanState estimate(
            final ECEFPosition userPosition,
            final ECEFVelocity userVelocity,
            final double propagationInterval,
            final INSLooselyCoupledKalmanState previousState,
            final double fx, final double fy, final double fz,
            final double previousLatitude,
            final INSLooselyCoupledKalmanConfig config) throws AlgebraException {
<span class="fc" id="L286">        final INSLooselyCoupledKalmanState result = new INSLooselyCoupledKalmanState();</span>
<span class="fc" id="L287">        estimate(userPosition, userVelocity, propagationInterval, previousState,</span>
                fx, fy, fz, previousLatitude, config, result);
<span class="fc" id="L289">        return result;</span>
    }

    /**
     * Estimates the update of Kalman filter state for a single epoch.
     *
     * @param userPosition        GNSS estimated ECEF user position.
     * @param userVelocity        GNSS estimated ECEF user velocity.
     * @param propagationInterval propagation interval expressed in seconds (s).
     * @param previousState       previous Kalman filter state.
     * @param fx                  measured specific force resolved along body frame
     *                            x-axis and expressed in meters per squared
     *                            second (m/s^2).
     * @param fy                  measured specific force resolved along body frame
     *                            y-axis and expressed in meters per squared
     *                            second (m/s^2).
     * @param fz                  measured specific force resolved along body frame
     *                            z-axis and expressed in meters per squared
     *                            second (m/s^2).
     * @param previousLatitude    previous latitude solution expressed in radians (rad).
     * @param config              Loosely Coupled Kalman filter configuration.
     * @param result              instance where new state of Kalman filter will be
     *                            stored.
     * @throws AlgebraException if there are numerical instabilities.
     */
    public static void estimate(
            final ECEFPosition userPosition,
            final ECEFVelocity userVelocity,
            final double propagationInterval,
            final INSLooselyCoupledKalmanState previousState,
            final double fx, final double fy, final double fz,
            final double previousLatitude,
            final INSLooselyCoupledKalmanConfig config,
            final INSLooselyCoupledKalmanState result) throws AlgebraException {

<span class="fc" id="L324">        final double x = userPosition.getX();</span>
<span class="fc" id="L325">        final double y = userPosition.getY();</span>
<span class="fc" id="L326">        final double z = userPosition.getZ();</span>

<span class="fc" id="L328">        final double vx = userVelocity.getVx();</span>
<span class="fc" id="L329">        final double vy = userVelocity.getVy();</span>
<span class="fc" id="L330">        final double vz = userVelocity.getVz();</span>

<span class="fc" id="L332">        estimate(x, y, z, vx, vy, vz, propagationInterval, previousState,</span>
                fx, fy, fz, previousLatitude, config, result);
<span class="fc" id="L334">    }</span>

    /**
     * Estimates the update of Kalman filter state for a single epoch.
     *
     * @param x                   ECEF x coordinate of user position expressed in
     *                            meters (m).
     * @param y                   ECEF y coordinate of user position expressed in
     *                            meters (m).
     * @param z                   ECEF z coordinate of user position expressed in
     *                            meters (m).
     * @param vx                  ECEF x coordinate of user velocity expressed in
     *                            meters per second (m/s).
     * @param vy                  ECEF y coordinate of user velocity expressed in
     *                            meters per second (m/s).
     * @param vz                  ECEF z coordinate of user velocity expressed in
     *                            meters per second (m/s).
     * @param propagationInterval propagation interval expressed in seconds (s).
     * @param previousState       previous Kalman filter state.
     * @param bodyKinematics      body kinematics containing measured specific force
     *                            resolved along body frame axes.
     * @param config              Loosely Coupled Kalman filter configuration.
     * @return new state of Kalman filter.
     * @throws AlgebraException if there are numerical instabilities.
     */
    public static INSLooselyCoupledKalmanState estimate(
            final double x, final double y, final double z,
            final double vx, final double vy, final double vz,
            final double propagationInterval,
            final INSLooselyCoupledKalmanState previousState,
            final BodyKinematics bodyKinematics,
            final INSLooselyCoupledKalmanConfig config) throws AlgebraException {
<span class="fc" id="L366">        final INSLooselyCoupledKalmanState result = new INSLooselyCoupledKalmanState();</span>
<span class="fc" id="L367">        estimate(x, y, z, vx, vy, vz, propagationInterval, previousState,</span>
                bodyKinematics, config, result);
<span class="fc" id="L369">        return result;</span>
    }

    /**
     * Estimates the update of Kalman filter state for a single epoch.
     *
     * @param x                   ECEF x coordinate of user position expressed in
     *                            meters (m).
     * @param y                   ECEF y coordinate of user position expressed in
     *                            meters (m).
     * @param z                   ECEF z coordinate of user position expressed in
     *                            meters (m).
     * @param vx                  ECEF x coordinate of user velocity expressed in
     *                            meters per second (m/s).
     * @param vy                  ECEF y coordinate of user velocity expressed in
     *                            meters per second (m/s).
     * @param vz                  ECEF z coordinate of user velocity expressed in
     *                            meters per second (m/s).
     * @param propagationInterval propagation interval expressed in seconds (s).
     * @param previousState       previous Kalman filter state.
     * @param bodyKinematics      body kinematics containing measured specific force
     *                            resolved along body frame axes.
     * @param config              Loosely Coupled Kalman filter configuration.
     * @param result              instance where new state of Kalman filter will be
     *                            stored.
     * @throws AlgebraException if there are numerical instabilities.
     */
    public static void estimate(
            final double x, final double y, final double z,
            final double vx, final double vy, final double vz,
            final double propagationInterval,
            final INSLooselyCoupledKalmanState previousState,
            final BodyKinematics bodyKinematics,
            final INSLooselyCoupledKalmanConfig config,
            final INSLooselyCoupledKalmanState result) throws AlgebraException {

<span class="fc" id="L405">        final double fx = bodyKinematics.getFx();</span>
<span class="fc" id="L406">        final double fy = bodyKinematics.getFy();</span>
<span class="fc" id="L407">        final double fz = bodyKinematics.getFz();</span>

<span class="fc" id="L409">        estimate(x, y, z, vx, vy, vz, propagationInterval, previousState,</span>
                fx, fy, fz, config, result);
<span class="fc" id="L411">    }</span>

    /**
     * Estimates the update of Kalman filter state for a single epoch.
     *
     * @param x                   ECEF x coordinate of user position expressed in
     *                            meters (m).
     * @param y                   ECEF y coordinate of user position expressed in
     *                            meters (m).
     * @param z                   ECEF z coordinate of user position expressed in
     *                            meters (m).
     * @param vx                  ECEF x coordinate of user velocity expressed in
     *                            meters per second (m/s).
     * @param vy                  ECEF y coordinate of user velocity expressed in
     *                            meters per second (m/s).
     * @param vz                  ECEF z coordinate of user velocity expressed in
     *                            meters per second (m/s).
     * @param propagationInterval propagation interval expressed in seconds (s).
     * @param previousState       previous Kalman filter state.
     * @param bodyKinematics      body kinematics containing measured specific force
     *                            resolved along body frame axes.
     * @param previousLatitude    previous latitude solution expressed in radians (rad).
     * @param config              Loosely Coupled Kalman filter configuration.
     * @return new state of Kalman filter.
     * @throws AlgebraException if there are numerical instabilities.
     */
    public static INSLooselyCoupledKalmanState estimate(
            final double x, final double y, final double z,
            final double vx, final double vy, final double vz,
            final double propagationInterval,
            final INSLooselyCoupledKalmanState previousState,
            final BodyKinematics bodyKinematics,
            final double previousLatitude,
            final INSLooselyCoupledKalmanConfig config) throws AlgebraException {
<span class="fc" id="L445">        final INSLooselyCoupledKalmanState result = new INSLooselyCoupledKalmanState();</span>
<span class="fc" id="L446">        estimate(x, y, z, vx, vy, vz, propagationInterval, previousState,</span>
                bodyKinematics, previousLatitude, config, result);
<span class="fc" id="L448">        return result;</span>
    }

    /**
     * Estimates the update of Kalman filter state for a single epoch.
     *
     * @param x                   ECEF x coordinate of user position expressed in
     *                            meters (m).
     * @param y                   ECEF y coordinate of user position expressed in
     *                            meters (m).
     * @param z                   ECEF z coordinate of user position expressed in
     *                            meters (m).
     * @param vx                  ECEF x coordinate of user velocity expressed in
     *                            meters per second (m/s).
     * @param vy                  ECEF y coordinate of user velocity expressed in
     *                            meters per second (m/s).
     * @param vz                  ECEF z coordinate of user velocity expressed in
     *                            meters per second (m/s).
     * @param propagationInterval propagation interval expressed in seconds (s).
     * @param previousState       previous Kalman filter state.
     * @param bodyKinematics      body kinematics containing measured specific force
     *                            resolved along body frame axes.
     * @param previousLatitude    previous latitude solution expressed in radians (rad).
     * @param config              Loosely Coupled Kalman filter configuration.
     * @param result              instance where new state of Kalman filter will be
     *                            stored.
     * @throws AlgebraException if there are numerical instabilities.
     */
    public static void estimate(
            final double x, final double y, final double z,
            final double vx, final double vy, final double vz,
            final double propagationInterval,
            final INSLooselyCoupledKalmanState previousState,
            final BodyKinematics bodyKinematics,
            final double previousLatitude,
            final INSLooselyCoupledKalmanConfig config,
            final INSLooselyCoupledKalmanState result) throws AlgebraException {

<span class="fc" id="L486">        final double fx = bodyKinematics.getFx();</span>
<span class="fc" id="L487">        final double fy = bodyKinematics.getFy();</span>
<span class="fc" id="L488">        final double fz = bodyKinematics.getFz();</span>

<span class="fc" id="L490">        estimate(x, y, z, vx, vy, vz, propagationInterval, previousState,</span>
                fx, fy, fz, previousLatitude, config, result);
<span class="fc" id="L492">    }</span>

    /**
     * Estimates the update of Kalman filter state for a single epoch.
     *
     * @param x                   ECEF x coordinate of user position expressed in
     *                            meters (m).
     * @param y                   ECEF y coordinate of user position expressed in
     *                            meters (m).
     * @param z                   ECEF z coordinate of user position expressed in
     *                            meters (m).
     * @param vx                  ECEF x coordinate of user velocity expressed in
     *                            meters per second (m/s).
     * @param vy                  ECEF y coordinate of user velocity expressed in
     *                            meters per second (m/s).
     * @param vz                  ECEF z coordinate of user velocity expressed in
     *                            meters per second (m/s).
     * @param propagationInterval propagation interval expressed in seconds (s).
     * @param previousState       previous Kalman filter state.
     * @param fx                  measured specific force resolved along body frame
     *                            x-axis and expressed in meters per squared
     *                            second (m/s^2).
     * @param fy                  measured specific force resolved along body frame
     *                            y-axis and expressed in meters per squared
     *                            second (m/s^2).
     * @param fz                  measured specific force resolved along body frame
     *                            z-axis and expressed in meters per squared
     *                            second (m/s^2).
     * @param config              Loosely Coupled Kalman filter configuration.
     * @return new state of Kalman filter.
     * @throws AlgebraException if there are numerical instabilities.
     */
    public static INSLooselyCoupledKalmanState estimate(
            final double x, final double y, final double z,
            final double vx, final double vy, final double vz,
            final double propagationInterval,
            final INSLooselyCoupledKalmanState previousState,
            final double fx, double fy, final double fz,
            final INSLooselyCoupledKalmanConfig config) throws AlgebraException {
<span class="fc" id="L531">        final INSLooselyCoupledKalmanState result = new INSLooselyCoupledKalmanState();</span>
<span class="fc" id="L532">        estimate(x, y, z, vx, vy, vz, propagationInterval, previousState,</span>
                fx, fy, fz, config, result);
<span class="fc" id="L534">        return result;</span>
    }

    /**
     * Estimates the update of Kalman filter state for a single epoch.
     *
     * @param x                   ECEF x coordinate of user position expressed in
     *                            meters (m).
     * @param y                   ECEF y coordinate of user position expressed in
     *                            meters (m).
     * @param z                   ECEF z coordinate of user position expressed in
     *                            meters (m).
     * @param vx                  ECEF x coordinate of user velocity expressed in
     *                            meters per second (m/s).
     * @param vy                  ECEF y coordinate of user velocity expressed in
     *                            meters per second (m/s).
     * @param vz                  ECEF z coordinate of user velocity expressed in
     *                            meters per second (m/s).
     * @param propagationInterval propagation interval expressed in seconds (s).
     * @param previousState       previous Kalman filter state.
     * @param fx                  measured specific force resolved along body frame
     *                            x-axis and expressed in meters per squared
     *                            second (m/s^2).
     * @param fy                  measured specific force resolved along body frame
     *                            y-axis and expressed in meters per squared
     *                            second (m/s^2).
     * @param fz                  measured specific force resolved along body frame
     *                            z-axis and expressed in meters per squared
     *                            second (m/s^2).
     * @param config              Loosely Coupled Kalman filter configuration.
     * @param result              instance where new state of Kalman filter will be
     *                            stored.
     * @throws AlgebraException if there are numerical instabilities.
     */
    public static void estimate(
            final double x, final double y, final double z,
            final double vx, final double vy, final double vz,
            final double propagationInterval,
            final INSLooselyCoupledKalmanState previousState,
            final double fx, final double fy, final double fz,
            final INSLooselyCoupledKalmanConfig config,
            final INSLooselyCoupledKalmanState result) throws AlgebraException {

<span class="fc" id="L577">        final NEDPosition prevNedPosition = new NEDPosition();</span>
<span class="fc" id="L578">        final NEDVelocity prevNedVelocity = new NEDVelocity();</span>
<span class="fc" id="L579">        ECEFtoNEDPositionVelocityConverter.convertECEFtoNED(</span>
<span class="fc" id="L580">                previousState.getX(), previousState.getY(), previousState.getZ(),</span>
<span class="fc" id="L581">                previousState.getVx(), previousState.getVy(), previousState.getVz(),</span>
                prevNedPosition, prevNedVelocity);

<span class="fc" id="L584">        final double previousLatitude = prevNedPosition.getLatitude();</span>

<span class="fc" id="L586">        estimate(x, y, z, vx, vy, vz, propagationInterval, previousState,</span>
                fx, fy, fz, previousLatitude, config, result);
<span class="fc" id="L588">    }</span>

    /**
     * Estimates the update of Kalman filter state for a single epoch.
     *
     * @param x                   ECEF x coordinate of user position expressed in
     *                            meters (m).
     * @param y                   ECEF y coordinate of user position expressed in
     *                            meters (m).
     * @param z                   ECEF z coordinate of user position expressed in
     *                            meters (m).
     * @param vx                  ECEF x coordinate of user velocity expressed in
     *                            meters per second (m/s).
     * @param vy                  ECEF y coordinate of user velocity expressed in
     *                            meters per second (m/s).
     * @param vz                  ECEF z coordinate of user velocity expressed in
     *                            meters per second (m/s).
     * @param propagationInterval propagation interval expressed in seconds (s).
     * @param previousState       previous Kalman filter state.
     * @param fx                  measured specific force resolved along body frame
     *                            x-axis and expressed in meters per squared
     *                            second (m/s^2).
     * @param fy                  measured specific force resolved along body frame
     *                            y-axis and expressed in meters per squared
     *                            second (m/s^2).
     * @param fz                  measured specific force resolved along body frame
     *                            z-axis and expressed in meters per squared
     *                            second (m/s^2).
     * @param previousLatitude    previous latitude solution expressed in radians (rad).
     * @param config              Loosely Coupled Kalman filter configuration.
     * @return new state of Kalman filter.
     * @throws AlgebraException if there are numerical instabilities.
     */
    public static INSLooselyCoupledKalmanState estimate(
            final double x, final double y, final double z,
            final double vx, final double vy, final double vz,
            final double propagationInterval,
            final INSLooselyCoupledKalmanState previousState,
            final double fx, final double fy, final double fz,
            final double previousLatitude,
            final INSLooselyCoupledKalmanConfig config) throws AlgebraException {
<span class="fc" id="L629">        final INSLooselyCoupledKalmanState result = new INSLooselyCoupledKalmanState();</span>
<span class="fc" id="L630">        estimate(x, y, z, vx, vy, vz, propagationInterval, previousState,</span>
                fx, fy, fz, previousLatitude, config, result);
<span class="fc" id="L632">        return result;</span>
    }

    /**
     * Estimates the update of Kalman filter state for a single epoch.
     *
     * @param x                   ECEF x coordinate of user position expressed in
     *                            meters (m).
     * @param y                   ECEF y coordinate of user position expressed in
     *                            meters (m).
     * @param z                   ECEF z coordinate of user position expressed in
     *                            meters (m).
     * @param vx                  ECEF x coordinate of user velocity expressed in
     *                            meters per second (m/s).
     * @param vy                  ECEF y coordinate of user velocity expressed in
     *                            meters per second (m/s).
     * @param vz                  ECEF z coordinate of user velocity expressed in
     *                            meters per second (m/s).
     * @param propagationInterval propagation interval expressed in seconds (s).
     * @param previousState       previous Kalman filter state.
     * @param fx                  measured specific force resolved along body frame
     *                            x-axis and expressed in meters per squared
     *                            second (m/s^2).
     * @param fy                  measured specific force resolved along body frame
     *                            y-axis and expressed in meters per squared
     *                            second (m/s^2).
     * @param fz                  measured specific force resolved along body frame
     *                            z-axis and expressed in meters per squared
     *                            second (m/s^2).
     * @param previousLatitude    previous latitude solution expressed in radians (rad).
     * @param config              Loosely Coupled Kalman filter configuration.
     * @param result              instance where new state of Kalman filter will be
     *                            stored.
     * @throws AlgebraException if there are numerical instabilities.
     */
    public static void estimate(
            final double x, final double y, final double z,
            final double vx, final double vy, final double vz,
            final double propagationInterval,
            final INSLooselyCoupledKalmanState previousState,
            final double fx, final double fy, final double fz,
            final double previousLatitude,
            final INSLooselyCoupledKalmanConfig config,
            final INSLooselyCoupledKalmanState result) throws AlgebraException {

<span class="fc" id="L677">        final Matrix omegaIe = Utils.skewMatrix(</span>
                new double[]{0.0, 0.0, EARTH_ROTATION_RATE});

        // SYSTEM PROPAGATION PHASE

        // 1. Determine transition matrix using (14.50) (first-order approx)
<span class="fc" id="L683">        final Matrix phiMatrix = Matrix.identity(</span>
                INSLooselyCoupledKalmanState.NUM_PARAMS,
                INSLooselyCoupledKalmanState.NUM_PARAMS);

<span class="fc" id="L687">        final Matrix tmp1 = omegaIe.multiplyByScalarAndReturnNew(</span>
                propagationInterval);
<span class="fc" id="L689">        final Matrix tmp2 = phiMatrix.getSubmatrix(0, 0,</span>
                2, 2);
<span class="fc" id="L691">        tmp2.subtract(tmp1);</span>

<span class="fc" id="L693">        phiMatrix.setSubmatrix(0, 0,</span>
                2, 2, tmp2);

<span class="fc" id="L696">        final Matrix estCbeOld = previousState</span>
<span class="fc" id="L697">                .getBodyToEcefCoordinateTransformationMatrix();</span>
<span class="fc" id="L698">        tmp1.copyFrom(estCbeOld);</span>
<span class="fc" id="L699">        tmp1.multiplyByScalar(propagationInterval);</span>

<span class="fc" id="L701">        phiMatrix.setSubmatrix(0, 12,</span>
                2, 14, tmp1);
<span class="fc" id="L703">        phiMatrix.setSubmatrix(3, 9,</span>
                5, 11, tmp1);

<span class="fc" id="L706">        final Matrix measFibb = new Matrix(BodyKinematics.COMPONENTS, 1);</span>
<span class="fc" id="L707">        measFibb.setElementAtIndex(0, fx);</span>
<span class="fc" id="L708">        measFibb.setElementAtIndex(1, fy);</span>
<span class="fc" id="L709">        measFibb.setElementAtIndex(2, fz);</span>

<span class="fc" id="L711">        estCbeOld.multiply(measFibb, tmp1);</span>

<span class="fc" id="L713">        Utils.skewMatrix(tmp1, tmp2);</span>
<span class="fc" id="L714">        tmp2.multiplyByScalar(-propagationInterval);</span>

<span class="fc" id="L716">        phiMatrix.setSubmatrix(3, 0,</span>
                5, 2, tmp2);

<span class="fc" id="L719">        phiMatrix.getSubmatrix(3, 3,</span>
                5, 5, tmp1);
<span class="fc" id="L721">        tmp2.copyFrom(omegaIe);</span>
<span class="fc" id="L722">        tmp2.multiplyByScalar(2.0 * propagationInterval);</span>
<span class="fc" id="L723">        tmp1.subtract(tmp2);</span>
<span class="fc" id="L724">        phiMatrix.setSubmatrix(3, 3,</span>
                5, 5, tmp1);

<span class="fc" id="L727">        final double sinPrevLat = Math.sin(previousLatitude);</span>
<span class="fc" id="L728">        final double cosPrevLat = Math.cos(previousLatitude);</span>
<span class="fc" id="L729">        final double sinPrevLat2 = sinPrevLat * sinPrevLat;</span>
<span class="fc" id="L730">        final double cosPrevLat2 = cosPrevLat * cosPrevLat;</span>

        // From (2.137)
<span class="fc" id="L733">        final double geocentricRadius = EARTH_EQUATORIAL_RADIUS_WGS84</span>
<span class="fc" id="L734">                / Math.sqrt(1.0 - Math.pow(EARTH_ECCENTRICITY * sinPrevLat, 2.0))</span>
<span class="fc" id="L735">                * Math.sqrt(cosPrevLat2</span>
<span class="fc" id="L736">                + Math.pow(1.0 - EARTH_ECCENTRICITY * EARTH_ECCENTRICITY, 2.0) * sinPrevLat2);</span>

<span class="fc" id="L738">        final double prevX = previousState.getX();</span>
<span class="fc" id="L739">        final double prevY = previousState.getY();</span>
<span class="fc" id="L740">        final double prevZ = previousState.getZ();</span>
<span class="fc" id="L741">        final ECEFGravity gravity = ECEFGravityEstimator.estimateGravityAndReturnNew(</span>
                prevX, prevY, prevZ);

<span class="fc" id="L744">        final double previousPositionNorm = Math.sqrt(prevX * prevX +</span>
                prevY * prevY + prevZ * prevZ);

<span class="fc" id="L747">        final Matrix estRebeOld = new Matrix(ECEFPosition.COMPONENTS, 1);</span>
<span class="fc" id="L748">        estRebeOld.setElementAtIndex(0, prevX);</span>
<span class="fc" id="L749">        estRebeOld.setElementAtIndex(1, prevY);</span>
<span class="fc" id="L750">        estRebeOld.setElementAtIndex(2, prevZ);</span>

<span class="fc" id="L752">        final Matrix g = gravity.asMatrix();</span>
<span class="fc" id="L753">        g.multiplyByScalar(-2.0 * propagationInterval / geocentricRadius);</span>

<span class="fc" id="L755">        final Matrix estRebeOldTrans = estRebeOld.transposeAndReturnNew();</span>
<span class="fc" id="L756">        estRebeOldTrans.multiplyByScalar(1.0 / previousPositionNorm);</span>

<span class="fc" id="L758">        g.multiply(estRebeOldTrans, tmp1);</span>

<span class="fc" id="L760">        phiMatrix.setSubmatrix(3, 6,</span>
                5, 8, tmp1);

<span class="fc bfc" id="L763" title="All 2 branches covered.">        for (int i = 0; i &lt; ECEFPosition.COMPONENTS; i++) {</span>
<span class="fc" id="L764">            phiMatrix.setElementAt(6 + i, 3 + i, propagationInterval);</span>
        }


        // 2. Determine approximate system noise covariance matrix using (14.82)
<span class="fc" id="L769">        final Matrix qPrimeMatrix = new Matrix(</span>
                INSLooselyCoupledKalmanState.NUM_PARAMS,
                INSLooselyCoupledKalmanState.NUM_PARAMS);

<span class="fc" id="L773">        final double gyroNoisePSD = config.getGyroNoisePSD();</span>
<span class="fc" id="L774">        final double gyroNoiseValue = gyroNoisePSD * propagationInterval;</span>
<span class="fc bfc" id="L775" title="All 2 branches covered.">        for (int i = 0; i &lt; 3; i++) {</span>
<span class="fc" id="L776">            qPrimeMatrix.setElementAt(i, i, gyroNoiseValue);</span>
        }

<span class="fc" id="L779">        final double accelNoisePSD = config.getAccelerometerNoisePSD();</span>
<span class="fc" id="L780">        final double accelNoiseValue = accelNoisePSD * propagationInterval;</span>
<span class="fc bfc" id="L781" title="All 2 branches covered.">        for (int i = 3; i &lt; 6; i++) {</span>
<span class="fc" id="L782">            qPrimeMatrix.setElementAt(i, i, accelNoiseValue);</span>
        }

<span class="fc" id="L785">        final double accelBiasPSD = config.getAccelerometerBiasPSD();</span>
<span class="fc" id="L786">        final double accelBiasValue = accelBiasPSD * propagationInterval;</span>
<span class="fc bfc" id="L787" title="All 2 branches covered.">        for (int i = 9; i &lt; 12; i++) {</span>
<span class="fc" id="L788">            qPrimeMatrix.setElementAt(i, i, accelBiasValue);</span>
        }

<span class="fc" id="L791">        final double gyroBiasPSD = config.getGyroBiasPSD();</span>
<span class="fc" id="L792">        final double gyroBiasValue = gyroBiasPSD * propagationInterval;</span>
<span class="fc bfc" id="L793" title="All 2 branches covered.">        for (int i = 12; i &lt; 15; i++) {</span>
<span class="fc" id="L794">            qPrimeMatrix.setElementAt(i, i, gyroBiasValue);</span>
        }


        // 3. Propagate state estimates using (3.14) noting that all states are zero
        // due to closed-loop correction.
        // x_est_propagated(1:15, 1) = 0;

        // 4. Propagate state estimation error covariance matrix using (3.46)
<span class="fc" id="L803">        final Matrix pMatrixOld = previousState.getCovariance();</span>

<span class="fc" id="L805">        qPrimeMatrix.multiplyByScalar(0.5);</span>

<span class="fc" id="L807">        final Matrix tmp3 = pMatrixOld.addAndReturnNew(qPrimeMatrix);</span>
<span class="fc" id="L808">        final Matrix pMatrixPropagated = phiMatrix.multiplyAndReturnNew(tmp3);</span>

<span class="fc" id="L810">        phiMatrix.transpose();</span>
<span class="fc" id="L811">        pMatrixPropagated.multiply(phiMatrix);</span>

<span class="fc" id="L813">        pMatrixPropagated.add(qPrimeMatrix);</span>


        // MEASUREMENT UPDATE PHASE

        // 5. Set-up measurement matrix using (14.115)
<span class="fc" id="L819">        final Matrix h = new Matrix(POS_AND_VEL_COMPONENTS,</span>
                INSLooselyCoupledKalmanState.NUM_PARAMS);
<span class="fc bfc" id="L821" title="All 2 branches covered.">        for (int i = 0; i &lt; 3; i++) {</span>
<span class="fc" id="L822">            h.setElementAt(i, POS_AND_VEL_COMPONENTS + i, -1.0);</span>
<span class="fc" id="L823">            int j = ECEFPosition.COMPONENTS + i;</span>
<span class="fc" id="L824">            h.setElementAt(j, j, -1.0);</span>
        }

        // 6. Set-up measurement noise covariance matrix assuming all components of
        // GNSS position and velocity are independent and have equal variance.
<span class="fc" id="L829">        final Matrix r = new Matrix(POS_AND_VEL_COMPONENTS, POS_AND_VEL_COMPONENTS);</span>

<span class="fc" id="L831">        final double posMeasSD = config.getPositionNoiseSD();</span>
<span class="fc" id="L832">        final double posMeasSD2 = posMeasSD * posMeasSD;</span>
<span class="fc bfc" id="L833" title="All 2 branches covered.">        for (int i = 0; i &lt; ECEFPosition.COMPONENTS; i++) {</span>
<span class="fc" id="L834">            r.setElementAt(i, i, posMeasSD2);</span>
        }

<span class="fc" id="L837">        final double velMeasSD = config.getVelocityNoiseSD();</span>
<span class="fc" id="L838">        final double velMeasSD2 = velMeasSD * velMeasSD;</span>
<span class="fc bfc" id="L839" title="All 2 branches covered.">        for (int i = ECEFPosition.COMPONENTS; i &lt; POS_AND_VEL_COMPONENTS; i++) {</span>
<span class="fc" id="L840">            r.setElementAt(i, i, velMeasSD2);</span>
        }

        // 7. Calculate Kalman gain using (3.21)
<span class="fc" id="L844">        final Matrix hTrans = h.transposeAndReturnNew();</span>

<span class="fc" id="L846">        final Matrix tmp4 = h.multiplyAndReturnNew(pMatrixPropagated);</span>
<span class="fc" id="L847">        tmp4.multiply(hTrans);</span>
<span class="fc" id="L848">        tmp4.add(r);</span>

<span class="fc" id="L850">        final Matrix tmp5 = Utils.inverse(tmp4);</span>

<span class="fc" id="L852">        final Matrix k = pMatrixPropagated.multiplyAndReturnNew(hTrans);</span>
<span class="fc" id="L853">        k.multiply(tmp5);</span>

        // 8. Formulate measurement innovations using (14.102), noting that zero
        // lever arm is assumed here
<span class="fc" id="L857">        final double prevVx = previousState.getVx();</span>
<span class="fc" id="L858">        final double prevVy = previousState.getVy();</span>
<span class="fc" id="L859">        final double prevVz = previousState.getVz();</span>

<span class="fc" id="L861">        final Matrix deltaZ = new Matrix(POS_AND_VEL_COMPONENTS, 1);</span>
<span class="fc" id="L862">        deltaZ.setElementAtIndex(0, x - prevX);</span>
<span class="fc" id="L863">        deltaZ.setElementAtIndex(1, y - prevY);</span>
<span class="fc" id="L864">        deltaZ.setElementAtIndex(2, z - prevZ);</span>
<span class="fc" id="L865">        deltaZ.setElementAtIndex(3, vx - prevVx);</span>
<span class="fc" id="L866">        deltaZ.setElementAtIndex(4, vy - prevVy);</span>
<span class="fc" id="L867">        deltaZ.setElementAtIndex(5, vz - prevVz);</span>

        // 9. Update state estimates using (3.24)
        // x_est_new = x_est_propagated + K_matrix * delta_z;
<span class="fc" id="L871">        final Matrix xEstNew = k.multiplyAndReturnNew(deltaZ);</span>

        // 10. Update state estimation error covariance matrix using (3.25)
<span class="fc" id="L874">        k.multiply(h);</span>
<span class="fc" id="L875">        final Matrix pNew = Matrix.identity(INSLooselyCoupledKalmanState.NUM_PARAMS,</span>
                INSLooselyCoupledKalmanState.NUM_PARAMS);
<span class="fc" id="L877">        pNew.subtract(k);</span>
<span class="fc" id="L878">        pNew.multiply(pMatrixPropagated);</span>

        // CLOSED-LOOP CORRECTION

        // Correct attitude, velocity, and position using (14.7-9)
<span class="fc" id="L883">        final Matrix tmp6 = xEstNew.getSubmatrix(0, 0,</span>
                2, 0);
<span class="fc" id="L885">        Matrix tmp7 = Utils.skewMatrix(tmp6);</span>

<span class="fc" id="L887">        final Matrix estCbeNew = Matrix.identity(ECEFPosition.COMPONENTS,</span>
                ECEFPosition.COMPONENTS);
<span class="fc" id="L889">        estCbeNew.subtract(tmp7);</span>
<span class="fc" id="L890">        estCbeNew.multiply(estCbeOld);</span>

<span class="fc" id="L892">        final double newVx = prevVx - xEstNew.getElementAtIndex(3);</span>
<span class="fc" id="L893">        final double newVy = prevVy - xEstNew.getElementAtIndex(4);</span>
<span class="fc" id="L894">        final double newVz = prevVz - xEstNew.getElementAtIndex(5);</span>

<span class="fc" id="L896">        final double newX = prevX - xEstNew.getElementAtIndex(6);</span>
<span class="fc" id="L897">        final double newY = prevY - xEstNew.getElementAtIndex(7);</span>
<span class="fc" id="L898">        final double newZ = prevZ - xEstNew.getElementAtIndex(8);</span>

        // Update IMU bias estimates
<span class="fc" id="L901">        final double newAccelerationBiasX = previousState.getAccelerationBiasX()</span>
<span class="fc" id="L902">                + xEstNew.getElementAtIndex(9);</span>
<span class="fc" id="L903">        final double newAccelerationBiasY = previousState.getAccelerationBiasY()</span>
<span class="fc" id="L904">                + xEstNew.getElementAtIndex(10);</span>
<span class="fc" id="L905">        final double newAccelerationBiasZ = previousState.getAccelerationBiasZ()</span>
<span class="fc" id="L906">                + xEstNew.getElementAtIndex(11);</span>

<span class="fc" id="L908">        final double newGyroBiasX = previousState.getGyroBiasX()</span>
<span class="fc" id="L909">                + xEstNew.getElementAtIndex(12);</span>
<span class="fc" id="L910">        final double newGyroBiasY = previousState.getGyroBiasY()</span>
<span class="fc" id="L911">                + xEstNew.getElementAtIndex(13);</span>
<span class="fc" id="L912">        final double newGyroBiasZ = previousState.getGyroBiasZ()</span>
<span class="fc" id="L913">                + xEstNew.getElementAtIndex(14);</span>


        // set result values
<span class="fc" id="L917">        result.setBodyToEcefCoordinateTransformationMatrix(estCbeNew);</span>
<span class="fc" id="L918">        result.setVelocityCoordinates(newVx, newVy, newVz);</span>
<span class="fc" id="L919">        result.setPositionCoordinates(newX, newY, newZ);</span>
<span class="fc" id="L920">        result.setAccelerationBiasCoordinates(newAccelerationBiasX,</span>
                newAccelerationBiasY, newAccelerationBiasZ);
<span class="fc" id="L922">        result.setGyroBiasCoordinates(newGyroBiasX, newGyroBiasY,</span>
                newGyroBiasZ);
<span class="fc" id="L924">        result.setCovariance(pNew);</span>
<span class="fc" id="L925">    }</span>

    /**
     * Estimates the update of Kalman filter state for a single epoch.
     *
     * @param userPosition        ECEF user position.
     * @param userVelocity        ECEF user velocity.
     * @param propagationInterval propagation interval expressed in seconds (s).
     * @param previousState       previous Kalman filter state.
     * @param bodyKinematics      body kinematics containing measured specific force
     *                            resolved along body frame axes.
     * @param config              Loosely Coupled Kalman filter configuration.
     * @return new state of Kalman filter.
     * @throws AlgebraException if there are numerical instabilities.
     */
    public static INSLooselyCoupledKalmanState estimate(
            final ECEFPosition userPosition,
            final ECEFVelocity userVelocity,
            final Time propagationInterval,
            final INSLooselyCoupledKalmanState previousState,
            final BodyKinematics bodyKinematics,
            final INSLooselyCoupledKalmanConfig config) throws AlgebraException {
<span class="fc" id="L947">        return estimate(userPosition, userVelocity, convertTime(propagationInterval),</span>
                previousState, bodyKinematics, config);
    }

    /**
     * Estimates the update of Kalman filter state for a single epoch.
     *
     * @param userPosition        ECEF user position.
     * @param userVelocity        ECEF user velocity.
     * @param propagationInterval propagation interval.
     * @param previousState       previous Kalman filter state.
     * @param bodyKinematics      body kinematics containing measured specific force
     *                            resolved along body frame axes.
     * @param config              Loosely Coupled Kalman filter configuration.
     * @param result              instance where new state of Kalman filter will be
     *                            stored.
     * @throws AlgebraException if there are numerical instabilities.
     */
    public static void estimate(
            final ECEFPosition userPosition,
            final ECEFVelocity userVelocity,
            final Time propagationInterval,
            final INSLooselyCoupledKalmanState previousState,
            final BodyKinematics bodyKinematics,
            final INSLooselyCoupledKalmanConfig config,
            final INSLooselyCoupledKalmanState result) throws AlgebraException {
<span class="fc" id="L973">        estimate(userPosition, userVelocity, convertTime(propagationInterval),</span>
                previousState, bodyKinematics, config, result);
<span class="fc" id="L975">    }</span>

    /**
     * Estimates the update of Kalman filter state for a single epoch.
     *
     * @param userPosition        ECEF user position.
     * @param userVelocity        ECEF user velocity.
     * @param propagationInterval propagaion interval.
     * @param previousState       previous Kalman filter state.
     * @param bodyKinematics      body kinematics containing measured specific force
     *                            resolved along body frame axes.
     * @param previousLatitude    previous latitude solution expressed in radians (rad).
     * @param config              Loosely Coupled Kalman filter configuration.
     * @return new state of Kalman filter.
     * @throws AlgebraException if there are numerical instabilities.
     */
    public static INSLooselyCoupledKalmanState estimate(
            final ECEFPosition userPosition,
            final ECEFVelocity userVelocity,
            final Time propagationInterval,
            final INSLooselyCoupledKalmanState previousState,
            final BodyKinematics bodyKinematics,
            final double previousLatitude,
            final INSLooselyCoupledKalmanConfig config) throws AlgebraException {
<span class="fc" id="L999">        return estimate(userPosition, userVelocity, convertTime(propagationInterval),</span>
                previousState, bodyKinematics, previousLatitude, config);
    }

    /**
     * Estimates the update of Kalman filter state of a single epoch.
     *
     * @param userPosition        ECEF user position.
     * @param userVelocity        ECEF user velocity.
     * @param propagationInterval propagation interval.
     * @param previousState       previous Kalman filter state.
     * @param bodyKinematics      body kinematics containing measured specific force
     *                            resolved along body frame axes.
     * @param previousLatitude    previous latitude solution expressed in radians (rad).
     * @param config              Loosely Coupled Kalman filter configuration.
     * @param result              instance where new state of Kalman filter will be
     *                            stored.
     * @throws AlgebraException if there are numerical instabilities.
     */
    public static void estimate(
            final ECEFPosition userPosition,
            final ECEFVelocity userVelocity,
            final Time propagationInterval,
            final INSLooselyCoupledKalmanState previousState,
            final BodyKinematics bodyKinematics,
            final double previousLatitude,
            final INSLooselyCoupledKalmanConfig config,
            final INSLooselyCoupledKalmanState result) throws AlgebraException {
<span class="fc" id="L1027">        estimate(userPosition, userVelocity, convertTime(propagationInterval),</span>
                previousState, bodyKinematics, previousLatitude, config,
                result);
<span class="fc" id="L1030">    }</span>

    /**
     * Estimates the update of Kalman filter state of a single epoch.
     *
     * @param userPosition        ECEF user position.
     * @param userVelocity        ECEF user velocity.
     * @param propagationInterval propagation interval.
     * @param previousState       previous Kalman filter state.
     * @param fx                  measured specific force resolved along body frame
     *                            x-axis and expressed in meters per squared
     *                            second (m/s^2).
     * @param fy                  measured specific force resolved along body frame
     *                            y-axis and expressed in meters per squared
     *                            second (m/s^2).
     * @param fz                  measured specific force resolved along body frame
     *                            z-axis and expressed in meters per squared
     *                            second (m/s^2).
     * @param config              Loosely Coupled Kalman filter configuration.
     * @return new state of Kalman filter.
     * @throws AlgebraException if there are numerical instabilities.
     */
    public static INSLooselyCoupledKalmanState estimate(
            final ECEFPosition userPosition,
            final ECEFVelocity userVelocity,
            final Time propagationInterval,
            final INSLooselyCoupledKalmanState previousState,
            final double fx, final double fy, final double fz,
            final INSLooselyCoupledKalmanConfig config) throws AlgebraException {
<span class="fc" id="L1059">        return estimate(userPosition, userVelocity, convertTime(propagationInterval),</span>
                previousState, fx, fy, fz, config);
    }

    /**
     * Estimates the update of Kalman filter state of a single epoch.
     *
     * @param userPosition        ECEF user position.
     * @param userVelocity        ECEF user velocity.
     * @param propagationInterval propagation interval.
     * @param previousState       previous Kalman filter state.
     * @param fx                  measured specific force resolved along body frame
     *                            x-axis and expressed in meters per squared
     *                            second (m/s^2).
     * @param fy                  measured specific force resolved along body frame
     *                            y-axis and expressed in meters per squared
     *                            second (m/s^2).
     * @param fz                  measured specific force resolved along body frame
     *                            z-axis and expressed in meters per squared
     *                            second (m/s^2).
     * @param config              Loosely Coupled Kalman filter configuration.
     * @param result              instance where new state of Kalman filter will be
     *                            stored.
     * @throws AlgebraException if there are numerical instabilities.
     */
    public static void estimate(
            final ECEFPosition userPosition,
            final ECEFVelocity userVelocity,
            final Time propagationInterval,
            final INSLooselyCoupledKalmanState previousState,
            final double fx, final double fy, final double fz,
            final INSLooselyCoupledKalmanConfig config,
            final INSLooselyCoupledKalmanState result) throws AlgebraException {
<span class="fc" id="L1092">        estimate(userPosition, userVelocity, convertTime(propagationInterval),</span>
                previousState, fx, fy, fz, config, result);
<span class="fc" id="L1094">    }</span>

    /**
     * Estimates the update of Kalman filter state of a single epoch.
     *
     * @param userPosition        ECEF user position.
     * @param userVelocity        ECEF user velocity.
     * @param propagationInterval propagation interval.
     * @param previousState       previous Kalman filter state.
     * @param fx                  measured specific force resolved along body frame
     *                            x-axis and expressed in meters per squared
     *                            second (m/s^2).
     * @param fy                  measured specific force resolved along body frame
     *                            y-axis and expressed in meters per squared
     *                            second (m/s^2).
     * @param fz                  measured specific force resolved along body frame
     *                            z-axis and expressed in meters per squared
     *                            second (m/s^2).
     * @param previousLatitude    previous latitude solution expressed in radians (rad).
     * @param config              Loosely Coupled Kalman filter configuration.
     * @return new state of Kalman filter.
     * @throws AlgebraException if there are numerical instabilities.
     */
    public static INSLooselyCoupledKalmanState estimate(
            final ECEFPosition userPosition,
            final ECEFVelocity userVelocity,
            final Time propagationInterval,
            final INSLooselyCoupledKalmanState previousState,
            final double fx, final double fy, final double fz,
            final double previousLatitude,
            final INSLooselyCoupledKalmanConfig config) throws AlgebraException {
<span class="fc" id="L1125">        return estimate(userPosition, userVelocity, convertTime(propagationInterval),</span>
                previousState, fx, fy, fz, previousLatitude, config);
    }

    /**
     * Estimates the update of Kalman filter state of a single epoch.
     *
     * @param userPosition        ECEF user position.
     * @param userVelocity        ECEF user velocity.
     * @param propagationInterval propagation interval.
     * @param previousState       previous Kalman filter state.
     * @param fx                  measured specific force resolved along body frame
     *                            x-axis and expressed in meters per squared
     *                            second (m/s^2).
     * @param fy                  measured specific force resolved along body frame
     *                            y-axis and expressed in meters per squared
     *                            second (m/s^2).
     * @param fz                  measured specific force resolved along body frame
     *                            z-axis and expressed in meters per squared
     *                            second (m/s^2).
     * @param previousLatitude    previous latitude solution expressed in radians (rad).
     * @param config              Loosely Coupled Kalman filter configuration.
     * @param result              instance where new state of Kalman filter will be
     *                            stored.
     * @throws AlgebraException if there are numerical instabilities.
     */
    public static void estimate(
            final ECEFPosition userPosition,
            final ECEFVelocity userVelocity,
            final Time propagationInterval,
            final INSLooselyCoupledKalmanState previousState,
            final double fx, final double fy, final double fz,
            final double previousLatitude,
            final INSLooselyCoupledKalmanConfig config,
            final INSLooselyCoupledKalmanState result) throws AlgebraException {
<span class="fc" id="L1160">        estimate(userPosition, userVelocity, convertTime(propagationInterval),</span>
                previousState, fx, fy, fz, previousLatitude, config, result);
<span class="fc" id="L1162">    }</span>

    /**
     * Estimates the update of Kalman filter state of a single epoch.
     *
     * @param x                   ECEF x coordinate of user position expressed in
     *                            meters (m).
     * @param y                   ECEF y coordinate of user position expressed in
     *                            meters (m).
     * @param z                   ECEF z coordinate of user position expressed in
     *                            meters (m).
     * @param vx                  ECEF x coordinate of user velocity expressed in
     *                            meters per second (m/s).
     * @param vy                  ECEF y coordinate of user velocity expressed in
     *                            meters per second (m/s).
     * @param vz                  ECEF z coordinate of user velocity expressed in
     *                            meters per second (m/s).
     * @param propagationInterval propagation interval.
     * @param previousState       previous Kalman filter state.
     * @param bodyKinematics      body kinematics containing measured specific force
     *                            resolved along body frame axes.
     * @param config              Loosely Coupled Kalman filter configuration.
     * @return new state of Kalman filter.
     * @throws AlgebraException if there are numerical instabilities.
     */
    public static INSLooselyCoupledKalmanState estimate(
            final double x, final double y, final double z,
            final double vx, final double vy, final double vz,
            final Time propagationInterval,
            final INSLooselyCoupledKalmanState previousState,
            final BodyKinematics bodyKinematics,
            final INSLooselyCoupledKalmanConfig config) throws AlgebraException {
<span class="fc" id="L1194">        return estimate(x, y, z, vx, vy, vz, convertTime(propagationInterval),</span>
                previousState, bodyKinematics, config);
    }

    /**
     * Estimates the update of Kalman filter state for a single epoch.
     *
     * @param x                   ECEF x coordinate of user position expressed in
     *                            meters (m).
     * @param y                   ECEF y coordinate of user position expressed in
     *                            meters (m).
     * @param z                   ECEF z coordinate of user position expressed in
     *                            meters (m).
     * @param vx                  ECEF x coordinate of user velocity expressed in
     *                            meters per second (m/s).
     * @param vy                  ECEF y coordinate of user velocity expressed in
     *                            meters per second (m/s).
     * @param vz                  ECEF z coordinate of user velocity expressed in
     *                            meters per second (m/s).
     * @param propagationInterval propagation interval.
     * @param previousState       previous Kalman filter state.
     * @param bodyKinematics      body kinematics containing measured specific force
     *                            resolved along body frame axes.
     * @param config              Loosely Coupled Kalman filter configuration.
     * @param result              instance where new state of Kalman filter will be
     *                            stored.
     * @throws AlgebraException if there are numerical instabilities.
     */
    public static void estimate(
            final double x, final double y, final double z,
            final double vx, final double vy, final double vz,
            final Time propagationInterval,
            final INSLooselyCoupledKalmanState previousState,
            final BodyKinematics bodyKinematics,
            final INSLooselyCoupledKalmanConfig config,
            final INSLooselyCoupledKalmanState result) throws AlgebraException {
<span class="fc" id="L1230">        estimate(x, y, z, vx, vy, vz, convertTime(propagationInterval), previousState,</span>
                bodyKinematics, config, result);
<span class="fc" id="L1232">    }</span>

    /**
     * Estimates the update of Kalman filter state for a single epoch.
     *
     * @param x                   ECEF x coordinate of user position expressed in
     *                            meters (m).
     * @param y                   ECEF y coordinate of user position expressed in
     *                            meters (m).
     * @param z                   ECEF z coordinate of user position expressed in
     *                            meters (m).
     * @param vx                  ECEF x coordinate of user velocity expressed in
     *                            meters per second (m/s).
     * @param vy                  ECEF y coordinate of user velocity expressed in
     *                            meters per second (m/s).
     * @param vz                  ECEF z coordinate of user velocity expressed in
     *                            meters per second (m/s).
     * @param propagationInterval propagation interval.
     * @param previousState       previous Kalman filter state.
     * @param bodyKinematics      body kinematics containing measured specific force
     *                            resolved along body frame axes.
     * @param previousLatitude    previous latitude solution expressed in radians (rad).
     * @param config              Loosely Coupled Kalman filter configuration.
     * @return new state of Kalman filter.
     * @throws AlgebraException if there are numerical instabilities.
     */
    public static INSLooselyCoupledKalmanState estimate(
            final double x, final double y, final double z,
            final double vx, final double vy, final double vz,
            final Time propagationInterval,
            final INSLooselyCoupledKalmanState previousState,
            final BodyKinematics bodyKinematics,
            final double previousLatitude,
            final INSLooselyCoupledKalmanConfig config) throws AlgebraException {
<span class="fc" id="L1266">        return estimate(x, y, z, vx, vy, vz, convertTime(propagationInterval),</span>
                previousState, bodyKinematics, previousLatitude, config);
    }

    /**
     * Estimates the update of Kalman filter state for a single epoch.
     *
     * @param x                   ECEF x coordinate of user position expressed in
     *                            meters (m).
     * @param y                   ECEF y coordinate of user position expressed in
     *                            meters (m).
     * @param z                   ECEF z coordinate of user position expressed in
     *                            meters (m).
     * @param vx                  ECEF x coordinate of user velocity expressed in
     *                            meters per second (m/s).
     * @param vy                  ECEF y coordinate of user velocity expressed in
     *                            meters per second (m/s).
     * @param vz                  ECEF z coordinate of user velocity expressed in
     *                            meters per second (m/s).
     * @param propagationInterval propagation interval.
     * @param previousState       previous Kalman filter state.
     * @param bodyKinematics      body kinematics containing measured specific force
     *                            resolved along body frame axes.
     * @param previousLatitude    previous latitude solution expressed in radians (rad).
     * @param config              Loosely Coupled Kalman filter configuration.
     * @param result              instance where new state of Kalman filter will be
     *                            stored.
     * @throws AlgebraException if there are numerical instabilities.
     */
    public static void estimate(
            final double x, final double y, final double z,
            final double vx, final double vy, final double vz,
            final Time propagationInterval,
            final INSLooselyCoupledKalmanState previousState,
            final BodyKinematics bodyKinematics,
            final double previousLatitude,
            final INSLooselyCoupledKalmanConfig config,
            final INSLooselyCoupledKalmanState result) throws AlgebraException {
<span class="fc" id="L1304">        estimate(x, y, z, vx, vy, vz, convertTime(propagationInterval),</span>
                previousState, bodyKinematics, previousLatitude, config, result);
<span class="fc" id="L1306">    }</span>

    /**
     * Estimates the update of Kalman filter state for a single epoch.
     *
     * @param x                   ECEF x coordinate of user position expressed in
     *                            meters (m).
     * @param y                   ECEF y coordinate of user position expressed in
     *                            meters (m).
     * @param z                   ECEF z coordinate of user position expressed in
     *                            meters (m).
     * @param vx                  ECEF x coordinate of user velocity expressed in
     *                            meters per second (m/s).
     * @param vy                  ECEF y coordinate of user velocity expressed in
     *                            meters per second (m/s).
     * @param vz                  ECEF z coordinate of user velocity expressed in
     *                            meters per second (m/s).
     * @param propagationInterval propagation interval.
     * @param previousState       previous Kalman filter state.
     * @param fx                  measured specific force resolved along body frame
     *                            x-axis and expressed in meters per squared
     *                            second (m/s^2).
     * @param fy                  measured specific force resolved along body frame
     *                            y-axis and expressed in meters per squared
     *                            second (m/s^2).
     * @param fz                  measured specific force resolved along body frame
     *                            z-axis and expressed in meters per squared
     *                            second (m/s^2).
     * @param config              Loosely Coupled Kalman filter configuration.
     * @return new state of Kalman filter.
     * @throws AlgebraException if there are numerical instabilities.
     */
    public static INSLooselyCoupledKalmanState estimate(
            final double x, final double y, final double z,
            final double vx, final double vy, final double vz,
            final Time propagationInterval,
            final INSLooselyCoupledKalmanState previousState,
            final double fx, final double fy, final double fz,
            final INSLooselyCoupledKalmanConfig config) throws AlgebraException {
<span class="fc" id="L1345">        return estimate(x, y, z, vx, vy, vz, convertTime(propagationInterval),</span>
                previousState, fx, fy, fz, config);
    }

    /**
     * Estimated the update of Kalman filter state for a single epoch.
     *
     * @param x                   ECEF x coordinate of user position expressed in
     *                            meters (m).
     * @param y                   ECEF y coordinate of user position expressed in
     *                            meters (m).
     * @param z                   ECEF z coordinate of user position expressed in
     *                            meters (m).
     * @param vx                  ECEF x coordinate of user velocity expressed in
     *                            meters per second (m/s).
     * @param vy                  ECEF y coordinate of user velocity expressed in
     *                            meters per second (m/s).
     * @param vz                  ECEF z coordinate of user velocity expressed in
     *                            meters per second (m/s).
     * @param propagationInterval propagation interval.
     * @param previousState       previous Kalman filter state.
     * @param fx                  measured specific force resolved along body frame
     *                            x-axis and expressed in meters per squared
     *                            second (m/s^2).
     * @param fy                  measured specific force resolved along body frame
     *                            y-axis and expressed in meters per squared
     *                            second (m/s^2).
     * @param fz                  measured specific force resolved along body frame
     *                            z-axis and expressed in meters per squared
     *                            second (m/s^2).
     * @param config              Loosely Coupled Kalman filter configuration.
     * @param result              instance where new state of Kalman filter will be
     *                            stored.
     * @throws AlgebraException if there are numerical instabilities.
     */
    public static void estimate(
            final double x, final double y, final double z,
            final double vx, final double vy, final double vz,
            final Time propagationInterval,
            final INSLooselyCoupledKalmanState previousState,
            final double fx, final double fy, final double fz,
            final INSLooselyCoupledKalmanConfig config,
            final INSLooselyCoupledKalmanState result) throws AlgebraException {
<span class="fc" id="L1388">        estimate(x, y, z, vx, vy, vz, convertTime(propagationInterval),</span>
                previousState, fx, fy, fz, config, result);
<span class="fc" id="L1390">    }</span>

    /**
     * Estimates the update of Kalman filter state for a single epoch.
     *
     * @param x                   ECEF x coordinate of user position expressed in
     *                            meters (m).
     * @param y                   ECEF y coordinate of user position expressed in
     *                            meters (m).
     * @param z                   ECEF z coordinate of user position expressed in
     *                            meters (m).
     * @param vx                  ECEF x coordinate of user velocity expressed in
     *                            meters per second (m/s).
     * @param vy                  ECEF y coordinate of user velocity expressed in
     *                            meters per second (m/s).
     * @param vz                  ECEF z coordinate of user velocity expressed in
     *                            meters per second (m/s).
     * @param propagationInterval propagation interval.
     * @param previousState       previous Kalman filter state.
     * @param fx                  measured specific force resolved along body frame
     *                            x-axis and expressed in meters per squared
     *                            second (m/s^2).
     * @param fy                  measured specific force resolved along body frame
     *                            y-axis and expressed in meters per squared
     *                            second (m/s^2).
     * @param fz                  measured specific force resolved along body frame
     *                            z-axis and expressed in meters per squared
     *                            second (m/s^2).
     * @param previousLatitude    previous latitude solution expressed in radians (rad).
     * @param config              Loosely Coupled Kalman filter configuration.
     * @return new state of Kalman filter.
     * @throws AlgebraException if there are numerical instabilities.
     */
    public static INSLooselyCoupledKalmanState estimate(
            final double x, final double y, final double z,
            final double vx, final double vy, final double vz,
            final Time propagationInterval,
            final INSLooselyCoupledKalmanState previousState,
            final double fx, final double fy, final double fz,
            final double previousLatitude,
            final INSLooselyCoupledKalmanConfig config) throws AlgebraException {
<span class="fc" id="L1431">        return estimate(x, y, z, vx, vy, vz, convertTime(propagationInterval),</span>
                previousState, fx, fy, fz, previousLatitude, config);
    }

    /**
     * Estimates the update of Kalman filter state for a single epoch.
     *
     * @param x                   ECEF x coordinate of user position expressed in
     *                            meters (m).
     * @param y                   ECEF y coordinate of user position expressed in
     *                            meters (m).
     * @param z                   ECEF z coordinate of user position expressed in
     *                            meters (m).
     * @param vx                  ECEF x coordinate of user velocity expressed in
     *                            meters per second (m/s).
     * @param vy                  ECEF y coordinate of user velocity expressed in
     *                            meters per second (m/s).
     * @param vz                  ECEF z coordinate of user velocity expressed in
     *                            meters per second (m/s).
     * @param propagationInterval propagation interval.
     * @param previousState       previous Kalman filter state.
     * @param fx                  measured specific force resolved along body frame
     *                            x-axis and expressed in meters per squared
     *                            second (m/s^2).
     * @param fy                  measured specific force resolved along body frame
     *                            y-axis and expressed in meters per squared
     *                            second (m/s^2).
     * @param fz                  measured specific force resolved along body frame
     *                            z-axis and expressed in meters per squared
     *                            second (m/s^2).
     * @param previousLatitude    previous latitude solution expressed in radians (rad).
     * @param config              Loosely Coupled Kalman filter configuration.
     * @param result              instance where new state of Kalman filter will be
     *                            stored.
     * @throws AlgebraException if there are numerical instabilities.
     */
    public static void estimate(
            final double x, final double y, final double z,
            final double vx, final double vy, final double vz,
            final Time propagationInterval,
            final INSLooselyCoupledKalmanState previousState,
            final double fx, final double fy, final double fz,
            final double previousLatitude,
            final INSLooselyCoupledKalmanConfig config,
            final INSLooselyCoupledKalmanState result) throws AlgebraException {
<span class="fc" id="L1476">        estimate(x, y, z, vx, vy, vz, convertTime(propagationInterval),</span>
                previousState, fx, fy, fz, previousLatitude, config, result);
<span class="fc" id="L1478">    }</span>

    /**
     * Estimates the update of Kalman filter state for a single epoch.
     *
     * @param userPosition        ECEF user position expressed in meters (m).
     * @param userVelocity        ECEf user velocity.
     * @param propagationInterval propagation interval expressed in seconds (s).
     * @param previousState       previous Kalman filter state.
     * @param bodyKinematics      body kinematics containing measured specific force
     *                            resolved along body frame axes.
     * @param config              Loosely Coupled Kalman filter configuration.
     * @return new state of Kalman filter.
     * @throws AlgebraException if there are numerical instabilities.
     */
    public static INSLooselyCoupledKalmanState estimate(
            final Point3D userPosition,
            final ECEFVelocity userVelocity,
            final double propagationInterval,
            final INSLooselyCoupledKalmanState previousState,
            final BodyKinematics bodyKinematics,
            final INSLooselyCoupledKalmanConfig config) throws AlgebraException {
<span class="fc" id="L1500">        return estimate(userPosition.getInhomX(), userPosition.getInhomY(),</span>
<span class="fc" id="L1501">                userPosition.getInhomZ(), userVelocity.getVx(), userVelocity.getVy(),</span>
<span class="fc" id="L1502">                userVelocity.getVz(), propagationInterval, previousState, bodyKinematics,</span>
                config);
    }

    /**
     * Estimates the update of Kalman filter state for a single epoch.
     *
     * @param userPosition        ECEF user position expressed in meters (m).
     * @param userVelocity        ECEF user velocity.
     * @param propagationInterval propagation interval expressed in seconds (s).
     * @param previousState       previous Kalman filter state.
     * @param bodyKinematics      body kinematics containing measured specific force
     *                            resolved along body frame axes.
     * @param config              Loosely Coupled Kalman filter configuration.
     * @param result              instance where new state of Kalman filter will be
     *                            stored.
     * @throws AlgebraException if there are numerical instabilities.
     */
    public static void estimate(
            final Point3D userPosition,
            final ECEFVelocity userVelocity,
            final double propagationInterval,
            final INSLooselyCoupledKalmanState previousState,
            final BodyKinematics bodyKinematics,
            final INSLooselyCoupledKalmanConfig config,
            final INSLooselyCoupledKalmanState result) throws AlgebraException {
<span class="fc" id="L1528">        estimate(userPosition.getInhomX(), userPosition.getInhomY(),</span>
<span class="fc" id="L1529">                userPosition.getInhomZ(), userVelocity.getVx(), userVelocity.getVy(),</span>
<span class="fc" id="L1530">                userVelocity.getVz(), propagationInterval, previousState,</span>
                bodyKinematics, config, result);
<span class="fc" id="L1532">    }</span>

    /**
     * Estimates the update of Kalman filter state for a single epoch.
     *
     * @param userPosition        ECEF user position expressed in meters (m).
     * @param userVelocity        ECEF user velocity.
     * @param propagationInterval propagation interval expressed in seconds (s).
     * @param previousState       previous Kalman filter state.
     * @param bodyKinematics      body kinematics containing measured specific force
     *                            resolved along body frame axes.
     * @param previousLatitude    previous latitude solution expressed in radians (rad).
     * @param config              Loosely Coupled Kalman filter configuration.
     * @return new state of Kalman filter.
     * @throws AlgebraException if there are numerical instabilities.
     */
    public static INSLooselyCoupledKalmanState estimate(
            final Point3D userPosition,
            final ECEFVelocity userVelocity,
            final double propagationInterval,
            final INSLooselyCoupledKalmanState previousState,
            final BodyKinematics bodyKinematics,
            final double previousLatitude,
            final INSLooselyCoupledKalmanConfig config) throws AlgebraException {
<span class="fc" id="L1556">        return estimate(userPosition.getInhomX(), userPosition.getInhomY(),</span>
<span class="fc" id="L1557">                userPosition.getInhomZ(), userVelocity.getVx(), userVelocity.getVy(),</span>
<span class="fc" id="L1558">                userVelocity.getVz(), propagationInterval,</span>
                previousState, bodyKinematics, previousLatitude, config);
    }

    /**
     * Estimates the update of Kalman filter state for a single epoch.
     *
     * @param userPosition        ECEF user position expressed in meters (m).
     * @param userVelocity        ECEF user velocity.
     * @param propagationInterval propagation interval expressed in seconds (s).
     * @param previousState       previous Kalman filter state.
     * @param bodyKinematics      body kinematics containing measured specific force
     *                            resolved along body frame axes.
     * @param previousLatitude    previous latitude solution expressed in radians (rad).
     * @param config              Loosely Coupled Kalman filter configuration.
     * @param result              instance where new state of Kalman filter will be
     *                            stored.
     * @throws AlgebraException if there are numerical instabilities.
     */
    public static void estimate(
            final Point3D userPosition,
            final ECEFVelocity userVelocity,
            final double propagationInterval,
            final INSLooselyCoupledKalmanState previousState,
            final BodyKinematics bodyKinematics,
            final double previousLatitude,
            final INSLooselyCoupledKalmanConfig config,
            final INSLooselyCoupledKalmanState result) throws AlgebraException {
<span class="fc" id="L1586">        estimate(userPosition.getInhomX(), userPosition.getInhomY(),</span>
<span class="fc" id="L1587">                userPosition.getInhomZ(), userVelocity.getVx(), userVelocity.getVy(),</span>
<span class="fc" id="L1588">                userVelocity.getVz(), propagationInterval, previousState,</span>
                bodyKinematics, previousLatitude, config, result);
<span class="fc" id="L1590">    }</span>

    /**
     * Estimates the update of Kalman filter state for a single epoch.
     *
     * @param userPosition        ECEF user position expressed in meters (m).
     * @param userVelocity        ECEF user velocity.
     * @param propagationInterval propagation interval expressed in seconds (s).
     * @param previousState       previous Kalman filter state.
     * @param fx                  measured specific force resolved along body frame
     *                            x-axis and expressed in meters per squared
     *                            second (m/s^2).
     * @param fy                  measured specific force resolved along body frame
     *                            y-axis and expressed in meters per squared
     *                            second (m/s^2).
     * @param fz                  measured specific force resolved along body frame
     *                            z-axis and expressed in meters per squared
     *                            second (m/s^2).
     * @param config              Loosely Coupled Kalman filter configuration.
     * @return new state of Kalman filter.
     * @throws AlgebraException if there are numerical instabilities.
     */
    public static INSLooselyCoupledKalmanState estimate(
            final Point3D userPosition,
            final ECEFVelocity userVelocity,
            final double propagationInterval,
            final INSLooselyCoupledKalmanState previousState,
            final double fx, final double fy, final double fz,
            final INSLooselyCoupledKalmanConfig config) throws AlgebraException {
<span class="fc" id="L1619">        return estimate(userPosition.getInhomX(), userPosition.getInhomY(),</span>
<span class="fc" id="L1620">                userPosition.getInhomZ(), userVelocity.getVx(), userVelocity.getVy(),</span>
<span class="fc" id="L1621">                userVelocity.getVz(), propagationInterval, previousState,</span>
                fx, fy, fz, config);
    }

    /**
     * Estimates the update of Kalman filter state for a single epoch.
     *
     * @param userPosition        ECEF user position expressed in meters (m).
     * @param userVelocity        ECEF user velocity.
     * @param propagationInterval propagation interval expressed in seconds (s).
     * @param previousState       previous Kalman filter state.
     * @param fx                  measured specific force resolved along body frame
     *                            x-axis and expressed in meters per squared
     *                            second (m/s^2).
     * @param fy                  measured specific force resolved along body frame
     *                            y-axis and expressed in meters per squared
     *                            second (m/s^2).
     * @param fz                  measured specific force resolved along body frame
     *                            z-axis and expressed in meters per squared
     *                            second (m/s^2).
     * @param config              Loosely Coupled Kalman filter configuration.
     * @param result              instance where new state of Kalman filter will be
     *                            stored.
     * @throws AlgebraException if there are numerical instabilities.
     */
    public static void estimate(
            final Point3D userPosition,
            final ECEFVelocity userVelocity,
            final double propagationInterval,
            final INSLooselyCoupledKalmanState previousState,
            final double fx, final double fy, final double fz,
            final INSLooselyCoupledKalmanConfig config,
            final INSLooselyCoupledKalmanState result) throws AlgebraException {
<span class="fc" id="L1654">        estimate(userPosition.getInhomX(), userPosition.getInhomY(),</span>
<span class="fc" id="L1655">                userPosition.getInhomZ(), userVelocity.getVx(), userVelocity.getVy(),</span>
<span class="fc" id="L1656">                userVelocity.getVz(), propagationInterval, previousState,</span>
                fx, fy, fz, config, result);
<span class="fc" id="L1658">    }</span>

    /**
     * Estimates the update of Kalman filter state for a single epoch.
     *
     * @param userPosition        ECEF user position expressed in meters (m).
     * @param userVelocity        ECEF user velocity.
     * @param propagationInterval propagation interval expressed in seconds (s).
     * @param previousState       previous Kalman filter state.
     * @param fx                  measured specific force resolved along body frame
     *                            x-axis and expressed in meters per squared
     *                            second (m/s^2).
     * @param fy                  measured specific force resolved along body frame
     *                            y-axis and expressed in meters per squared
     *                            second (m/s^2).
     * @param fz                  measured specific force resolved along body frame
     *                            z-axis and expressed in meters per squared
     *                            second (m/s^2).
     * @param previousLatitude    previous latitude solution expressed in radians (rad).
     * @param config              Loosely Coupled Kalman filter configuration.
     * @return new state of Kalman filter.
     * @throws AlgebraException if there are numerical instabilities.
     */
    public static INSLooselyCoupledKalmanState estimate(
            final Point3D userPosition,
            final ECEFVelocity userVelocity,
            final double propagationInterval,
            final INSLooselyCoupledKalmanState previousState,
            final double fx, final double fy, final double fz,
            final double previousLatitude,
            final INSLooselyCoupledKalmanConfig config) throws AlgebraException {
<span class="fc" id="L1689">        return estimate(userPosition.getInhomX(), userPosition.getInhomY(),</span>
<span class="fc" id="L1690">                userPosition.getInhomZ(), userVelocity.getVx(), userVelocity.getVy(),</span>
<span class="fc" id="L1691">                userVelocity.getVz(), propagationInterval, previousState,</span>
                fx, fy, fz, previousLatitude, config);
    }

    /**
     * Estimates the update of Kalman filter state for a single epoch.
     *
     * @param userPosition        ECEF user position expressed in meters (m).
     * @param userVelocity        ECEF user velocity.
     * @param propagationInterval propagation interval expressed in seconds (s).
     * @param previousState       previous Kalman filter state.
     * @param fx                  measured specific force resolved along body frame
     *                            x-axis and expressed in meters per squared
     *                            second (m/s^2).
     * @param fy                  measured specific force resolved along body frame
     *                            y-axis and expressed in meters per squared
     *                            second (m/s^2).
     * @param fz                  measured specific force resolved along body frame
     *                            z-axis and expressed in meters per squared
     *                            second (m/s^2).
     * @param previousLatitude    previous latitude solution expressed in radians (rad).
     * @param config              Loosely Coupled Kalman filter configuration.
     * @param result              instance where new state of Kalman filter will be
     *                            stored.
     * @throws AlgebraException if there are numerical instabilities.
     */
    public static void estimate(
            final Point3D userPosition,
            final ECEFVelocity userVelocity,
            final double propagationInterval,
            final INSLooselyCoupledKalmanState previousState,
            final double fx, final double fy, final double fz,
            final double previousLatitude,
            final INSLooselyCoupledKalmanConfig config,
            final INSLooselyCoupledKalmanState result) throws AlgebraException {
<span class="fc" id="L1726">        estimate(userPosition.getInhomX(), userPosition.getInhomY(),</span>
<span class="fc" id="L1727">                userPosition.getInhomZ(), userVelocity.getVx(), userVelocity.getVy(),</span>
<span class="fc" id="L1728">                userVelocity.getVz(), propagationInterval, previousState,</span>
                fx, fy, fz, previousLatitude, config, result);
<span class="fc" id="L1730">    }</span>

    /**
     * Estimates the update of Kalman filter state for a single epoch.
     *
     * @param userPosition        ECEF user position expressed in meters (m).
     * @param userVelocity        ECEF user velocity.
     * @param propagationInterval propagation interval.
     * @param previousState       previous Kalman filter state.
     * @param bodyKinematics      body kinematics containing measured specific force
     *                            resolved along body frame axes.
     * @param config              Loosely Coupled Kalman filter configuration.
     * @return new state of Kalman filter.
     * @throws AlgebraException if there are numerical instabilities.
     */
    public static INSLooselyCoupledKalmanState estimate(
            final Point3D userPosition,
            final ECEFVelocity userVelocity,
            final Time propagationInterval,
            final INSLooselyCoupledKalmanState previousState,
            final BodyKinematics bodyKinematics,
            final INSLooselyCoupledKalmanConfig config) throws AlgebraException {
<span class="fc" id="L1752">        return estimate(userPosition.getInhomX(), userPosition.getInhomY(),</span>
<span class="fc" id="L1753">                userPosition.getInhomZ(), userVelocity.getVx(), userVelocity.getVy(),</span>
<span class="fc" id="L1754">                userVelocity.getVz(), propagationInterval, previousState,</span>
                bodyKinematics, config);
    }

    /**
     * Estimates the update of Kalman filter state for a single epoch.
     *
     * @param userPosition        ECEF user position expressed in meters (m).
     * @param userVelocity        ECEF user velocity.
     * @param propagationInterval propagation interval.
     * @param previousState       previous Kalman filter state.
     * @param bodyKinematics      body kinematics containing measured specific force
     *                            resolved along body frame axes.
     * @param config              Loosely Coupled Kalman filter configuration.
     * @param result              instance where new state of Kalman filter will be
     *                            stored.
     * @throws AlgebraException if there are numerical instabilities.
     */
    public static void estimate(
            final Point3D userPosition,
            final ECEFVelocity userVelocity,
            final Time propagationInterval,
            final INSLooselyCoupledKalmanState previousState,
            final BodyKinematics bodyKinematics,
            final INSLooselyCoupledKalmanConfig config,
            final INSLooselyCoupledKalmanState result) throws AlgebraException {
<span class="fc" id="L1780">        estimate(userPosition.getInhomX(), userPosition.getInhomY(),</span>
<span class="fc" id="L1781">                userPosition.getInhomZ(), userVelocity.getVx(),</span>
<span class="fc" id="L1782">                userVelocity.getVy(), userVelocity.getVz(),</span>
                propagationInterval, previousState, bodyKinematics, config,
                result);
<span class="fc" id="L1785">    }</span>

    /**
     * Estimates the update of Kalman filter state for a single epoch.
     *
     * @param userPosition        ECEF user position expressed in meters (m).
     * @param userVelocity        ECEF user velocity.
     * @param propagationInterval propagation interval.
     * @param previousState       previous Kalman filter state.
     * @param bodyKinematics      body kinematics containing measured specific force
     *                            resolved along body frame axes.
     * @param previousLatitude    previous latitude solution expressed in radians (rad).
     * @param config              Loosely Coupled Kalman filter configuration.
     * @return new state of Kalman filter.
     * @throws AlgebraException if there are numerical instabilities.
     */
    public static INSLooselyCoupledKalmanState estimate(
            final Point3D userPosition,
            final ECEFVelocity userVelocity,
            final Time propagationInterval,
            final INSLooselyCoupledKalmanState previousState,
            final BodyKinematics bodyKinematics,
            final double previousLatitude,
            final INSLooselyCoupledKalmanConfig config) throws AlgebraException {
<span class="fc" id="L1809">        return estimate(userPosition.getInhomX(), userPosition.getInhomY(),</span>
<span class="fc" id="L1810">                userPosition.getInhomZ(), userVelocity.getVx(), userVelocity.getVy(),</span>
<span class="fc" id="L1811">                userVelocity.getVz(), propagationInterval, previousState,</span>
                bodyKinematics, previousLatitude, config);
    }

    /**
     * Estimates the update of Kalman filter state for a single epoch.
     *
     * @param userPosition        ECEF user position expressed in meters (m).
     * @param userVelocity        ECEF user velocity.
     * @param propagationInterval propagation interval.
     * @param previousState       previous Kalman filter state.
     * @param bodyKinematics      body kinematics containing measured specific force
     *                            resolved along body frame axes.
     * @param previousLatitude    previous latitude solution expressed in radians (rad).
     * @param config              Loosely Coupled Kalman filter configuration.
     * @param result              instance where new state of Kalman filter will be
     *                            stored.
     * @throws AlgebraException if there are numerical instabilities.
     */
    public static void estimate(
            final Point3D userPosition,
            final ECEFVelocity userVelocity,
            final Time propagationInterval,
            final INSLooselyCoupledKalmanState previousState,
            final BodyKinematics bodyKinematics,
            final double previousLatitude,
            final INSLooselyCoupledKalmanConfig config,
            final INSLooselyCoupledKalmanState result) throws AlgebraException {
<span class="fc" id="L1839">        estimate(userPosition.getInhomX(), userPosition.getInhomY(),</span>
<span class="fc" id="L1840">                userPosition.getInhomZ(), userVelocity.getVx(), userVelocity.getVy(),</span>
<span class="fc" id="L1841">                userVelocity.getVz(), propagationInterval, previousState,</span>
                bodyKinematics, previousLatitude, config, result);
<span class="fc" id="L1843">    }</span>

    /**
     * Estimates the update of Kalman filter state for a single epoch.
     *
     * @param userPosition        ECEF user position expressed in meters (m).
     * @param userVelocity        ECEF user velocity.
     * @param propagationInterval propagation interval.
     * @param previousState       previous Kalman filter state.
     * @param fx                  measured specific force resolved along body frame
     *                            x-axis and expressed in meters per squared
     *                            second (m/s^2).
     * @param fy                  measured specific force resolved along body frame
     *                            y-axis and expressed in meters per squared
     *                            second (m/s^2).
     * @param fz                  measured specific force resolved along body frame
     *                            z-axis and expressed in meters per squared
     *                            second (m/s^2).
     * @param config              Loosely Coupled Kalman filter configuration.
     * @return new state of Kalman filter.
     * @throws AlgebraException if there are numerical instabilities.
     */
    public static INSLooselyCoupledKalmanState estimate(
            final Point3D userPosition,
            final ECEFVelocity userVelocity,
            final Time propagationInterval,
            final INSLooselyCoupledKalmanState previousState,
            final double fx, final double fy, final double fz,
            final INSLooselyCoupledKalmanConfig config) throws AlgebraException {
<span class="fc" id="L1872">        return estimate(userPosition.getInhomX(), userPosition.getInhomY(),</span>
<span class="fc" id="L1873">                userPosition.getInhomZ(), userVelocity.getVx(), userVelocity.getVy(),</span>
<span class="fc" id="L1874">                userVelocity.getVz(), propagationInterval, previousState,</span>
                fx, fy, fz, config);
    }

    /**
     * Estimates the update of Kalman filter state for a single epoch.
     *
     * @param userPosition        ECEF user position expressed in meters (m).
     * @param userVelocity        ECEF user velocity.
     * @param propagationInterval propagation interval.
     * @param previousState       previous Kalman filter state.
     * @param fx                  measured specific force resolved along body frame
     *                            x-axis and expressed in meters per squared
     *                            second (m/s^2).
     * @param fy                  measured specific force resolved along body frame
     *                            y-axis and expressed in meters per squared
     *                            second (m/s^2).
     * @param fz                  measured specific force resolved along body frame
     *                            z-axis and expressed in meters per squared
     *                            second (m/s^2).
     * @param config              Loosely Coupled Kalman filter configuration.
     * @param result              instance where new state of Kalman filter will be
     *                            stored.
     * @throws AlgebraException if there are anumerical instabilities.
     */
    public static void estimate(
            final Point3D userPosition,
            final ECEFVelocity userVelocity,
            final Time propagationInterval,
            final INSLooselyCoupledKalmanState previousState,
            final double fx, final double fy, final double fz,
            final INSLooselyCoupledKalmanConfig config,
            final INSLooselyCoupledKalmanState result) throws AlgebraException {
<span class="fc" id="L1907">        estimate(userPosition.getInhomX(), userPosition.getInhomY(),</span>
<span class="fc" id="L1908">                userPosition.getInhomZ(), userVelocity.getVx(), userVelocity.getVy(),</span>
<span class="fc" id="L1909">                userVelocity.getVz(), propagationInterval, previousState,</span>
                fx, fy, fz, config, result);
<span class="fc" id="L1911">    }</span>

    /**
     * Estimtes the update of Kalman filter state for a single epoch.
     *
     * @param userPosition        ECEF user position expressed in meters (m).
     * @param userVelocity        ECEF user velocity.
     * @param propagationInterval propagation interval.
     * @param previousState       previous Kalman filter state.
     * @param fx                  measured specific force resolved along body frame
     *                            x-axis and expressed in meters per squared
     *                            second (m/s^2).
     * @param fy                  measured specific force resolved along body frame
     *                            y-axis and expressed in meters per squared
     *                            second (m/s^2).
     * @param fz                  measured specific force resolved along body frame
     *                            z-axis and expressed in meters per squared
     *                            second (m/s^2).
     * @param previousLatitude    previous latitude solution expressed in radians (rad).
     * @param config              Loosely Coupled Kalman filter configuration.
     * @return new state of Kalman filter.
     * @throws AlgebraException if there are numerical instabilities.
     */
    public static INSLooselyCoupledKalmanState estimate(
            final Point3D userPosition,
            final ECEFVelocity userVelocity,
            final Time propagationInterval,
            final INSLooselyCoupledKalmanState previousState,
            final double fx, final double fy, final double fz,
            final double previousLatitude,
            final INSLooselyCoupledKalmanConfig config) throws AlgebraException {
<span class="fc" id="L1942">        return estimate(userPosition.getInhomX(), userPosition.getInhomY(),</span>
<span class="fc" id="L1943">                userPosition.getInhomZ(), userVelocity.getVx(), userVelocity.getVy(),</span>
<span class="fc" id="L1944">                userVelocity.getVz(), propagationInterval, previousState,</span>
                fx, fy, fz, previousLatitude, config);
    }

    /**
     * Estimates the update of Kalman filter state for a single epoch.
     *
     * @param userPosition        ECEF user position expressed in meters (m).
     * @param userVelocity        ECEF user velocity.
     * @param propagationInterval propagation interval.
     * @param previousState       previous Kalman filter state.
     * @param fx                  measured specific force resolved along body frame
     *                            x-axis and expressed in meters per squared
     *                            second (m/s^2).
     * @param fy                  measured specific force resolved along body frame
     *                            y-axis and expressed in meters per squared
     *                            second (m/s^2).
     * @param fz                  measured specific force resolved along body frame
     *                            z-axis and expressed in meters per squared
     *                            second (m/s^2).
     * @param previousLatitude    previous latitude solution expressed in radians (rad).
     * @param config              Loosely Coupled Kalman filter configuration.
     * @param result              instance where new state of Kalman filter will be
     *                            stored.
     * @throws AlgebraException if there are numerical instabilities.
     */
    public static void estimate(
            final Point3D userPosition,
            final ECEFVelocity userVelocity,
            final Time propagationInterval,
            final INSLooselyCoupledKalmanState previousState,
            final double fx, final double fy, final double fz,
            final double previousLatitude,
            final INSLooselyCoupledKalmanConfig config,
            final INSLooselyCoupledKalmanState result) throws AlgebraException {
<span class="fc" id="L1979">        estimate(userPosition.getInhomX(), userPosition.getInhomY(),</span>
<span class="fc" id="L1980">                userPosition.getInhomZ(), userVelocity.getVx(), userVelocity.getVy(),</span>
<span class="fc" id="L1981">                userVelocity.getVz(), propagationInterval, previousState,</span>
                fx, fy, fz, previousLatitude, config, result);
<span class="fc" id="L1983">    }</span>

    /**
     * Estimates the update of Kalman filter state for a single epoch.
     *
     * @param positionAndVelocity ECEF user position and velocity.
     * @param propagationInterval propagation interval expressed in seconds (s).
     * @param previousState       previous Kalman filter state.
     * @param bodyKinematics      body kinematics containing measured specific force
     *                            resolved along body frame axes.
     * @param config              Loosely Coupled Kalman filter configuration.
     * @return new state of Kalman filter.
     * @throws AlgebraException if there are numerical instabilities.
     */
    public static INSLooselyCoupledKalmanState estimate(
            final ECEFPositionAndVelocity positionAndVelocity,
            final double propagationInterval,
            final INSLooselyCoupledKalmanState previousState,
            final BodyKinematics bodyKinematics,
            final INSLooselyCoupledKalmanConfig config) throws AlgebraException {
<span class="fc" id="L2003">        return estimate(positionAndVelocity.getX(), positionAndVelocity.getY(),</span>
<span class="fc" id="L2004">                positionAndVelocity.getZ(), positionAndVelocity.getVx(),</span>
<span class="fc" id="L2005">                positionAndVelocity.getVy(), positionAndVelocity.getVz(),</span>
                propagationInterval, previousState, bodyKinematics,
                config);
    }

    /**
     * Estimates the update of Kalman filter state for a single epoch.
     *
     * @param positionAndVelocity ECEF user position and velocity.
     * @param propagationInterval propagation interval expressed in seconds (s).
     * @param previousState       previous Kalman filter state.
     * @param bodyKinematics      body kinematics containing measured specific force
     *                            resolved along body frame axes.
     * @param config              Loosely Coupled Kalman filter configuration.
     * @param result              instance where new state of Kalman filter will be
     *                            stored.
     * @throws AlgebraException if there are numerical instabilities.
     */
    public static void estimate(
            final ECEFPositionAndVelocity positionAndVelocity,
            final double propagationInterval,
            final INSLooselyCoupledKalmanState previousState,
            final BodyKinematics bodyKinematics,
            final INSLooselyCoupledKalmanConfig config,
            final INSLooselyCoupledKalmanState result) throws AlgebraException {
<span class="fc" id="L2030">        estimate(positionAndVelocity.getX(), positionAndVelocity.getY(),</span>
<span class="fc" id="L2031">                positionAndVelocity.getZ(), positionAndVelocity.getVx(),</span>
<span class="fc" id="L2032">                positionAndVelocity.getVy(), positionAndVelocity.getVz(),</span>
                propagationInterval, previousState, bodyKinematics,
                config, result);
<span class="fc" id="L2035">    }</span>

    /**
     * Estimates the update of Kalman filter state for a single epoch.
     *
     * @param positionAndVelocity ECEF user position and velocity.
     * @param propagationInterval propagation interval expressed in seconds (s).
     * @param previousState       previous Kalman filter state.
     * @param bodyKinematics      body kinematics containing measured specific force
     *                            resolved along body frame axes.
     * @param previousLatitude    previous latitude solution expressed in radians (rad).
     * @param config              Loosely Coupled Kalman filter configuration.
     * @return new state of Kalman filter.
     * @throws AlgebraException if there are numerical instabilities.
     */
    public static INSLooselyCoupledKalmanState estimate(
            final ECEFPositionAndVelocity positionAndVelocity,
            final double propagationInterval,
            final INSLooselyCoupledKalmanState previousState,
            final BodyKinematics bodyKinematics,
            final double previousLatitude,
            final INSLooselyCoupledKalmanConfig config) throws AlgebraException {
<span class="fc" id="L2057">        return estimate(positionAndVelocity.getX(), positionAndVelocity.getY(),</span>
<span class="fc" id="L2058">                positionAndVelocity.getZ(), positionAndVelocity.getVx(),</span>
<span class="fc" id="L2059">                positionAndVelocity.getVy(), positionAndVelocity.getVz(),</span>
                propagationInterval, previousState, bodyKinematics,
                previousLatitude, config);
    }

    /**
     * Estimates the update of Kalman filter state for a single epoch.
     *
     * @param positionAndVelocity ECEF user position and velocity.
     * @param propagationInterval propagation interval expressed in seconds (s).
     * @param previousState       previous Kalman filter state.
     * @param bodyKinematics      body kinematics containing measured specific force
     *                            resolved along body frame axes.
     * @param previousLatitude    previous latitude solution expressed in radians (rad).
     * @param config              Loosely Coupled Kalman filter configuration.
     * @param result              instance where new state of Kalman filter will be
     *                            stored.
     * @throws AlgebraException if there are numerical instabilities.
     */
    public static void estimate(
            final ECEFPositionAndVelocity positionAndVelocity,
            final double propagationInterval,
            final INSLooselyCoupledKalmanState previousState,
            final BodyKinematics bodyKinematics,
            final double previousLatitude,
            final INSLooselyCoupledKalmanConfig config,
            final INSLooselyCoupledKalmanState result) throws AlgebraException {
<span class="fc" id="L2086">        estimate(positionAndVelocity.getX(), positionAndVelocity.getY(),</span>
<span class="fc" id="L2087">                positionAndVelocity.getZ(), positionAndVelocity.getVx(),</span>
<span class="fc" id="L2088">                positionAndVelocity.getVy(), positionAndVelocity.getVz(),</span>
                propagationInterval, previousState, bodyKinematics,
                previousLatitude, config, result);
<span class="fc" id="L2091">    }</span>

    /**
     * Estimates the update of Kalman filter state for a single epoch.
     *
     * @param positionAndVelocity ECEF user position and velocity.
     * @param propagationInterval propagation interval expressed in seconds (s).
     * @param previousState       previous Kalman filter state.
     * @param fx                  measured specific force resolved along body frame
     *                            x-axis and expressed in meters per squared
     *                            second (m/s^2).
     * @param fy                  measured specific force resolved along body frame
     *                            y-axis and expressed in meters per squared
     *                            second (m/s^2).
     * @param fz                  measured specific force resolved along body frame
     *                            z-axis and expressed in meters per squared
     *                            second (m/s^2).
     * @param config              Loosely Coupled Kalman filter configuration.
     * @return new state of Kalman filter.
     * @throws AlgebraException if there are numerical instabilities.
     */
    public static INSLooselyCoupledKalmanState estimate(
            final ECEFPositionAndVelocity positionAndVelocity,
            final double propagationInterval,
            final INSLooselyCoupledKalmanState previousState,
            final double fx, final double fy, final double fz,
            final INSLooselyCoupledKalmanConfig config) throws AlgebraException {
<span class="fc" id="L2118">        return estimate(positionAndVelocity.getX(), positionAndVelocity.getY(),</span>
<span class="fc" id="L2119">                positionAndVelocity.getZ(), positionAndVelocity.getVx(),</span>
<span class="fc" id="L2120">                positionAndVelocity.getVy(), positionAndVelocity.getVz(),</span>
                propagationInterval, previousState, fx, fy, fz, config);
    }

    /**
     * Estimates the update of Kalman filter state for a single epoch.
     *
     * @param positionAndVelocity ECEF user position and velocity.
     * @param propagationInterval propagation interval expressed in seconds (s).
     * @param previousState       previous Kalman filter state.
     * @param fx                  measured specific force resolved along body frame
     *                            x-axis and expressed in meters per squared
     *                            second (m/s^2).
     * @param fy                  measured specific force resolved along body frame
     *                            y-axis and expressed in meters per squared
     *                            second (m/s^2).
     * @param fz                  measured specific force resolved along body frame
     *                            z-axis and expressed in meters per squared
     *                            second (m/s^2).
     * @param config              Loosely Coupled Kalman filter configuration.
     * @param result              instance where new state of Kalman filter will be stored.
     * @throws AlgebraException if there are numerical instabilities.
     */
    public static void estimate(
            final ECEFPositionAndVelocity positionAndVelocity,
            final double propagationInterval,
            final INSLooselyCoupledKalmanState previousState,
            final double fx, final double fy, final double fz,
            final INSLooselyCoupledKalmanConfig config,
            final INSLooselyCoupledKalmanState result) throws AlgebraException {
<span class="fc" id="L2150">        estimate(positionAndVelocity.getX(), positionAndVelocity.getY(),</span>
<span class="fc" id="L2151">                positionAndVelocity.getZ(), positionAndVelocity.getVx(),</span>
<span class="fc" id="L2152">                positionAndVelocity.getVy(), positionAndVelocity.getVz(),</span>
                propagationInterval, previousState, fx, fy, fz, config, result);
<span class="fc" id="L2154">    }</span>

    /**
     * Estimates the update of Kalman filter state for a single epoch.
     *
     * @param positionAndVelocity ECEF user position and velocity.
     * @param propagationInterval propagation interval expressed in seconds (s).
     * @param previousState       previous Kalman filter state.
     * @param fx                  measured specific force resolved along body frame
     *                            x-axis and expressed in meters per squared
     *                            second (m/s^2).
     * @param fy                  measured specific force resolved along body frame
     *                            y-axis and expressed in meters per squared
     *                            second (m/s^2).
     * @param fz                  measured specific force resolved along body frame
     *                            z-axis and expressed in meters per squared
     *                            second (m/s^2).
     * @param previousLatitude    previous latitude solution expressed in radians (rad).
     * @param config              Loosely Coupled Kalman filter configuration.
     * @return new state of Kalman filter.
     * @throws AlgebraException if there are numerical instabilities.
     */
    public static INSLooselyCoupledKalmanState estimate(
            final ECEFPositionAndVelocity positionAndVelocity,
            final double propagationInterval,
            final INSLooselyCoupledKalmanState previousState,
            final double fx, final double fy, final double fz,
            final double previousLatitude,
            final INSLooselyCoupledKalmanConfig config) throws AlgebraException {
<span class="fc" id="L2183">        return estimate(positionAndVelocity.getX(), positionAndVelocity.getY(),</span>
<span class="fc" id="L2184">                positionAndVelocity.getZ(), positionAndVelocity.getVx(),</span>
<span class="fc" id="L2185">                positionAndVelocity.getVy(), positionAndVelocity.getVz(),</span>
                propagationInterval, previousState, fx, fy, fz, previousLatitude,
                config);
    }

    /**
     * Estimates the update of Kalman filter state for a single epoch.
     *
     * @param positionAndVelocity ECEF user position and velocity.
     * @param propagationInterval propagation interval expressed in seconds (s).
     * @param previousState       previous Kalman filter state.
     * @param fx                  measured specific force resolved along body frame
     *                            x-axis and expressed in meters per squared
     *                            second (m/s^2).
     * @param fy                  measured specific force resolved along body frame
     *                            y-axis and expressed in meters per squared
     *                            second (m/s^2).
     * @param fz                  measured specific force resolved along body frame
     *                            z-axis and expressed in meters per squared
     *                            second (m/s^2).
     * @param previousLatitude    previous latitude solution expressed in radians (rad).
     * @param config              Loosely Coupled Kalman filter configuration.
     * @param result              instance where new state of Kalman filter will be
     *                            stored.
     * @throws AlgebraException if there are numerical instabilities.
     */
    public static void estimate(
            final ECEFPositionAndVelocity positionAndVelocity,
            final double propagationInterval,
            final INSLooselyCoupledKalmanState previousState,
            final double fx, final double fy, final double fz,
            final double previousLatitude,
            final INSLooselyCoupledKalmanConfig config,
            final INSLooselyCoupledKalmanState result) throws AlgebraException {
<span class="fc" id="L2219">        estimate(positionAndVelocity.getX(), positionAndVelocity.getY(),</span>
<span class="fc" id="L2220">                positionAndVelocity.getZ(), positionAndVelocity.getVx(),</span>
<span class="fc" id="L2221">                positionAndVelocity.getVy(), positionAndVelocity.getVz(),</span>
                propagationInterval, previousState, fx, fy, fz, previousLatitude,
                config, result);
<span class="fc" id="L2224">    }</span>

    /**
     * Estimates the update of Kalman filter state for a single epoch.
     *
     * @param positionAndVelocity ECEF user position and velocity.
     * @param propagationInterval propagation interval.
     * @param previousState       previous Kalman filter state.
     * @param bodyKinematics      body kinematics containing measured specific force
     *                            resolved along body frame axes.
     * @param config              Loosely Coupled Kalman filter configuration.
     * @return new state of Kalman filter.
     * @throws AlgebraException if there are numerical instabilities.
     */
    public static INSLooselyCoupledKalmanState estimate(
            final ECEFPositionAndVelocity positionAndVelocity,
            final Time propagationInterval,
            final INSLooselyCoupledKalmanState previousState,
            final BodyKinematics bodyKinematics,
            final INSLooselyCoupledKalmanConfig config) throws AlgebraException {
<span class="fc" id="L2244">        return estimate(positionAndVelocity.getX(), positionAndVelocity.getY(),</span>
<span class="fc" id="L2245">                positionAndVelocity.getZ(), positionAndVelocity.getVx(),</span>
<span class="fc" id="L2246">                positionAndVelocity.getVy(), positionAndVelocity.getVz(),</span>
                propagationInterval, previousState, bodyKinematics, config);
    }

    /**
     * Estimates the update of Kalman filter state for a single epoch.
     *
     * @param positionAndVelocity ECEF user position and velocity.
     * @param propagationInterval propagation interval.
     * @param previousState       previous Kalman filter state.
     * @param bodyKinematics      body kinematics containing measured specific force
     *                            resolved along body frame axes.
     * @param config              Loosely Coupled Kalman filter configuration.
     * @param result              instace where new state of Kalman filter will be
     *                            stored.
     * @throws AlgebraException if there are numerical instabilities.
     */
    public static void estimate(
            final ECEFPositionAndVelocity positionAndVelocity,
            final Time propagationInterval,
            final INSLooselyCoupledKalmanState previousState,
            final BodyKinematics bodyKinematics,
            final INSLooselyCoupledKalmanConfig config,
            final INSLooselyCoupledKalmanState result) throws AlgebraException {
<span class="fc" id="L2270">        estimate(positionAndVelocity.getX(), positionAndVelocity.getY(),</span>
<span class="fc" id="L2271">                positionAndVelocity.getZ(), positionAndVelocity.getVx(),</span>
<span class="fc" id="L2272">                positionAndVelocity.getVy(), positionAndVelocity.getVz(),</span>
                propagationInterval, previousState, bodyKinematics,
                config, result);
<span class="fc" id="L2275">    }</span>

    /**
     * Estimates the update of Kalman filter state for a single epoch.
     *
     * @param positionAndVelocity ECEF user position and velocity.
     * @param propagationInterval propagation interval.
     * @param previousState       previous Kalman filter state.
     * @param bodyKinematics      body kinematics containing measured specific force
     *                            resolved along body frame axes.
     * @param previousLatitude    previous latitude solution expressed in radians (rad).
     * @param config              Loosely Coupled Kalman filter configuration.
     * @return new state of Kalman filter.
     * @throws AlgebraException if there are numerical instabilities.
     */
    public static INSLooselyCoupledKalmanState estimate(
            final ECEFPositionAndVelocity positionAndVelocity,
            final Time propagationInterval,
            final INSLooselyCoupledKalmanState previousState,
            final BodyKinematics bodyKinematics,
            final double previousLatitude,
            final INSLooselyCoupledKalmanConfig config) throws AlgebraException {
<span class="fc" id="L2297">        return estimate(positionAndVelocity.getX(), positionAndVelocity.getY(),</span>
<span class="fc" id="L2298">                positionAndVelocity.getZ(), positionAndVelocity.getVx(),</span>
<span class="fc" id="L2299">                positionAndVelocity.getVy(), positionAndVelocity.getVz(),</span>
                propagationInterval, previousState, bodyKinematics,
                previousLatitude, config);
    }

    /**
     * Estimates the update of Kalman filter state for a single epoch.
     *
     * @param positionAndVelocity ECEF user position and velocity.
     * @param propagationInterval propagation interval.
     * @param previousState       previous Kalman filter state.
     * @param bodyKinematics      body kinematics containing measured specific force
     *                            resolved along body frame axes.
     * @param previousLatitude    previous latitude solution expressed in radians (rad).
     * @param config              Loosely Coupled Kalman filter configuration.
     * @param result              instance where new state of Kalman filter will be
     *                            stored.
     * @throws AlgebraException if there are numerical instabilities.
     */
    public static void estimate(
            final ECEFPositionAndVelocity positionAndVelocity,
            final Time propagationInterval,
            final INSLooselyCoupledKalmanState previousState,
            final BodyKinematics bodyKinematics,
            final double previousLatitude,
            final INSLooselyCoupledKalmanConfig config,
            final INSLooselyCoupledKalmanState result) throws AlgebraException {
<span class="fc" id="L2326">        estimate(positionAndVelocity.getX(), positionAndVelocity.getY(),</span>
<span class="fc" id="L2327">                positionAndVelocity.getZ(), positionAndVelocity.getVx(),</span>
<span class="fc" id="L2328">                positionAndVelocity.getVy(), positionAndVelocity.getVz(),</span>
                propagationInterval, previousState, bodyKinematics,
                previousLatitude, config, result);
<span class="fc" id="L2331">    }</span>

    /**
     * Estimates the update of Kalman filter state for a single epoch.
     *
     * @param positionAndVelocity ECEF user position and velocity.
     * @param propagationInterval propagation interval.
     * @param previousState       previous Kalman filter state.
     * @param fx                  measured specific force resolved along body frame
     *                            x-axis and expressed in meters per squared
     *                            second (m/s^2).
     * @param fy                  measured specific force resolved along body frame
     *                            y-axis and expressed in meters per squared
     *                            second (m/s^2).
     * @param fz                  measured specific force resolved along body frame
     *                            z-axis and expressed in meters per squared
     *                            second (m/s^2).
     * @param config              Loosely Coupled Kalman filter configuration.
     * @return new state of Kalman filter.
     * @throws AlgebraException if there are numerical instabilities.
     */
    public static INSLooselyCoupledKalmanState estimate(
            final ECEFPositionAndVelocity positionAndVelocity,
            final Time propagationInterval,
            final INSLooselyCoupledKalmanState previousState,
            final double fx, final double fy, final double fz,
            final INSLooselyCoupledKalmanConfig config) throws AlgebraException {
<span class="fc" id="L2358">        return estimate(positionAndVelocity.getX(), positionAndVelocity.getY(),</span>
<span class="fc" id="L2359">                positionAndVelocity.getZ(), positionAndVelocity.getVx(),</span>
<span class="fc" id="L2360">                positionAndVelocity.getVy(), positionAndVelocity.getVz(),</span>
                propagationInterval, previousState, fx, fy, fz, config);
    }

    /**
     * Estimates the update of Kalman filter state for a single epoch.
     *
     * @param positionAndVelocity ECEF user position and velocity.
     * @param propagationInterval propagation interval.
     * @param previousState       previous Kalman filter state.
     * @param fx                  measured specific force resolved along body frame
     *                            x-axis and expressed in meters per squared
     *                            second (m/s^2).
     * @param fy                  measured specific force resolved along body frame
     *                            y-axis and expressed in meters per squared
     *                            second (m/s^2).
     * @param fz                  measured specific force resolved along body frame
     *                            z-axis and expressed in meters per squared
     *                            second (m/s^2).
     * @param config              Loosely Coupled Kalman filter configuration.
     * @param result              instance where new state of Kalman filter will be
     *                            stored.
     * @throws AlgebraException if there are numerical instabilities.
     */
    public static void estimate(
            final ECEFPositionAndVelocity positionAndVelocity,
            final Time propagationInterval,
            final INSLooselyCoupledKalmanState previousState,
            final double fx, final double fy, final double fz,
            final INSLooselyCoupledKalmanConfig config,
            final INSLooselyCoupledKalmanState result) throws AlgebraException {
<span class="fc" id="L2391">        estimate(positionAndVelocity.getX(), positionAndVelocity.getY(),</span>
<span class="fc" id="L2392">                positionAndVelocity.getZ(), positionAndVelocity.getVx(),</span>
<span class="fc" id="L2393">                positionAndVelocity.getVy(), positionAndVelocity.getVz(),</span>
                propagationInterval, previousState, fx, fy, fz, config, result);
<span class="fc" id="L2395">    }</span>

    /**
     * Estimates the update of Kalman filter state for a single epoch.
     *
     * @param positionAndVelocity ECEF user position and velocity.
     * @param propagationInterval propagation interval.
     * @param previousState       previous Kalman filter state.
     * @param fx                  measured specific force resolved along body frame
     *                            x-axis and expressed in meters per squared
     *                            second (m/s^2).
     * @param fy                  measured specific force resolved along body frame
     *                            y-axis and expressed in meters per squared
     *                            second (m/s^2).
     * @param fz                  measured specific force resolved along body frame
     *                            z-axis and expressed in meters per squared
     *                            second (m/s^2).
     * @param previousLatitude    previous latitude solution expressed in radians (rad).
     * @param config              Loosely Coupled Kalman filter configuration.
     * @return new state of Kalman filter.
     * @throws AlgebraException if there are numerical instabilities.
     */
    public static INSLooselyCoupledKalmanState estimate(
            final ECEFPositionAndVelocity positionAndVelocity,
            final Time propagationInterval,
            final INSLooselyCoupledKalmanState previousState,
            final double fx, final double fy, final double fz,
            final double previousLatitude,
            final INSLooselyCoupledKalmanConfig config) throws AlgebraException {
<span class="fc" id="L2424">        return estimate(positionAndVelocity.getX(), positionAndVelocity.getY(),</span>
<span class="fc" id="L2425">                positionAndVelocity.getZ(), positionAndVelocity.getVx(),</span>
<span class="fc" id="L2426">                positionAndVelocity.getVy(), positionAndVelocity.getVz(),</span>
                propagationInterval, previousState, fx, fy, fz, previousLatitude,
                config);
    }

    /**
     * Estimates the update of Kalman filter state for a single epoch.
     *
     * @param positionAndVelocity ECEF user position and velocity.
     * @param propagationInterval propagation interval.
     * @param previousState       previous Kalman filter state.
     * @param fx                  measured specific force resolved along body frame
     *                            x-axis and expressed in meters per squared
     *                            second (m/s^2).
     * @param fy                  measured specific force resolved along body frame
     *                            y-axis and expressed in meters per squared
     *                            second (m/s^2).
     * @param fz                  measured specific force resolved along body frame
     *                            z-axis and expressed in meters per squared
     *                            second (m/s^2).
     * @param previousLatitude    previous latitude solution expressed in radians (rad).
     * @param config              Loosely Coupled Kalman filter configuration.
     * @param result              instance where new state of Kalman filter will be
     *                            stored.
     * @throws AlgebraException if there are numerical instabilities.
     */
    public static void estimate(
            final ECEFPositionAndVelocity positionAndVelocity,
            final Time propagationInterval,
            final INSLooselyCoupledKalmanState previousState,
            final double fx, final double fy, final double fz,
            final double previousLatitude,
            final INSLooselyCoupledKalmanConfig config,
            final INSLooselyCoupledKalmanState result) throws AlgebraException {
<span class="fc" id="L2460">        estimate(positionAndVelocity.getX(), positionAndVelocity.getY(),</span>
<span class="fc" id="L2461">                positionAndVelocity.getZ(), positionAndVelocity.getVx(),</span>
<span class="fc" id="L2462">                positionAndVelocity.getVy(), positionAndVelocity.getVz(),</span>
                propagationInterval, previousState, fx, fy, fz, previousLatitude,
                config, result);
<span class="fc" id="L2465">    }</span>

    /**
     * Converts time instance into a value expressed in seconds.
     *
     * @param time time instance to be converted.
     * @return time value expressed in seconds.
     */
    private static double convertTime(final Time time) {
<span class="fc" id="L2474">        return TimeConverter.convert(time.getValue().doubleValue(),</span>
<span class="fc" id="L2475">                time.getUnit(), TimeUnit.SECOND);</span>
    }
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.2.201808211720</span></div></body></html>