<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>LevelingEstimator.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">com.irurueta:irurueta-navigation</a> &gt; <a href="index.source.html" class="el_package">com.irurueta.navigation.inertial.estimators</a> &gt; <span class="el_source">LevelingEstimator.java</span></div><h1>LevelingEstimator.java</h1><pre class="source lang-java linenums">/*
 * Copyright (C) 2020 Alberto Irurueta Carro (alberto@irurueta.com)
 *
 * Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *         http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
package com.irurueta.navigation.inertial.estimators;

import com.irurueta.navigation.frames.CoordinateTransformation;
import com.irurueta.navigation.frames.FrameType;
import com.irurueta.navigation.inertial.BodyKinematics;
import com.irurueta.units.Acceleration;
import com.irurueta.units.AccelerationConverter;
import com.irurueta.units.AccelerationUnit;
import com.irurueta.units.Angle;
import com.irurueta.units.AngleConverter;
import com.irurueta.units.AngleUnit;
import com.irurueta.units.AngularSpeed;
import com.irurueta.units.AngularSpeedConverter;
import com.irurueta.units.AngularSpeedUnit;

/**
 * Leveling is the process of attitude initialization of a body.
 * When the INS is stationary, self-alignment can be used to initialize
 * the roll and pitch with all but the poorest inertial sensors.
 * However, accurate self-alignment of the heading requires
 * aviation-grade gyros or better. Heading is often initialized using
 * a magnetic compass.
 * When the INS is initialized in motion, another navigation system
 * must provide an attitude reference.
 * This class is based on Paul D. Groves. Principles of GNSS Inertial
 * and multi-sensor integrated navigation systemd. 2nd ed. p. 196.
 *
 * Because this implementation neglects effects of Earth rotation on sensed
 * specific force, and also neglects the north component of gravity in a local
 * navigation frame (which is not zero because Earth is not fully spherical),
 * the expected results should be accurate up to about 1e-3 radians
 * (about 0.05 degrees).
 */
public class LevelingEstimator {

    /**
     * Private constructor to prevent instantiation.
     */
    private LevelingEstimator() { }

    /**
     * Gets roll angle of body attitude expressed in radians.
     * This is based on expression (5.101) of Paul D. Groves.
     * Principles of GNSS Inertial and multi-sensor integrated
     * navigation systemd. 2nd ed.
     *
     * @param fy y-coordinate of measured body specific force
     *           expressed in meters per squared second (m/s^2).
     * @param fz z-coordinate of measured body specific force
     *           expressed in meters per squared second (m/s^2).
     * @return roll angle expressed in radians.
     */
    public static double getRoll(final double fy, final double fz) {
<span class="fc" id="L69">        return Math.atan2(-fy, -fz);</span>
    }

    /**
     * Gets pitch angle of body attitude expressed in radians.
     * This is based on expression (5.101) of Paul D. Groves.
     * Principles of GNSS Inertial and multi-sensor integrated
     * navigation systemd. 2nd ed.
     *
     * @param fx x-coordinate of measured body specific force
     *           expressed in meters per squared second (m/s^2).
     * @param fy y-coordinate of measured body specific force
     *           expressed in meters per squared second (m/s^2).
     * @param fz z-coordinate of measured body specific force
     *           expressed in meters per squared second (m/s^2).
     * @return pitch angle expressed in radians.
     */
    public static double getPitch(
            final double fx, final double fy, final double fz) {
<span class="fc" id="L88">        final double fy2 = fy * fy;</span>
<span class="fc" id="L89">        final double fz2 = fz * fz;</span>

<span class="fc" id="L91">        return Math.atan(fx / Math.sqrt(fy2 + fz2));</span>
    }

    /**
     * Gets yaw angle of body attitude expressed in radians.
     * This method requires previously computed roll and pitch angles
     * along with gyroscope measurements.
     * This method can only be used for high-accuracy gyroscopes,
     * otherwise, yaw angle must be measured using a magnetometer.
     *
     * @param roll         previously computed roll angle expressed in radians.
     * @param pitch        previously computed pitch angle expressed in radians.
     * @param angularRateX x-coordinate of body angular rate expressed in
     *                     radians per second (rad/s).
     * @param angularRateY y-coordinate of body angular rate expressed in
     *                     radians per second (rad/s).
     * @param angularRateZ z-coordinate of body angular rate expressed in
     *                     radians per second (rad/s).
     * @return yaw angle expressed in radians.
     */
    public static double getYaw(
            final double roll, final double pitch,
            final double angularRateX, final double angularRateY,
            final double angularRateZ) {

<span class="fc" id="L116">        final double sinRoll = Math.sin(roll);</span>
<span class="fc" id="L117">        final double cosRoll = Math.cos(roll);</span>

<span class="fc" id="L119">        final double sinPitch = Math.sin(pitch);</span>
<span class="fc" id="L120">        final double cosPitch = Math.cos(pitch);</span>

<span class="fc" id="L122">        final double sinYaw = -angularRateY * cosRoll</span>
                + angularRateZ * sinRoll;
<span class="fc" id="L124">        final double cosYaw = angularRateX * cosPitch</span>
                + (angularRateY * sinRoll + angularRateZ * cosRoll)
                * sinPitch;

<span class="fc" id="L128">        return Math.atan2(sinYaw, cosYaw);</span>
    }

    /**
     * Gets yaw angle of body attitude expressed in radians.
     * This method can only be used for high-accuracy gyroscopes,
     * otherwise, yaw angle must be measured using a magnetometer.
     *
     * @param fx           x-coordinate of measured body specific force
     *                     expressed in meters per squared second (m/s^2).
     * @param fy           y-coordinate of measured body specific force
     *                     expressed in meters per squared second (m/s^2).
     * @param fz           z-coordinate of measured body specific force
     *                     expressed in meters per squared second (m/s^2).
     * @param angularRateX x-coordinate of body angular rate expressed in
     *                     radians per second (rad/s).
     * @param angularRateY y-coordinate of body angular rate expressed in
     *                     radians per second (rad/s).
     * @param angularRateZ z-coordinate of body angular rate expressed in
     *                     radians per second (rad/s).
     * @return yaw angle expressed in radians.
     */
    public static double getYaw(
            final double fx, final double fy, final double fz,
            final double angularRateX, final double angularRateY,
            final double angularRateZ) {
<span class="fc" id="L154">        final double roll = getRoll(fy, fz);</span>
<span class="fc" id="L155">        final double pitch = getPitch(fx, fy, fz);</span>
<span class="fc" id="L156">        return getYaw(roll, pitch, angularRateX,</span>
                angularRateY, angularRateZ);
    }

    /**
     * Gets roll angle of body attitude expressed in radians.
     * This is based on expression (5.101) of Paul D. Groves.
     * Principles of GNSS Inertial and multi-sensor integrated
     * navigation systemd. 2nd ed.
     *
     * @param kinematics body kinematics containing measured
     *                   body specific force.
     * @return roll angle expressed in radians.
     */
    public static double getRoll(final BodyKinematics kinematics) {
<span class="fc" id="L171">        return getRoll(kinematics.getFy(), kinematics.getFz());</span>
    }

    /**
     * Gets pitch angle of body attitude expressed in radians.
     * This is based on expression (5.101) of Paul D. Groves.
     * Principles of GNSS Inertial and multi-sensor integrated
     * navigation systemd. 2nd ed.
     *
     * @param kinematics body kinematics containing measured
     *                   body specific force.
     * @return pitch angle expressed in radians.
     */
    public static double getPitch(final BodyKinematics kinematics) {
<span class="fc" id="L185">        return getPitch(kinematics.getFx(), kinematics.getFy(),</span>
<span class="fc" id="L186">                kinematics.getFz());</span>
    }

    /**
     * Gets yaw angle of body attitude expressed in radians.
     * This method can only be used for high-accuracy gyroscopes.
     * otherwise, yaw angle must be measured using a magnetometer.
     *
     * @param kinematics body kinematics containing measured
     *                   body specific force ang angular rates.
     * @return yaw angle expressed in radians.
     */
    public static double getYaw(final BodyKinematics kinematics) {
<span class="fc" id="L199">        return getYaw(kinematics.getFx(), kinematics.getFy(),</span>
<span class="fc" id="L200">                kinematics.getFz(), kinematics.getAngularRateX(),</span>
<span class="fc" id="L201">                kinematics.getAngularRateY(), kinematics.getAngularRateZ());</span>
    }

    /**
     * Gets body attitude expressed in the local navigation frame.
     *
     * @param fx           x-coordinate of measured body specific force
     *                     expressed in meters per squared second (m/s^2).
     * @param fy           y-coordinate of measured body specific force
     *                     expressed in meters per squared second (m/s^2).
     * @param fz           z-coordinate of measured body specific force
     *                     expressed in meters per squared second (m/s^2).
     * @param angularRateX x-coordinate of body angular rate expressed in
     *                     radians per second (rad/s).
     * @param angularRateY y-coordinate of body angular rate expressed in
     *                     radians per second (rad/s).
     * @param angularRateZ z-coordinate of body angular rate expressed in
     *                     radians per second (rad/s).
     * @param result       instance where attitude will be stored.
     */
    public static void getAttitude(
            final double fx, final double fy, final double fz,
            final double angularRateX, final double angularRateY,
            final double angularRateZ, final CoordinateTransformation result) {
<span class="fc" id="L225">        result.setSourceType(FrameType.LOCAL_NAVIGATION_FRAME);</span>
<span class="fc" id="L226">        result.setDestinationType(FrameType.BODY_FRAME);</span>

<span class="fc" id="L228">        final double roll = getRoll(fy, fz);</span>
<span class="fc" id="L229">        final double pitch = getPitch(fx, fy, fz);</span>
<span class="fc" id="L230">        final double yaw = getYaw(roll, pitch,</span>
                angularRateX, angularRateY, angularRateZ);
<span class="fc" id="L232">        result.setEulerAngles(roll, pitch, yaw);</span>
<span class="fc" id="L233">    }</span>

    /**
     * Gets body attitude expressed in the local navigation frame.
     *
     * @param kinematics body kinematics containing measured
     *                   body specific force and angular rate.
     * @param result     instance where attitude will be stored.
     */
    public static void getAttitude(
            final BodyKinematics kinematics,
            final CoordinateTransformation result) {
<span class="fc" id="L245">        getAttitude(kinematics.getFx(), kinematics.getFy(), kinematics.getFz(),</span>
<span class="fc" id="L246">                kinematics.getAngularRateX(), kinematics.getAngularRateY(),</span>
<span class="fc" id="L247">                kinematics.getAngularRateZ(), result);</span>
<span class="fc" id="L248">    }</span>

    /**
     * Gets body attitude expressed in the local navigation frame.
     *
     * @param fx           x-coordinate of measured body specific force
     *                     expressed in meters per squared second (m/s^2).
     * @param fy           y-coordinate of measured body specific force
     *                     expressed in meters per squared second (m/s^2).
     * @param fz           z-coordinate of measured body specific force
     *                     expressed in meters per squared second (m/s^2).
     * @param angularRateX x-coordinate of body angular rate expressed in
     *                     radians per second (rad/s).
     * @param angularRateY y-coordinate of body angular rate expressed in
     *                     radians per second (rad/s).
     * @param angularRateZ z-coordinate of body angular rate expressed in
     *                     radians per second (rad/s).
     * @return a coordinate transformation containing body attitude.
     */
    public static CoordinateTransformation getAttitude(
            final double fx, final double fy, final double fz,
            final double angularRateX, final double angularRateY,
            final double angularRateZ) {

<span class="fc" id="L272">        final double roll = getRoll(fy, fz);</span>
<span class="fc" id="L273">        final double pitch = getPitch(fx, fy, fz);</span>
<span class="fc" id="L274">        final double yaw = getYaw(roll, pitch,</span>
                angularRateX, angularRateY, angularRateZ);

<span class="fc" id="L277">        return new CoordinateTransformation(roll, pitch, yaw,</span>
                FrameType.LOCAL_NAVIGATION_FRAME, FrameType.BODY_FRAME);
    }

    /**
     * Gets body attitude expressed in the local navigation frame.
     *
     * @param kinematics body kinematics containing measured body
     *                   specific force and angular rate.
     * @return a coordinate transformation containing body attitude.
     */
    public static CoordinateTransformation getAttitude(
            final BodyKinematics kinematics) {
<span class="fc" id="L290">        return getAttitude(kinematics.getFx(), kinematics.getFy(),</span>
<span class="fc" id="L291">                kinematics.getFz(), kinematics.getAngularRateX(),</span>
<span class="fc" id="L292">                kinematics.getAngularRateY(), kinematics.getAngularRateZ());</span>
    }

    /**
     * Gets roll angle of body attitude expressed in radians.
     * This is based on expression (5.101) of Paul D. Groves.
     * Principles of GNSS Inertial and multi-sensor integrated
     * navigation systemd. 2nd ed.
     *
     * @param fy y-coordinate of measured body specific force.
     * @param fz z-coordinate of measured body specific force.
     * @return roll angle expressed in radians.
     */
    public static double getRoll(
            final Acceleration fy, final Acceleration fz) {
<span class="fc" id="L307">        return getRoll(convertAcceleration(fy), convertAcceleration(fz));</span>
    }

    /**
     * Gets pitch angle of body attitude expressed in radians.
     * This is based on expression (5.101) of Paul D. Groves.
     * Principles of GNSS Inertial and multi-sensor integrated
     * navigation systemd. 2nd ed.
     *
     * @param fx x-coordinate of measured body specific force.
     * @param fy y-coordinate of measured body specific force.
     * @param fz z-coordinate of measured body specific force.
     * @return pitch angle expressed in radians.
     */
    public static double getPitch(
            final Acceleration fx, final Acceleration fy,
            final Acceleration fz) {
<span class="fc" id="L324">        return getPitch(convertAcceleration(fx), convertAcceleration(fy),</span>
<span class="fc" id="L325">                convertAcceleration(fz));</span>
    }

    /**
     * Gets yaw angle of body attitude expressed in radians.
     * This method requires previously computed roll and pitch angles
     * along with gyroscope measurements.
     * This method can only be used for high-accuracy gyroscopes,
     * otherwise, yaw angle must be measured using a magnetometer.
     *
     * @param roll         previously computed roll angle.
     * @param pitch        previously computed pitch angle.
     * @param angularRateX x-coordinate of body angular rate.
     * @param angularRateY y-coordinate of body angular rate.
     * @param angularRateZ z-coordinate of body angular rate.
     * @return yaw angle expressed in radians.
     */
    public static double getYaw(
            final Angle roll, final Angle pitch, final AngularSpeed angularRateX,
            final AngularSpeed angularRateY, final AngularSpeed angularRateZ) {
<span class="fc" id="L345">        return getYaw(convertAngle(roll), convertAngle(pitch),</span>
<span class="fc" id="L346">                convertAngularSpeed(angularRateX),</span>
<span class="fc" id="L347">                convertAngularSpeed(angularRateY),</span>
<span class="fc" id="L348">                convertAngularSpeed(angularRateZ));</span>
    }

    /**
     * Gets yaw angle of body attitude expressed in radians.
     * This method can only be used for high-accuracy gyroscopes,
     * otherwise, yaw angle must be measured using a magnetometer.
     *
     * @param fx           x-coordinate of measured body specific force.
     * @param fy           y-coordinate of measured body specific force.
     * @param fz           z-coordinate of measured body specific force.
     * @param angularRateX x-coordinate of body angular rate.
     * @param angularRateY y-coordinate of body angular rate.
     * @param angularRateZ z-coordinate of body angular rate.
     * @return yaw angle expressed in radians.
     */
    public static double getYaw(
            final Acceleration fx, final Acceleration fy, final Acceleration fz,
            final AngularSpeed angularRateX, final AngularSpeed angularRateY,
            final AngularSpeed angularRateZ) {
<span class="fc" id="L368">        return getYaw(convertAcceleration(fx), convertAcceleration(fy),</span>
<span class="fc" id="L369">                convertAcceleration(fz), convertAngularSpeed(angularRateX),</span>
<span class="fc" id="L370">                convertAngularSpeed(angularRateY),</span>
<span class="fc" id="L371">                convertAngularSpeed(angularRateZ));</span>
    }

    /**
     * Gets body attitude expressed in the local navigation frame.
     *
     * @param fx           x-coordinate of measured body specific force.
     * @param fy           y-coordinate of measured body specific force.
     * @param fz           z-coordinate of measured body specific force.
     * @param angularRateX x-coordinate of body angular rate.
     * @param angularRateY y-coordinate of body angular rate.
     * @param angularRateZ z-coordinate of body angular rate.
     * @param result       instance where attitude will be stored.
     */
    public static void getAttitude(
            final Acceleration fx, final Acceleration fy, final Acceleration fz,
            final AngularSpeed angularRateX, final AngularSpeed angularRateY,
            final AngularSpeed angularRateZ,
            final CoordinateTransformation result) {
<span class="fc" id="L390">        getAttitude(convertAcceleration(fx), convertAcceleration(fy),</span>
<span class="fc" id="L391">                convertAcceleration(fz), convertAngularSpeed(angularRateX),</span>
<span class="fc" id="L392">                convertAngularSpeed(angularRateY),</span>
<span class="fc" id="L393">                convertAngularSpeed(angularRateZ), result);</span>
<span class="fc" id="L394">    }</span>

    /**
     * Gets body attitude expressed in the local navigation frame.
     *
     * @param fx           x-coordinate of measured body specific force.
     * @param fy           y-coordinate of measured body specific force.
     * @param fz           z-coordinate of measured body specific force.
     * @param angularRateX x-coordinate of body angular rate.
     * @param angularRateY y-coordinate of body angular rate.
     * @param angularRateZ z-coordinate of body angular rate.
     * @return a coordinate transformation containing body attitude.
     */
    public static CoordinateTransformation getAttitude(
            final Acceleration fx, final Acceleration fy, final Acceleration fz,
            final AngularSpeed angularRateX, final AngularSpeed angularRateY,
            final AngularSpeed angularRateZ) {
<span class="fc" id="L411">        return getAttitude(convertAcceleration(fx), convertAcceleration(fy),</span>
<span class="fc" id="L412">                convertAcceleration(fz), convertAngularSpeed(angularRateX),</span>
<span class="fc" id="L413">                convertAngularSpeed(angularRateY),</span>
<span class="fc" id="L414">                convertAngularSpeed(angularRateZ));</span>
    }

    /**
     * Gets roll angle of body attitude expressed in radians.
     * This is based on expression (5.101) of Paul D. Groves.
     * Principles of GNSS Inertial and multi-sensor integrated
     * navigation systemd. 2nd ed.
     *
     * @param fy y-coordinate of measured body specific force
     *           expressed in meters per squared second (m/s^2).
     * @param fz z-coordinate of measured body specific force
     *           expressed in meters per squared second (m/s^2).
     * @param result instance where roll angle will be stored.
     */
    public static void getRollAsAngle(
            final double fy, final double fz, final Angle result) {
<span class="fc" id="L431">        result.setUnit(AngleUnit.RADIANS);</span>
<span class="fc" id="L432">        result.setValue(getRoll(fy, fz));</span>
<span class="fc" id="L433">    }</span>

    /**
     * Gets roll angle of body attitude expressed in radians.
     * This is based on expression (5.101) of Paul D. Groves.
     * Principles of GNSS Inertial and multi-sensor integrated
     * navigation systemd. 2nd ed.
     *
     * @param fy y-coordinate of measured body specific force
     *           expressed in meters per squared second (m/s^2).
     * @param fz z-coordinate of measured body specific force
     *           expressed in meters per squared second (m/s^2).
     * @return roll angle.
     */
    public static Angle getRollAsAngle(final double fy, final double fz) {
<span class="fc" id="L448">        return new Angle(getRoll(fy, fz), AngleUnit.RADIANS);</span>
    }

    /**
     * Gets pitch angle of body attitude expressed in radians.
     * This is based on expression (5.101) of Paul D. Groves.
     * Principles of GNSS Inertial and multi-sensor integrated
     * navigation systemd. 2nd ed.
     *
     * @param fx x-coordinate of measured body specific force
     *           expressed in meters per squared second (m/s^2).
     * @param fy y-coordinate of measured body specific force
     *           expressed in meters per squared second (m/s^2).
     * @param fz z-coordinate of measured body specific force
     *           expressed in meters per squared second (m/s^2).
     * @param result instance where pitch angle will be stored.
     */
    public static void getPitchAsAngle(
            final double fx, final double fy, final double fz,
            final Angle result) {
<span class="fc" id="L468">        result.setUnit(AngleUnit.RADIANS);</span>
<span class="fc" id="L469">        result.setValue(getPitch(fx, fy, fz));</span>
<span class="fc" id="L470">    }</span>

    /**
     * Gets pitch angle of body attitude expressed in radians.
     * This is based on expression (5.101) of Paul D. Groves.
     * Principles of GNSS Inertial and multi-sensor integrated
     * navigation systemd. 2nd ed.
     *
     * @param fx x-coordinate of measured body specific force
     *           expressed in meters per squared second (m/s^2).
     * @param fy y-coordinate of measured body specific force
     *           expressed in meters per squared second (m/s^2).
     * @param fz z-coordinate of measured body specific force
     *           expressed in meters per squared second (m/s^2).
     * @return pitch angle.
     */
    public static Angle getPitchAsAngle(
            final double fx, final double fy, final double fz) {
<span class="fc" id="L488">        return new Angle(getPitch(fx, fy, fz), AngleUnit.RADIANS);</span>
    }

    /**
     * Gets yaw angle of body attitude expressed in radians.
     * This method requires previously computed roll and pitch angles
     * along with gyroscope measurements.
     * This method can only be used for high-accuracy gyroscopes,
     * otherwise, yaw angle must be measured using a magnetometer.
     *
     * @param roll         previously computed roll angle expressed in radians.
     * @param pitch        previously computed pitch angle expressed in radians.
     * @param angularRateX x-coordinate of body angular rate expressed in
     *                     radians per second (rad/s).
     * @param angularRateY y-coordinate of body angular rate expressed in
     *                     radians per second (rad/s).
     * @param angularRateZ z-coordinate of body angular rate expressed in
     *                     radians per second (rad/s).
     * @param result instance where yaw angle will be stored.
     */
    public static void getYawAsAngle(
            final double roll, final double pitch, final double angularRateX,
            final double angularRateY, final double angularRateZ,
            final Angle result) {
<span class="fc" id="L512">        result.setUnit(AngleUnit.RADIANS);</span>
<span class="fc" id="L513">        result.setValue(getYaw(roll, pitch, angularRateX, angularRateY,</span>
                angularRateZ));
<span class="fc" id="L515">    }</span>

    /**
     * Gets yaw angle of body attitude expressed in radians.
     * This method requires previously computed roll and pitch angles
     * along with gyroscope measurements.
     * This method can only be used for high-accuracy gyroscopes,
     * otherwise, yaw angle must be measured using a magnetometer.
     *
     * @param roll         previously computed roll angle expressed in radians.
     * @param pitch        previously computed pitch angle expressed in radians.
     * @param angularRateX x-coordinate of body angular rate expressed in
     *                     radians per second (rad/s).
     * @param angularRateY y-coordinate of body angular rate expressed in
     *                     radians per second (rad/s).
     * @param angularRateZ z-coordinate of body angular rate expressed in
     *                     radians per second (rad/s).
     * @return yaw angle.
     */
    public static Angle getYawAsAngle(
            final double roll, final double pitch, final double angularRateX,
            final double angularRateY, final double angularRateZ) {
<span class="fc" id="L537">        return new Angle(getYaw(roll, pitch, angularRateX, angularRateY,</span>
                angularRateZ), AngleUnit.RADIANS);
    }

    /**
     * Gets yaw angle of body attitude expressed in radians.
     * This method can only be used for high-accuracy gyroscopes,
     * otherwise, yaw angle must be measured using a magnetometer.
     *
     * @param fx           x-coordinate of measured body specific force
     *                     expressed in meters per squared second (m/s^2).
     * @param fy           y-coordinate of measured body specific force
     *                     expressed in meters per squared second (m/s^2).
     * @param fz           z-coordinate of measured body specific force
     *                     expressed in meters per squared second (m/s^2).
     * @param angularRateX x-coordinate of body angular rate expressed in
     *                     radians per second (rad/s).
     * @param angularRateY y-coordinate of body angular rate expressed in
     *                     radians per second (rad/s).
     * @param angularRateZ z-coordinate of body angular rate expressed in
     *                     radians per second (rad/s).
     * @param result instance where yaw angle will be stored.
     */
    public static void getYawAsAngle(
            final double fx, final double fy, final double fz,
            final double angularRateX, final double angularRateY,
            final double angularRateZ, final Angle result) {
<span class="fc" id="L564">        result.setUnit(AngleUnit.RADIANS);</span>
<span class="fc" id="L565">        result.setValue(getYaw(fx, fy, fz, angularRateX, angularRateY,</span>
                angularRateZ));
<span class="fc" id="L567">    }</span>

    /**
     * Gets yaw angle of body attitude expressed in radians.
     * This method can only be used for high-accuracy gyroscopes,
     * otherwise, yaw angle must be measured using a magnetometer.
     *
     * @param fx           x-coordinate of measured body specific force
     *                     expressed in meters per squared second (m/s^2).
     * @param fy           y-coordinate of measured body specific force
     *                     expressed in meters per squared second (m/s^2).
     * @param fz           z-coordinate of measured body specific force
     *                     expressed in meters per squared second (m/s^2).
     * @param angularRateX x-coordinate of body angular rate expressed in
     *                     radians per second (rad/s).
     * @param angularRateY y-coordinate of body angular rate expressed in
     *                     radians per second (rad/s).
     * @param angularRateZ z-coordinate of body angular rate expressed in
     *                     radians per second (rad/s).
     * @return yaw angle.
     */
    public static Angle getYawAsAngle(
            final double fx, final double fy, final double fz,
            final double angularRateX, final double angularRateY,
            final double angularRateZ) {
<span class="fc" id="L592">        return new Angle(getYaw(fx, fy, fz, angularRateX, angularRateY,</span>
                angularRateZ), AngleUnit.RADIANS);
    }

    /**
     * Gets roll angle of body attitude expressed in radians.
     * This is based on expression (5.101) of Paul D. Groves.
     * Principles of GNSS Inertial and multi-sensor integrated
     * navigation systemd. 2nd ed.
     *
     * @param kinematics body kinematics containing measured
     *                   body specific force.
     * @param result instance where roll angle will be stored.
     */
    public static void getRollAsAngle(
            final BodyKinematics kinematics, final Angle result) {
<span class="fc" id="L608">        result.setUnit(AngleUnit.RADIANS);</span>
<span class="fc" id="L609">        result.setValue(getRoll(kinematics));</span>
<span class="fc" id="L610">    }</span>

    /**
     * Gets roll angle of body attitude expressed in radians.
     * This is based on expression (5.101) of Paul D. Groves.
     * Principles of GNSS Inertial and multi-sensor integrated
     * navigation systemd. 2nd ed.
     *
     * @param kinematics body kinematics containing measured
     *                   body specific force.
     * @return roll angle.
     */
    public static Angle getRollAsAngle(final BodyKinematics kinematics) {
<span class="fc" id="L623">        return new Angle(getRoll(kinematics), AngleUnit.RADIANS);</span>
    }

    /**
     * Gets pitch angle of body attitude expressed in radians.
     * This is based on expression (5.101) of Paul D. Groves.
     * Principles of GNSS Inertial and multi-sensor integrated
     * navigation systemd. 2nd ed.
     *
     * @param kinematics body kinematics containing measured
     *                   body specific force.
     * @param result instance where pitch angle will be stored.
     */
    public static void getPitchAsAngle(
            final BodyKinematics kinematics, final Angle result) {
<span class="fc" id="L638">        result.setUnit(AngleUnit.RADIANS);</span>
<span class="fc" id="L639">        result.setValue(getPitch(kinematics));</span>
<span class="fc" id="L640">    }</span>

    /**
     * Gets pitch angle of body attitude expressed in radians.
     * This is based on expression (5.101) of Paul D. Groves.
     * Principles of GNSS Inertial and multi-sensor integrated
     * navigation systemd. 2nd ed.
     *
     * @param kinematics body kinematics containing measured
     *                   body specific force.
     * @return pitch angle.
     */
    public static Angle getPitchAsAngle(final BodyKinematics kinematics) {
<span class="fc" id="L653">        return new Angle(getPitch(kinematics), AngleUnit.RADIANS);</span>
    }

    /**
     * Gets yaw angle of body attitude expressed in radians.
     * This method can only be used for high-accuracy gyroscopes.
     * otherwise, yaw angle must be measured using a magnetometer.
     *
     * @param kinematics body kinematics containing measured
     *                   body specific force ang angular rates.
     * @param result instance where yaw angle will be stored.
     */
    public static void getYawAsAngle(
            final BodyKinematics kinematics, final Angle result) {
<span class="fc" id="L667">        result.setUnit(AngleUnit.RADIANS);</span>
<span class="fc" id="L668">        result.setValue(getYaw(kinematics));</span>
<span class="fc" id="L669">    }</span>

    /**
     * Gets yaw angle of body attitude expressed in radians.
     * This method can only be used for high-accuracy gyroscopes.
     * otherwise, yaw angle must be measured using a magnetometer.
     *
     * @param kinematics body kinematics containing measured
     *                   body specific force ang angular rates.
     * @return yaw angle.
     */
    public static Angle getYawAsAngle(final BodyKinematics kinematics) {
<span class="fc" id="L681">        return new Angle(getYaw(kinematics), AngleUnit.RADIANS);</span>
    }

    /**
     * Gets roll angle of body attitude expressed in radians.
     * This is based on expression (5.101) of Paul D. Groves.
     * Principles of GNSS Inertial and multi-sensor integrated
     * navigation systemd. 2nd ed.
     *
     * @param fy y-coordinate of measured body specific force.
     * @param fz z-coordinate of measured body specific force.
     * @param result instance where roll angle will be stored.
     */
    public static void getRollAsAngle(
            final Acceleration fy, final Acceleration fz, final Angle result) {
<span class="fc" id="L696">        result.setUnit(AngleUnit.RADIANS);</span>
<span class="fc" id="L697">        result.setValue(getRoll(fy, fz));</span>
<span class="fc" id="L698">    }</span>

    /**
     * Gets roll angle of body attitude expressed in radians.
     * This is based on expression (5.101) of Paul D. Groves.
     * Principles of GNSS Inertial and multi-sensor integrated
     * navigation systemd. 2nd ed.
     *
     * @param fy y-coordinate of measured body specific force.
     * @param fz z-coordinate of measured body specific force.
     * @return roll angle.
     */
    public static Angle getRollAsAngle(
            final Acceleration fy, final Acceleration fz) {
<span class="fc" id="L712">        return new Angle(getRoll(fy, fz), AngleUnit.RADIANS);</span>
    }

    /**
     * Gets pitch angle of body attitude expressed in radians.
     * This is based on expression (5.101) of Paul D. Groves.
     * Principles of GNSS Inertial and multi-sensor integrated
     * navigation systemd. 2nd ed.
     *
     * @param fx x-coordinate of measured body specific force.
     * @param fy y-coordinate of measured body specific force.
     * @param fz z-coordinate of measured body specific force.
     * @param result instance where pitch angle will be stored.
     */
    public static void getPitchAsAngle(
            final Acceleration fx, final Acceleration fy, final Acceleration fz,
            final Angle result) {
<span class="fc" id="L729">        result.setUnit(AngleUnit.RADIANS);</span>
<span class="fc" id="L730">        result.setValue(getPitch(fx, fy, fz));</span>
<span class="fc" id="L731">    }</span>

    /**
     * Gets pitch angle of body attitude expressed in radians.
     * This is based on expression (5.101) of Paul D. Groves.
     * Principles of GNSS Inertial and multi-sensor integrated
     * navigation systemd. 2nd ed.
     *
     * @param fx x-coordinate of measured body specific force.
     * @param fy y-coordinate of measured body specific force.
     * @param fz z-coordinate of measured body specific force.
     * @return pitch angle.
     */
    public static Angle getPitchAsAngle(
            final Acceleration fx, final Acceleration fy, final Acceleration fz) {
<span class="fc" id="L746">        return new Angle(getPitch(fx, fy, fz), AngleUnit.RADIANS);</span>
    }

    /**
     * Gets yaw angle of body attitude expressed in radians.
     * This method requires previously computed roll and pitch angles
     * along with gyroscope measurements.
     * This method can only be used for high-accuracy gyroscopes,
     * otherwise, yaw angle must be measured using a magnetometer.
     *
     * @param roll         previously computed roll angle.
     * @param pitch        previously computed pitch angle.
     * @param angularRateX x-coordinate of body angular rate.
     * @param angularRateY y-coordinate of body angular rate.
     * @param angularRateZ z-coordinate of body angular rate.
     * @param result instance where yaw angle will be stored.
     */
    public static void getYawAsAngle(
            final Angle roll, final Angle pitch, final AngularSpeed angularRateX,
            final AngularSpeed angularRateY, final AngularSpeed angularRateZ,
            final Angle result) {
<span class="fc" id="L767">        result.setUnit(AngleUnit.RADIANS);</span>
<span class="fc" id="L768">        result.setValue(getYaw(roll, pitch, angularRateX, angularRateY,</span>
                angularRateZ));
<span class="fc" id="L770">    }</span>

    /**
     * Gets yaw angle of body attitude expressed in radians.
     * This method requires previously computed roll and pitch angles
     * along with gyroscope measurements.
     * This method can only be used for high-accuracy gyroscopes,
     * otherwise, yaw angle must be measured using a magnetometer.
     *
     * @param roll         previously computed roll angle.
     * @param pitch        previously computed pitch angle.
     * @param angularRateX x-coordinate of body angular rate.
     * @param angularRateY y-coordinate of body angular rate.
     * @param angularRateZ z-coordinate of body angular rate.
     * @return yaw angle.
     */
    public static Angle getYawAsAngle(
            final Angle roll, final Angle pitch, final AngularSpeed angularRateX,
            final AngularSpeed angularRateY, final AngularSpeed angularRateZ) {
<span class="fc" id="L789">        return new Angle(getYaw(roll, pitch, angularRateX, angularRateY,</span>
                angularRateZ), AngleUnit.RADIANS);
    }

    /**
     * Gets yaw angle of body attitude expressed in radians.
     * This method can only be used for high-accuracy gyroscopes,
     * otherwise, yaw angle must be measured using a magnetometer.
     *
     * @param fx           x-coordinate of measured body specific force.
     * @param fy           y-coordinate of measured body specific force.
     * @param fz           z-coordinate of measured body specific force.
     * @param angularRateX x-coordinate of body angular rate.
     * @param angularRateY y-coordinate of body angular rate.
     * @param angularRateZ z-coordinate of body angular rate.
     * @param result instance where yaw angle will be stored.
     */
    public static void getYawAsAngle(
            final Acceleration fx, final Acceleration fy, final Acceleration fz,
            final AngularSpeed angularRateX, final AngularSpeed angularRateY,
            final AngularSpeed angularRateZ, final Angle result) {
<span class="fc" id="L810">        result.setUnit(AngleUnit.RADIANS);</span>
<span class="fc" id="L811">        result.setValue(getYaw(fx, fy, fz, angularRateX, angularRateY,</span>
                angularRateZ));
<span class="fc" id="L813">    }</span>

    /**
     * Gets yaw angle of body attitude expressed in radians.
     * This method can only be used for high-accuracy gyroscopes,
     * otherwise, yaw angle must be measured using a magnetometer.
     *
     * @param fx           x-coordinate of measured body specific force.
     * @param fy           y-coordinate of measured body specific force.
     * @param fz           z-coordinate of measured body specific force.
     * @param angularRateX x-coordinate of body angular rate.
     * @param angularRateY y-coordinate of body angular rate.
     * @param angularRateZ z-coordinate of body angular rate.
     * @return yaw angle.
     */
    public static Angle getYawAsAngle(
            final Acceleration fx, final Acceleration fy, final Acceleration fz,
            final AngularSpeed angularRateX, final AngularSpeed angularRateY,
            final AngularSpeed angularRateZ) {
<span class="fc" id="L832">        return new Angle(getYaw(fx, fy, fz, angularRateX, angularRateY,</span>
                angularRateZ), AngleUnit.RADIANS);
    }

    /**
     * Converts an instance of acceleration to meters per squared second (m/s^2).
     *
     * @param acceleration acceleration instance to be converted.
     * @return converted acceleration value.
     */
    private static double convertAcceleration(final Acceleration acceleration) {
<span class="fc" id="L843">        return AccelerationConverter.convert(</span>
<span class="fc" id="L844">                acceleration.getValue().doubleValue(),</span>
<span class="fc" id="L845">                acceleration.getUnit(),</span>
                AccelerationUnit.METERS_PER_SQUARED_SECOND);
    }

    /**
     * Converts an instance of angular speed to radians per second (rad/s).
     *
     * @param angularSpeed angular speed instance to be converted.
     * @return converted angular speed value.
     */
    private static double convertAngularSpeed(final AngularSpeed angularSpeed) {
<span class="fc" id="L856">        return AngularSpeedConverter.convert(</span>
<span class="fc" id="L857">                angularSpeed.getValue().doubleValue(),</span>
<span class="fc" id="L858">                angularSpeed.getUnit(),</span>
                AngularSpeedUnit.RADIANS_PER_SECOND);
    }

    /**
     * Converts an instance of an angle to radians (rad).
     *
     * @param angle angle to be converted.
     * @return converted angle value.
     */
    private static double convertAngle(final Angle angle) {
<span class="fc" id="L869">        return AngleConverter.convert(angle.getValue().doubleValue(),</span>
<span class="fc" id="L870">                angle.getUnit(), AngleUnit.RADIANS);</span>
    }
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.2.201808211720</span></div></body></html>