<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>NEDKinematicsEstimator.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">com.irurueta:irurueta-navigation</a> &gt; <a href="index.source.html" class="el_package">com.irurueta.navigation.inertial.estimators</a> &gt; <span class="el_source">NEDKinematicsEstimator.java</span></div><h1>NEDKinematicsEstimator.java</h1><pre class="source lang-java linenums">/*
 * Copyright (C) 2019 Alberto Irurueta Carro (alberto@irurueta.com)
 *
 * Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *         http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
package com.irurueta.navigation.inertial.estimators;

import com.irurueta.algebra.AlgebraException;
import com.irurueta.algebra.Matrix;
import com.irurueta.algebra.Utils;
import com.irurueta.navigation.frames.CoordinateTransformation;
import com.irurueta.navigation.frames.NEDFrame;
import com.irurueta.navigation.geodesic.Constants;
import com.irurueta.navigation.inertial.ECEFKinematics;
import com.irurueta.navigation.inertial.NEDGravity;
import com.irurueta.navigation.inertial.RadiiOfCurvature;
import com.irurueta.units.*;

/**
 * Estimates body kinematics (specific force applied to a body and its angular rate) with respect and resolved
 * along north, east, and down.
 * This implementation is based on the equations defined in &quot;Principles of GNSS, Inertial, and Multisensor
 * Integrated Navigation Systems, Second Edition&quot; and on the companion software available at:
 * https://github.com/ymjdz/MATLAB-Codes
 */
@SuppressWarnings(&quot;WeakerAccess&quot;)
<span class="fc" id="L37">public class NEDKinematicsEstimator {</span>

    /**
     * Earth rotation rate expressed in radians per second (rad/s).
     */
    public static final double EARTH_ROTATION_RATE = Constants.EARTH_ROTATION_RATE;

    /**
     * Scaling threshold.
     */
    private static final double SCALING_THRESHOLD = 2e-5;

    /**
     * Alpha threshold.
     */
    private static final double ALPHA_THRESHOLD = 1e-8;

    /**
     * Number of rows.
     */
    private static final int ROWS = 3;

    /**
     * Estimates body kinematics (specific force applied to a body and its angular rates)
     * with respect ECEF frame and resolved along body-frame axes, averaged over time interval.
     *
     * @param timeInterval time interval between epochs expressed in seconds (s).
     * @param c            body-to-NED coordinate transformation.
     * @param oldC         previous body-to-NED coordinate transformation.
     * @param vn           north coordinate of velocity of body frame with respect ECEF frame, resolved along
     *                     north, east, and down and expressed in meters per second (m/s).
     * @param ve           east coordinate of velocity of body frame with respect ECEF frame, resolved along
     *                     north, east, and down and expressed in meters per second (m/s).
     * @param vd           down coordinate of velocity of body frame with respect ECEF frame, resolved along
     *                     north, east, and down and expressed in meters per second (m/s).
     * @param oldVn        north coordinate of previous velocity of body frame with respect ECEF frame, resolved
     *                     along north, east, and down and expressed in meters per second (m/s).
     * @param oldVe        east coordinate of previous velocity of body frame with respect ECEF frame, resolved
     *                     along north, east, and down and expressed in meters per second (m/s).
     * @param oldVd        down coordinate of previous velocity of body frame with respect ECEF frame, resolved
     *                     along north, east, and down and expressed in meters per second (m/s).
     * @param latitude     current latitude expressed in radians (rad).
     * @param height       current height expressed in meters (m).
     * @param oldLatitude  previous latitude expressed in radians (rad).
     * @param oldHeight    previous height expressed in meters (m).
     * @param result       instance where estimated body kinematics will be stored.
     * @throws IllegalArgumentException if provided time interval is negative or coordinate transformation
     *                                  matrices are not NED frame valid.
     */
    public void estimate(final double timeInterval,
                         final CoordinateTransformation c,
                         final CoordinateTransformation oldC,
                         final double vn, final double ve, final double vd,
                         final double oldVn, final double oldVe, final double oldVd,
                         final double latitude, final double height,
                         final double oldLatitude, final double oldHeight,
                         final ECEFKinematics result) {
<span class="fc" id="L94">        estimateKinematics(timeInterval, c, oldC, vn, ve, vd, oldVn, oldVe, oldVd,</span>
                latitude, height, oldLatitude, oldHeight, result);
<span class="fc" id="L96">    }</span>

    /**
     * Estimates body kinematics (specific force applied to a body and its angular rates)
     * with respect ECEF frame and resolved along body-frame axes, averaged over time interval.
     *
     * @param timeInterval time interval between epochs.
     * @param c            body-to-NED coordinate transformation.
     * @param oldC         previous body-to-NED coordinate transformation.
     * @param vn           north coordinate of velocity of body frame with respect ECEF frame, resolved along
     *                     north, east, and down and expressed in meters per second (m/s).
     * @param ve           east coordinate of velocity of body frame with respect ECEF frame, resolved along
     *                     north, east, and down and expressed in meters per second (m/s).
     * @param vd           down coordinate of velocity of body frame with respect ECEF frame, resolved along
     *                     north, east, and down and expressed in meters per second (m/s).
     * @param oldVn        north coordinate of previous velocity of body frame with respect ECEF frame, resolved
     *                     along north, east, and down and expressed in meters per second (m/s).
     * @param oldVe        east coordinate of previous velocity of body frame with respect ECEF frame, resolved
     *                     along north, east, and down and expressed in meters per second (m/s).
     * @param oldVd        down coordinate of previous velocity of body frame with respect ECEF frame, resolved
     *                     along north, east, and down and expressed in meters per second (m/s).
     * @param latitude     current latitude expressed in radians (rad).
     * @param height       current height expressed in meters (m).
     * @param oldLatitude  previous latitude expressed in radians (rad).
     * @param oldHeight    previous height expressed in meters (m).
     * @param result       instance where estimated body kinematics will be stored.
     * @throws IllegalArgumentException if provided time interval is negative or coordinate
     */
    public void estimate(final Time timeInterval,
                         final CoordinateTransformation c,
                         final CoordinateTransformation oldC,
                         final double vn, final double ve, final double vd,
                         final double oldVn, final double oldVe, final double oldVd,
                         final double latitude, final double height,
                         final double oldLatitude, final double oldHeight,
                         final ECEFKinematics result) {
<span class="fc" id="L132">        estimateKinematics(timeInterval, c, oldC, vn, ve, vd, oldVn, oldVe, oldVd,</span>
                latitude, height, oldLatitude, oldHeight, result);
<span class="fc" id="L134">    }</span>

    /**
     * Estimates body kinematics (specific force applied to a body and its angular rates)
     * with respect ECEF frame and resolved along body-frame axes, averaged over time interval.
     *
     * @param timeInterval time interval between epochs expressed in seconds (s).
     * @param frame        NED frame containing current position, velocity and body-to-NED coordinate transformation.
     * @param oldC         previous body-to-NED coordinate transformation.
     * @param oldVn        north coordinate of previous velocity of body frame with respect ECEF frame, resolved
     *                     along north, east, and down and expressed in meters per second (m/s).
     * @param oldVe        east coordinate of previous velocity of body frame with respect ECEF frame, resolved
     *                     along north, east, and down and expressed in meters per second (m/s).
     * @param oldVd        down coordinate of previous velocity of body frame with respect ECEF frame, resolved
     *                     along north, east, and down and expressed in meters per second (m/s).
     * @param oldLatitude  previous latitude expressed in radians (rad).
     * @param oldHeight    previous height expressed in meters (m).
     * @param result       instance where estimated body kinematics will be stored.
     * @throws IllegalArgumentException if provided time interval is negative or coordinate transformation
     *                                  matrices are not NED frame valid.
     */
    public void estimate(final double timeInterval,
                         final NEDFrame frame,
                         final CoordinateTransformation oldC,
                         final double oldVn, final double oldVe, final double oldVd,
                         final double oldLatitude, final double oldHeight,
                         final ECEFKinematics result) {
<span class="fc" id="L161">        estimateKinematics(timeInterval, frame, oldC, oldVn, oldVe, oldVd,</span>
                oldLatitude, oldHeight, result);
<span class="fc" id="L163">    }</span>

    /**
     * Estimates body kinematics (specific force applied to a body and its angular rates)
     * with respect ECEF frame and resolved along body-frame axes, averaged over time interval.
     *
     * @param timeInterval time interval between epochs.
     * @param frame        NED frame containing current position, velocity and body-to-NED coordinate transformation.
     * @param oldC         previous body-to-NED coordinate transformation.
     * @param oldVn        north coordinate of previous velocity of body frame with respect ECEF frame, resolved
     *                     along north, east, and down and expressed in meters per second (m/s).
     * @param oldVe        east coordinate of previous velocity of body frame with respect ECEF frame, resolved
     *                     along north, east, and down and expressed in meters per second (m/s).
     * @param oldVd        down coordinate of previous velocity of body frame with respect ECEF frame, resolved
     *                     along north, east, and down and expressed in meters per second (m/s).
     * @param oldLatitude  previous latitude expressed in radians (rad).
     * @param oldHeight    previous height expressed in meters (m).
     * @param result       instance where estimated body kinematics will be stored.
     * @throws IllegalArgumentException if provided time interval is negative or coordinate transformation
     *                                  matrices are not NED frame valid.
     */
    public void estimate(final Time timeInterval,
                         final NEDFrame frame,
                         final CoordinateTransformation oldC,
                         final double oldVn, final double oldVe, final double oldVd,
                         final double oldLatitude, final double oldHeight,
                         final ECEFKinematics result) {
<span class="fc" id="L190">        estimateKinematics(timeInterval, frame, oldC, oldVn, oldVe, oldVd,</span>
                oldLatitude, oldHeight, result);
<span class="fc" id="L192">    }</span>

    /**
     * Estimates body kinematics (specific force applied to a body and its angular rates)
     * with respect ECEF frame and resolved along body-frame axes, averaged over time interval.
     *
     * @param timeInterval time interval between epochs expressed in seconds (s).
     * @param c            body-to-NED coordinate transformation.
     * @param vn           north coordinate of velocity of body frame with respect ECEF frame, resolved along
     *                     north, east, and down and expressed in meters per second (m/s).
     * @param ve           east coordinate of velocity of body frame with respect ECEF frame, resolved along
     *                     north, east, and down and expressed in meters per second (m/s).
     * @param vd           down coordinate of velocity of body frame with respect ECEF frame, resolved along
     *                     north, east, and down and expressed in meters per second (m/s).
     * @param latitude     current latitude expressed in radians (rad).
     * @param height       current height expressed in meters (m).
     * @param oldFrame     NED frame containing previous position, velocity and body-to-NED coordinate transformation.
     * @param result       instance where estimated body kinematics will be stored.
     * @throws IllegalArgumentException if provided time interval is negative or coordinate transformation
     *                                  matrices are not NED frame valid.
     */
    public void estimate(final double timeInterval,
                         final CoordinateTransformation c,
                         final double vn, final double ve, final double vd,
                         final double latitude, final double height,
                         final NEDFrame oldFrame, final ECEFKinematics result) {
<span class="fc" id="L218">        estimateKinematics(timeInterval, c, vn, ve, vd, latitude, height, oldFrame,</span>
                result);
<span class="fc" id="L220">    }</span>

    /**
     * Estimates body kinematics (specific force applied to a body and its angular rates)
     * with respect ECEF frame and resolved along body-frame axes, averaged over time interval.
     *
     * @param timeInterval time interval between epochs.
     * @param c            body-to-NED coordinate transformation.
     * @param vn           north coordinate of velocity of body frame with respect ECEF frame, resolved along
     *                     north, east, and down and expressed in meters per second (m/s).
     * @param ve           east coordinate of velocity of body frame with respect ECEF frame, resolved along
     *                     north, east, and down and expressed in meters per second (m/s).
     * @param vd           down coordinate of velocity of body frame with respect ECEF frame, resolved along
     *                     north, east, and down and expressed in meters per second (m/s).
     * @param latitude     current latitude expressed in radians (rad).
     * @param height       current height expressed in meters (m).
     * @param oldFrame     NED frame containing previous position, velocity and body-to-NED coordinate transformation.
     * @param result       instance where estimated body kinematics will be stored.
     * @throws IllegalArgumentException if provided time interval is negative or coordinate transformation
     *                                  matrices are not NED frame valid.
     */
    public void estimate(final Time timeInterval,
                         final CoordinateTransformation c,
                         final double vn, final double ve, final double vd,
                         final double latitude, final double height,
                         final NEDFrame oldFrame, final ECEFKinematics result) {
<span class="fc" id="L246">        estimateKinematics(timeInterval, c, vn, ve, vd, latitude, height, oldFrame,</span>
                result);
<span class="fc" id="L248">    }</span>

    /**
     * Estimates body kinematics (specific force applied to a body and its angular rates)
     * with respect ECEF frame and resolved along body-frame axes, averaged over time interval.
     *
     * @param timeInterval time interval between epochs expressed in seconds (s).
     * @param frame        NED frame containing current position, velocity and body-to-NED coordinate transformation.
     * @param oldFrame     NED frame containing previous position, velocity and body-to-NED coordinate transformation.
     * @param result       instance where estimated body kinematics will be stored.
     * @throws IllegalArgumentException if provided time interval is negative.
     */
    public void estimate(final double timeInterval,
                         final NEDFrame frame, final NEDFrame oldFrame,
                         final ECEFKinematics result) {
<span class="fc" id="L263">        estimateKinematics(timeInterval, frame, oldFrame, result);</span>
<span class="fc" id="L264">    }</span>

    /**
     * Estimates body kinematics (specific force applied to a body and its angular rates)
     * with respect ECEF frame and resolved along body-frame axes, averaged over time interval.
     *
     * @param timeInterval time interval between epochs.
     * @param frame        NED frame containing current position, velocity and body-to-NED coordinate transformation.
     * @param oldFrame     NED frame containing previous position, velocity and body-to-NED coordinate transformation.
     * @param result       instance where estimated body kinematics will be stored.
     * @throws IllegalArgumentException if provided time interval is negative.
     */
    public void estimate(final Time timeInterval,
                         final NEDFrame frame, final NEDFrame oldFrame,
                         final ECEFKinematics result) {
<span class="fc" id="L279">        estimateKinematics(timeInterval, frame, oldFrame, result);</span>
<span class="fc" id="L280">    }</span>

    /**
     * Estimates body kinematics (specific force applied to a body and its angular rates)
     * with respect ECEF frame and resolved along body-frame axes, averaged over time interval.
     *
     * @param timeInterval time interval between epochs expressed in seconds (s).
     * @param c            body-to-NED coordinate transformation.
     * @param oldC         previous body-to-NED coordinate transformation.
     * @param vn           north coordinate of velocity of body frame with respect ECEF frame, resolved along
     *                     north, east, and down.
     * @param ve           east coordinate of velocity of body frame with respect ECEF frame, resolved along
     *                     north, east, and down.
     * @param vd           down coordinate of velocity of body frame with respect ECEF frame, resolved along
     *                     north, east, and down.
     * @param oldVn        north coordinate of previous velocity of body frame with respect ECEF frame, resolved
     *                     along north, east, and down.
     * @param oldVe        east coordinate of previous velocity of body frame with respect ECEF frame, resolved
     *                     along north, east, and down.
     * @param oldVd        down coordinate of previous velocity of body frame with respect ECEF frame, resolved
     *                     along north, east, and down.
     * @param latitude     current latitude expressed in radians (rad).
     * @param height       current height expressed in meters (m).
     * @param oldLatitude  previous latitude expressed in radians (rad).
     * @param oldHeight    previous height expressed in meters (m).
     * @param result       instance where estimated body kinematics will be stored.
     * @throws IllegalArgumentException if provided time interval is negative or coordinate transformation
     *                                  matrices are not NED frame valid.
     */
    public void estimate(final double timeInterval,
                         final CoordinateTransformation c,
                         final CoordinateTransformation oldC,
                         final Speed vn, final Speed ve, final Speed vd,
                         final Speed oldVn, final Speed oldVe, final Speed oldVd,
                         final double latitude, final double height,
                         final double oldLatitude, final double oldHeight,
                         final ECEFKinematics result) {
<span class="fc" id="L317">        estimateKinematics(timeInterval, c, oldC, vn, ve, vd, oldVn, oldVe, oldVd,</span>
                latitude, height, oldLatitude, oldHeight, result);
<span class="fc" id="L319">    }</span>

    /**
     * Estimates body kinematics (specific force applied to a body and its angular rates)
     * with respect ECEF frame and resolved along body-frame axes, averaged over time interval.
     *
     * @param timeInterval time interval between epochs.
     * @param c            body-to-NED coordinate transformation.
     * @param oldC         previous body-to-NED coordinate transformation.
     * @param vn           north coordinate of velocity of body frame with respect ECEF frame, resolved along
     *                     north, east, and down.
     * @param ve           east coordinate of velocity of body frame with respect ECEF frame, resolved along
     *                     north, east, and down.
     * @param vd           down coordinate of velocity of body frame with respect ECEF frame, resolved along
     *                     north, east, and down.
     * @param oldVn        north coordinate of previous velocity of body frame with respect ECEF frame, resolved
     *                     along north, east, and down.
     * @param oldVe        east coordinate of previous velocity of body frame with respect ECEF frame, resolved
     *                     along north, east, and down.
     * @param oldVd        down coordinate of previous velocity of body frame with respect ECEF frame, resolved
     *                     along north, east, and down.
     * @param latitude     current latitude expressed in radians (rad).
     * @param height       current height expressed in meters (m).
     * @param oldLatitude  previous latitude expressed in radians (rad).
     * @param oldHeight    previous height expressed in meters (m).
     * @param result       instance where estimated body kinematics will be stored.
     * @throws IllegalArgumentException if provided time interval is negative or coordinate transformation
     *                                  matrices are not NED frame valid.
     */
    public void estimate(final Time timeInterval,
                         final CoordinateTransformation c,
                         final CoordinateTransformation oldC,
                         final Speed vn, final Speed ve, final Speed vd,
                         final Speed oldVn, final Speed oldVe, final Speed oldVd,
                         final double latitude, final double height,
                         final double oldLatitude, final double oldHeight,
                         final ECEFKinematics result) {
<span class="fc" id="L356">        estimateKinematics(timeInterval, c, oldC, vn, ve, vd, oldVn, oldVe, oldVd,</span>
                latitude, height, oldLatitude, oldHeight, result);
<span class="fc" id="L358">    }</span>

    /**
     * Estimates body kinematics (specific force applied to a body and its angular rates)
     * with respect ECEF frame and resolved along body-frame axes, averaged over time interval.
     *
     * @param timeInterval time interval between epochs expressed in seconds (s).
     * @param c            body-to-NED coordinate transformation.
     * @param oldC         previous body-to-NED coordinate transformation.
     * @param vn           north coordinate of velocity of body frame with respect ECEF frame, resolved along
     *                     north, east, and down and expressed in meters per second (m/s).
     * @param ve           east coordinate of velocity of body frame with respect ECEF frame, resolved along
     *                     north, east, and down and expressed in meters per second (m/s).
     * @param vd           down coordinate of velocity of body frame with respect ECEF frame, resolved along
     *                     north, east, and down and expressed in meters per second (m/s).
     * @param oldVn        north coordinate of previous velocity of body frame with respect ECEF frame, resolved
     *                     along north, east, and down and expressed in meters per second (m/s).
     * @param oldVe        east coordinate of previous velocity of body frame with respect ECEF frame, resolved
     *                     along north, east, and down and expressed in meters per second (m/s).
     * @param oldVd        down coordinate of previous velocity of body frame with respect ECEF frame, resolved
     *                     along north, east, and down and expressed in meters per second (m/s).
     * @param latitude     current latitude.
     * @param height       current height expressed in meters (m).
     * @param oldLatitude  previous latitude.
     * @param oldHeight    previous height expressed in meters (m).
     * @param result       instance where estimated body kinematics will be stored.
     * @throws IllegalArgumentException if provided time interval is negative or coordinate transformation
     *                                  matrices are not NED frame valid.
     */
    public void estimate(final double timeInterval,
                         final CoordinateTransformation c,
                         final CoordinateTransformation oldC,
                         final double vn, final double ve, final double vd,
                         final double oldVn, final double oldVe, final double oldVd,
                         final Angle latitude, final double height,
                         final Angle oldLatitude, final double oldHeight,
                         final ECEFKinematics result) {
<span class="fc" id="L395">        estimateKinematics(timeInterval, c, oldC, vn, ve, vd, oldVn, oldVe, oldVd,</span>
                latitude, height, oldLatitude, oldHeight, result);
<span class="fc" id="L397">    }</span>

    /**
     * Estimates body kinematics (specific force applied to a body and its angular rates)
     * with respect ECEF frame and resolved along body-frame axes, averaged over time interval.
     *
     * @param timeInterval time interval between epochs.
     * @param c            body-to-NED coordinate transformation.
     * @param oldC         previous body-to-NED coordinate transformation.
     * @param vn           north coordinate of velocity of body frame with respect ECEF frame, resolved along
     *                     north, east, and down and expressed in meters per second (m/s).
     * @param ve           east coordinate of velocity of body frame with respect ECEF frame, resolved along
     *                     north, east, and down and expressed in meters per second (m/s).
     * @param vd           down coordinate of velocity of body frame with respect ECEF frame, resolved along
     *                     north, east, and down and expressed in meters per second (m/s).
     * @param oldVn        north coordinate of previous velocity of body frame with respect ECEF frame, resolved
     *                     along north, east, and down and expressed in meters per second (m/s).
     * @param oldVe        east coordinate of previous velocity of body frame with respect ECEF frame, resolved
     *                     along north, east, and down and expressed in meters per second (m/s).
     * @param oldVd        down coordinate of previous velocity of body frame with respect ECEF frame, resolved
     *                     along north, east, and down and expressed in meters per second (m/s).
     * @param latitude     current latitude.
     * @param height       current height expressed in meters (m).
     * @param oldLatitude  previous latitude.
     * @param oldHeight    previous height expressed in meters (m).
     * @param result       instance where estimated body kinematics will be stored.
     * @throws IllegalArgumentException if provided time interval is negative or coordinate transformation
     *                                  matrices are not NED frame valid.
     */
    public void estimate(final Time timeInterval,
                         final CoordinateTransformation c,
                         final CoordinateTransformation oldC,
                         final double vn, final double ve, final double vd,
                         final double oldVn, final double oldVe, final double oldVd,
                         final Angle latitude, final double height,
                         final Angle oldLatitude, final double oldHeight,
                         final ECEFKinematics result) {
<span class="fc" id="L434">        estimateKinematics(timeInterval, c, oldC, vn, ve, vd, oldVn, oldVe, oldVd,</span>
                latitude, height, oldLatitude, oldHeight, result);
<span class="fc" id="L436">    }</span>

    /**
     * Estimates body kinematics (specific force applied to a body and its angular rates)
     * with respect ECEF frame and resolved along body-frame axes, averaged over time interval.
     *
     * @param timeInterval time interval between epochs expressed in seconds (s).
     * @param c            body-to-NED coordinate transformation.
     * @param oldC         previous body-to-NED coordinate transformation.
     * @param vn           north coordinate of velocity of body frame with respect ECEF frame, resolved along
     *                     north, east, and down and expressed in meters per second (m/s).
     * @param ve           east coordinate of velocity of body frame with respect ECEF frame, resolved along
     *                     north, east, and down and expressed in meters per second (m/s).
     * @param vd           down coordinate of velocity of body frame with respect ECEF frame, resolved along
     *                     north, east, and down and expressed in meters per second (m/s).
     * @param oldVn        north coordinate of previous velocity of body frame with respect ECEF frame, resolved
     *                     along north, east, and down and expressed in meters per second (m/s).
     * @param oldVe        east coordinate of previous velocity of body frame with respect ECEF frame, resolved
     *                     along north, east, and down and expressed in meters per second (m/s).
     * @param oldVd        down coordinate of previous velocity of body frame with respect ECEF frame, resolved
     *                     along north, east, and down and expressed in meters per second (m/s).
     * @param latitude     current latitude expressed in radians (rad).
     * @param height       current height.
     * @param oldLatitude  previous latitude expressed in radians (rad).
     * @param oldHeight    previous height.
     * @param result       instance where estimated body kinematics will be stored.
     * @throws IllegalArgumentException if provided time interval is negative or coordinate transformation
     *                                  matrices are not NED frame valid.
     */
    public void estimate(final double timeInterval,
                         final CoordinateTransformation c,
                         final CoordinateTransformation oldC,
                         final double vn, final double ve, final double vd,
                         final double oldVn, final double oldVe, final double oldVd,
                         final double latitude, final Distance height,
                         final double oldLatitude, final Distance oldHeight,
                         final ECEFKinematics result) {
<span class="fc" id="L473">        estimateKinematics(timeInterval, c, oldC, vn, ve, vd, oldVn, oldVe, oldVd,</span>
                latitude, height, oldLatitude, oldHeight, result);
<span class="fc" id="L475">    }</span>

    /**
     * Estimates body kinematics (specific force applied to a body and its angular rates)
     * with respect ECEF frame and resolved along body-frame axes, averaged over time interval.
     *
     * @param timeInterval time interval between epochs.
     * @param c            body-to-NED coordinate transformation.
     * @param oldC         previous body-to-NED coordinate transformation.
     * @param vn           north coordinate of velocity of body frame with respect ECEF frame, resolved along
     *                     north, east, and down and expressed in meters per second (m/s).
     * @param ve           east coordinate of velocity of body frame with respect ECEF frame, resolved along
     *                     north, east, and down and expressed in meters per second (m/s).
     * @param vd           down coordinate of velocity of body frame with respect ECEF frame, resolved along
     *                     north, east, and down and expressed in meters per second (m/s).
     * @param oldVn        north coordinate of previous velocity of body frame with respect ECEF frame, resolved
     *                     along north, east, and down and expressed in meters per second (m/s).
     * @param oldVe        east coordinate of previous velocity of body frame with respect ECEF frame, resolved
     *                     along north, east, and down and expressed in meters per second (m/s).
     * @param oldVd        down coordinate of previous velocity of body frame with respect ECEF frame, resolved
     *                     along north, east, and down and expressed in meters per second (m/s).
     * @param latitude     current latitude expressed in radians (rad).
     * @param height       current height.
     * @param oldLatitude  previous latitude expressed in radians (rad).
     * @param oldHeight    previous height.
     * @param result       instance where estimated body kinematics will be stored.
     * @throws IllegalArgumentException if provided time interval is negative or coordinate transformation
     *                                  matrices are not NED frame valid.
     */
    public void estimate(final Time timeInterval,
                         final CoordinateTransformation c,
                         final CoordinateTransformation oldC,
                         final double vn, final double ve, final double vd,
                         final double oldVn, final double oldVe, final double oldVd,
                         final double latitude, final Distance height,
                         final double oldLatitude, final Distance oldHeight,
                         final ECEFKinematics result) {
<span class="fc" id="L512">        estimateKinematics(timeInterval, c, oldC, vn, ve, vd, oldVn, oldVe, oldVd,</span>
                latitude, height, oldLatitude, oldHeight, result);
<span class="fc" id="L514">    }</span>

    /**
     * Estimates body kinematics (specific force applied to a body and its angular rates)
     * with respect ECEF frame and resolved along body-frame axes, averaged over time interval.
     *
     * @param timeInterval time interval between epochs expressed in seconds (s).
     * @param c            body-to-NED coordinate transformation.
     * @param oldC         previous body-to-NED coordinate transformation.
     * @param vn           north coordinate of velocity of body frame with respect ECEF frame, resolved along
     *                     north, east, and down.
     * @param ve           east coordinate of velocity of body frame with respect ECEF frame, resolved along
     *                     north, east, and down.
     * @param vd           down coordinate of velocity of body frame with respect ECEF frame, resolved along
     *                     north, east, and down.
     * @param oldVn        north coordinate of previous velocity of body frame with respect ECEF frame, resolved
     *                     along north, east, and down.
     * @param oldVe        east coordinate of previous velocity of body frame with respect ECEF frame, resolved
     *                     along north, east, and down.
     * @param oldVd        down coordinate of previous velocity of body frame with respect ECEF frame, resolved
     *                     along north, east, and down.
     * @param latitude     current latitude.
     * @param height       current height.
     * @param oldLatitude  previous latitude.
     * @param oldHeight    previous height.
     * @param result       instance where estimated body kinematics will be stored.
     * @throws IllegalArgumentException if provided time interval is negative or coordinate transformation
     *                                  matrices are not NED frame valid.
     */
    public void estimate(final double timeInterval,
                         final CoordinateTransformation c,
                         final CoordinateTransformation oldC,
                         final Speed vn, final Speed ve, final Speed vd,
                         final Speed oldVn, final Speed oldVe, final Speed oldVd,
                         final Angle latitude, final Distance height,
                         final Angle oldLatitude, final Distance oldHeight,
                         final ECEFKinematics result) {
<span class="fc" id="L551">        estimateKinematics(timeInterval, c, oldC, vn, ve, vd, oldVn, oldVe, oldVd,</span>
                latitude, height, oldLatitude, oldHeight, result);
<span class="fc" id="L553">    }</span>

    /**
     * Estimates body kinematics (specific force applied to a body and its angular rates)
     * with respect ECEF frame and resolved along body-frame axes, averaged over time interval.
     *
     * @param timeInterval time interval between epochs.
     * @param c            body-to-NED coordinate transformation.
     * @param oldC         previous body-to-NED coordinate transformation.
     * @param vn           north coordinate of velocity of body frame with respect ECEF frame, resolved along
     *                     north, east, and down.
     * @param ve           east coordinate of velocity of body frame with respect ECEF frame, resolved along
     *                     north, east, and down.
     * @param vd           down coordinate of velocity of body frame with respect ECEF frame, resolved along
     *                     north, east, and down.
     * @param oldVn        north coordinate of previous velocity of body frame with respect ECEF frame, resolved
     *                     along north, east, and down.
     * @param oldVe        east coordinate of previous velocity of body frame with respect ECEF frame, resolved
     *                     along north, east, and down.
     * @param oldVd        down coordinate of previous velocity of body frame with respect ECEF frame, resolved
     *                     along north, east, and down.
     * @param latitude     current latitude.
     * @param height       current height.
     * @param oldLatitude  previous latitude.
     * @param oldHeight    previous height.
     * @param result       instance where estimated body kinematics will be stored.
     * @throws IllegalArgumentException if provided time interval is negative or coordinate transformation
     *                                  matrices are not NED frame valid.
     */
    public void estimate(final Time timeInterval,
                         final CoordinateTransformation c,
                         final CoordinateTransformation oldC,
                         final Speed vn, final Speed ve, final Speed vd,
                         final Speed oldVn, final Speed oldVe, final Speed oldVd,
                         final Angle latitude, final Distance height,
                         final Angle oldLatitude, final Distance oldHeight,
                         final ECEFKinematics result) {
<span class="fc" id="L590">        estimateKinematics(timeInterval, c, oldC, vn, ve, vd, oldVn, oldVe, oldVd,</span>
                latitude, height, oldLatitude, oldHeight, result);
<span class="fc" id="L592">    }</span>

    /**
     * Estimates body kinematics (specific force applied to a body and its angular rates)
     * with respect ECEF frame and resolved along body-frame axes, averaged over time interval.
     *
     * @param timeInterval time interval between epochs expressed in seconds (s).
     * @param c            body-to-NED coordinate transformation.
     * @param oldC         previous body-to-NED coordinate transformation.
     * @param vn           north coordinate of velocity of body frame with respect ECEF frame, resolved along
     *                     north, east, and down and expressed in meters per second (m/s).
     * @param ve           east coordinate of velocity of body frame with respect ECEF frame, resolved along
     *                     north, east, and down and expressed in meters per second (m/s).
     * @param vd           down coordinate of velocity of body frame with respect ECEF frame, resolved along
     *                     north, east, and down and expressed in meters per second (m/s).
     * @param oldVn        north coordinate of previous velocity of body frame with respect ECEF frame, resolved
     *                     along north, east, and down and expressed in meters per second (m/s).
     * @param oldVe        east coordinate of previous velocity of body frame with respect ECEF frame, resolved
     *                     along north, east, and down and expressed in meters per second (m/s).
     * @param oldVd        down coordinate of previous velocity of body frame with respect ECEF frame, resolved
     *                     along north, east, and down and expressed in meters per second (m/s).
     * @param latitude     current latitude expressed in radians (rad).
     * @param height       current height expressed in meters (m).
     * @param oldLatitude  previous latitude expressed in radians (rad).
     * @param oldHeight    previous height expressed in meters (m).
     * @return a new body kinematics instance.
     * @throws IllegalArgumentException if provided time interval is negative or coordinate transformation
     *                                  matrices are not NED frame valid.
     */
    public ECEFKinematics estimateAndReturnNew(final double timeInterval,
                                               final CoordinateTransformation c,
                                               final CoordinateTransformation oldC,
                                               final double vn, final double ve, final double vd,
                                               final double oldVn, final double oldVe, final double oldVd,
                                               final double latitude, final double height,
                                               final double oldLatitude, final double oldHeight) {
<span class="fc" id="L628">        return estimateKinematicsAndReturnNew(timeInterval, c, oldC, vn, ve, vd,</span>
                oldVn, oldVe, oldVd, latitude, height, oldLatitude, oldHeight);
    }

    /**
     * Estimates body kinematics (specific force applied to a body and its angular rates)
     * with respect ECEF frame and resolved along body-frame axes, averaged over time interval.
     *
     * @param timeInterval time interval between epochs.
     * @param c            body-to-NED coordinate transformation.
     * @param oldC         previous body-to-NED coordinate transformation.
     * @param vn           north coordinate of velocity of body frame with respect ECEF frame, resolved along
     *                     north, east, and down and expressed in meters per second (m/s).
     * @param ve           east coordinate of velocity of body frame with respect ECEF frame, resolved along
     *                     north, east, and down and expressed in meters per second (m/s).
     * @param vd           down coordinate of velocity of body frame with respect ECEF frame, resolved along
     *                     north, east, and down and expressed in meters per second (m/s).
     * @param oldVn        north coordinate of previous velocity of body frame with respect ECEF frame, resolved
     *                     along north, east, and down and expressed in meters per second (m/s).
     * @param oldVe        east coordinate of previous velocity of body frame with respect ECEF frame, resolved
     *                     along north, east, and down and expressed in meters per second (m/s).
     * @param oldVd        down coordinate of previous velocity of body frame with respect ECEF frame, resolved
     *                     along north, east, and down and expressed in meters per second (m/s).
     * @param latitude     current latitude expressed in radians (rad).
     * @param height       current height expressed in meters (m).
     * @param oldLatitude  previous latitude expressed in radians (rad).
     * @param oldHeight    previous height expressed in meters (m).
     * @return a new body kinematics instance.
     * @throws IllegalArgumentException if provided time interval is negative or coordinate transformation
     *                                  matrices are not NED frame valid.
     */
    public ECEFKinematics estimateAndReturnNew(final Time timeInterval,
                                               final CoordinateTransformation c,
                                               final CoordinateTransformation oldC,
                                               final double vn, final double ve, final double vd,
                                               final double oldVn, final double oldVe, final double oldVd,
                                               final double latitude, final double height,
                                               final double oldLatitude, final double oldHeight) {
<span class="fc" id="L666">        return estimateKinematicsAndReturnNew(timeInterval, c, oldC, vn, ve, vd,</span>
                oldVn, oldVe, oldVd, latitude, height, oldLatitude, oldHeight);
    }

    /**
     * Estimates body kinematics (specific force applied to a body and its angular rates)
     * with respect ECEF frame and resolved along body-frame axes, averaged over time interval.
     *
     * @param timeInterval time interval between epochs expressed in seconds (s).
     * @param frame        NED frame containing current position, velocity and body-to-NED coordinate transformation.
     * @param oldC         previous body-to-NED coordinate transformation.
     * @param oldVn        north coordinate of previous velocity of body frame with respect ECEF frame, resolved
     *                     along north, east, and down and expressed in meters per second (m/s).
     * @param oldVe        east coordinate of previous velocity of body frame with respect ECEF frame, resolved
     *                     along north, east, and down and expressed in meters per second (m/s).
     * @param oldVd        down coordinate of previous velocity of body frame with respect ECEF frame, resolved
     *                     along north, east, and down and expressed in meters per second (m/s).
     * @param oldLatitude  previous latitude expressed in radians (rad).
     * @param oldHeight    previous height expressed in meters (m).
     * @return a new body kinematics instance.
     * @throws IllegalArgumentException if provided time interval is negative or coordinate transformation
     *                                  matrices are not NED frame valid.
     */
    public ECEFKinematics estimateAndReturnNew(final double timeInterval,
                                               final NEDFrame frame,
                                               final CoordinateTransformation oldC,
                                               final double oldVn, final double oldVe, final double oldVd,
                                               final double oldLatitude, final double oldHeight) {
<span class="fc" id="L694">        return estimateKinematicsAndReturnNew(timeInterval, frame, oldC, oldVn, oldVe, oldVd,</span>
                oldLatitude, oldHeight);
    }

    /**
     * Estimates body kinematics (specific force applied to a body and its angular rates)
     * with respect ECEF frame and resolved along body-frame axes, averaged over time interval.
     *
     * @param timeInterval time interval between epochs.
     * @param frame        NED frame containing current position, velocity and body-to-NED coordinate transformation.
     * @param oldC         previous body-to-NED coordinate transformation.
     * @param oldVn        north coordinate of previous velocity of body frame with respect ECEF frame, resolved
     *                     along north, east, and down and expressed in meters per second (m/s).
     * @param oldVe        east coordinate of previous velocity of body frame with respect ECEF frame, resolved
     *                     along north, east, and down and expressed in meters per second (m/s).
     * @param oldVd        down coordinate of previous velocity of body frame with respect ECEF frame, resolved
     *                     along north, east, and down and expressed in meters per second (m/s).
     * @param oldLatitude  previous latitude expressed in radians (rad).
     * @param oldHeight    previous height expressed in meters (m).
     * @return a new body kinematics instance.
     * @throws IllegalArgumentException if provided time interval is negative or coordinate transformation
     *                                  matrices are not NED frame valid.
     */
    public ECEFKinematics estimateAndReturnNew(final Time timeInterval,
                                               final NEDFrame frame,
                                               final CoordinateTransformation oldC,
                                               final double oldVn, final double oldVe, final double oldVd,
                                               final double oldLatitude, final double oldHeight) {
<span class="fc" id="L722">        return estimateKinematicsAndReturnNew(timeInterval, frame, oldC, oldVn, oldVe, oldVd,</span>
                oldLatitude, oldHeight);
    }

    /**
     * Estimates body kinematics (specific force applied to a body and its angular rates)
     * with respect ECEF frame and resolved along body-frame axes, averaged over time interval.
     *
     * @param timeInterval time interval between epochs expressed in seconds (s).
     * @param c            body-to-NED coordinate transformation.
     * @param vn           north coordinate of velocity of body frame with respect ECEF frame, resolved along
     *                     north, east, and down and expressed in meters per second (m/s).
     * @param ve           east coordinate of velocity of body frame with respect ECEF frame, resolved along
     *                     north, east, and down and expressed in meters per second (m/s).
     * @param vd           down coordinate of velocity of body frame with respect ECEF frame, resolved along
     *                     north, east, and down and expressed in meters per second (m/s).
     * @param latitude     current latitude expressed in radians (rad).
     * @param height       current height expressed in meters (m).
     * @param oldFrame     NED frame containing previous position, velocity and body-to-NED coordinate transformation.
     * @return a new body kinematics instance.
     * @throws IllegalArgumentException if provided time interval is negative or coordinate transformation
     *                                  matrices are not NED frame valid.
     */
    public ECEFKinematics estimateAndReturnNew(final double timeInterval,
                                               final CoordinateTransformation c,
                                               final double vn, final double ve, final double vd,
                                               final double latitude, final double height,
                                               final NEDFrame oldFrame) {
<span class="fc" id="L750">        return estimateKinematicsAndReturnNew(timeInterval, c, vn, ve, vd, latitude, height,</span>
                oldFrame);
    }

    /**
     * Estimates body kinematics (specific force applied to a body and its angular rates)
     * with respect ECEF frame and resolved along body-frame axes, averaged over time interval.
     *
     * @param timeInterval time interval between epochs.
     * @param c            body-to-NED coordinate transformation.
     * @param vn           north coordinate of velocity of body frame with respect ECEF frame, resolved along
     *                     north, east, and down and expressed in meters per second (m/s).
     * @param ve           east coordinate of velocity of body frame with respect ECEF frame, resolved along
     *                     north, east, and down and expressed in meters per second (m/s).
     * @param vd           down coordinate of velocity of body frame with respect ECEF frame, resolved along
     *                     north, east, and down and expressed in meters per second (m/s).
     * @param latitude     current latitude expressed in radians (rad).
     * @param height       current height expressed in meters (m).
     * @param oldFrame     NED frame containing previous position, velocity and body-to-NED coordinate transformation.
     * @return a new body kinematics instance.
     * @throws IllegalArgumentException if provided time interval is negative or coordinate transformation
     *                                  matrices are not NED frame valid.
     */
    public ECEFKinematics estimateAndReturnNew(final Time timeInterval,
                                               final CoordinateTransformation c,
                                               final double vn, final double ve, final double vd,
                                               final double latitude, final double height,
                                               final NEDFrame oldFrame) {
<span class="fc" id="L778">        return estimateKinematicsAndReturnNew(timeInterval, c, vn, ve, vd, latitude, height,</span>
                oldFrame);
    }

    /**
     * Estimates body kinematics (specific force applied to a body and its angular rates)
     * with respect ECEF frame and resolved along body-frame axes, averaged over time interval.
     *
     * @param timeInterval time interval between epochs expressed in seconds (s).
     * @param frame        NED frame containing current position, velocity and body-to-NED coordinate transformation.
     * @param oldFrame     NED frame containing previous position, velocity and body-to-NED coordinate transformation.
     * @return a new body kinematics instance.
     * @throws IllegalArgumentException if provided time interval is negative.
     */
    public ECEFKinematics estimateAndReturnNew(final double timeInterval,
                                               final NEDFrame frame,
                                               final NEDFrame oldFrame) {
<span class="fc" id="L795">        return estimateKinematicsAndReturnNew(timeInterval, frame, oldFrame);</span>
    }

    /**
     * Estimates body kinematics (specific force applied to a body and its angular rates)
     * with respect ECEF frame and resolved along body-frame axes, averaged over time interval.
     *
     * @param timeInterval time interval between epochs.
     * @param frame        NED frame containing current position, velocity and body-to-NED coordinate transformation.
     * @param oldFrame     NED frame containing previous position, velocity and body-to-NED coordinate transformation.
     * @return a new body kinematics instance.
     * @throws IllegalArgumentException if provided time interval is negative.
     */
    public ECEFKinematics estimateAndReturnNew(final Time timeInterval,
                                               final NEDFrame frame,
                                               final NEDFrame oldFrame) {
<span class="fc" id="L811">        return estimateKinematicsAndReturnNew(timeInterval, frame, oldFrame);</span>
    }

    /**
     * Estimates body kinematics (specific force applied to a body and its angular rates)
     * with respect ECEF frame and resolved along body-frame axes, averaged over time interval.
     *
     * @param timeInterval time interval between epochs expressed in seconds (s).
     * @param c            body-to-NED coordinate transformation.
     * @param oldC         previous body-to-NED coordinate transformation.
     * @param vn           north coordinate of velocity of body frame with respect ECEF frame, resolved along
     *                     north, east, and down.
     * @param ve           east coordinate of velocity of body frame with respect ECEF frame, resolved along
     *                     north, east, and down.
     * @param vd           down coordinate of velocity of body frame with respect ECEF frame, resolved along
     *                     north, east, and down.
     * @param oldVn        north coordinate of previous velocity of body frame with respect ECEF frame, resolved
     *                     along north, east, and down.
     * @param oldVe        east coordinate of previous velocity of body frame with respect ECEF frame, resolved
     *                     along north, east, and down.
     * @param oldVd        down coordinate of previous velocity of body frame with respect ECEF frame, resolved
     *                     along north, east, and down.
     * @param latitude     current latitude expressed in radians (rad).
     * @param height       current height expressed in meters (m).
     * @param oldLatitude  previous latitude expressed in radians (rad).
     * @param oldHeight    previous height expressed in meters (m).
     * @return a new body kinematics instance.
     * @throws IllegalArgumentException if provided time interval is negative or coordinate transformation
     *                                  matrices are not NED frame valid.
     */
    public ECEFKinematics estimateAndReturnNew(final double timeInterval,
                                               final CoordinateTransformation c,
                                               final CoordinateTransformation oldC,
                                               final Speed vn, final Speed ve, final Speed vd,
                                               final Speed oldVn, final Speed oldVe, final Speed oldVd,
                                               final double latitude, final double height,
                                               final double oldLatitude, final double oldHeight) {
<span class="fc" id="L848">        return estimateKinematicsAndReturnNew(timeInterval, c, oldC, vn, ve, vd,</span>
                oldVn, oldVe, oldVd, latitude, height, oldLatitude, oldHeight);
    }

    /**
     * Estimates body kinematics (specific force applied to a body and its angular rates)
     * with respect ECEF frame and resolved along body-frame axes, averaged over time interval.
     *
     * @param timeInterval time interval between epochs.
     * @param c            body-to-NED coordinate transformation.
     * @param oldC         previous body-to-NED coordinate transformation.
     * @param vn           north coordinate of velocity of body frame with respect ECEF frame, resolved along
     *                     north, east, and down.
     * @param ve           east coordinate of velocity of body frame with respect ECEF frame, resolved along
     *                     north, east, and down.
     * @param vd           down coordinate of velocity of body frame with respect ECEF frame, resolved along
     *                     north, east, and down.
     * @param oldVn        north coordinate of previous velocity of body frame with respect ECEF frame, resolved
     *                     along north, east, and down.
     * @param oldVe        east coordinate of previous velocity of body frame with respect ECEF frame, resolved
     *                     along north, east, and down.
     * @param oldVd        down coordinate of previous velocity of body frame with respect ECEF frame, resolved
     *                     along north, east, and down.
     * @param latitude     current latitude expressed in radians (rad).
     * @param height       current height expressed in meters (m).
     * @param oldLatitude  previous latitude expressed in radians (rad).
     * @param oldHeight    previous height expressed in meters (m).
     * @return a new body kinematics instance.
     * @throws IllegalArgumentException if provided time interval is negative or coordinate transformation
     *                                  matrices are not NED frame valid.
     */
    public ECEFKinematics estimateAndReturnNew(final Time timeInterval,
                                               final CoordinateTransformation c,
                                               final CoordinateTransformation oldC,
                                               final Speed vn, final Speed ve, final Speed vd,
                                               final Speed oldVn, final Speed oldVe, final Speed oldVd,
                                               final double latitude, final double height,
                                               final double oldLatitude, final double oldHeight) {
<span class="fc" id="L886">        return estimateKinematicsAndReturnNew(timeInterval, c, oldC, vn, ve, vd,</span>
                oldVn, oldVe, oldVd, latitude, height, oldLatitude, oldHeight);
    }

    /**
     * Estimates body kinematics (specific force applied to a body and its angular rates)
     * with respect ECEF frame and resolved along body-frame axes, averaged over time interval.
     *
     * @param timeInterval time interval between epochs expressed in seconds (s).
     * @param c            body-to-NED coordinate transformation.
     * @param oldC         previous body-to-NED coordinate transformation.
     * @param vn           north coordinate of velocity of body frame with respect ECEF frame, resolved along
     *                     north, east, and down and expressed in meters per second (m/s).
     * @param ve           east coordinate of velocity of body frame with respect ECEF frame, resolved along
     *                     north, east, and down and expressed in meters per second (m/s).
     * @param vd           down coordinate of velocity of body frame with respect ECEF frame, resolved along
     *                     north, east, and down and expressed in meters per second (m/s).
     * @param oldVn        north coordinate of previous velocity of body frame with respect ECEF frame, resolved
     *                     along north, east, and down and expressed in meters per second (m/s).
     * @param oldVe        east coordinate of previous velocity of body frame with respect ECEF frame, resolved
     *                     along north, east, and down and expressed in meters per second (m/s).
     * @param oldVd        down coordinate of previous velocity of body frame with respect ECEF frame, resolved
     *                     along north, east, and down and expressed in meters per second (m/s).
     * @param latitude     current latitude.
     * @param height       current height expressed in meters (m).
     * @param oldLatitude  previous latitude.
     * @param oldHeight    previous height expressed in meters (m).
     * @return a new body kinematics instance.
     * @throws IllegalArgumentException if provided time interval is negative or coordinate transformation
     *                                  matrices are not NED frame valid.
     */
    public ECEFKinematics estimateAndReturnNew(final double timeInterval,
                                               final CoordinateTransformation c,
                                               final CoordinateTransformation oldC,
                                               final double vn, final double ve, final double vd,
                                               final double oldVn, final double oldVe, final double oldVd,
                                               final Angle latitude, final double height,
                                               final Angle oldLatitude, final double oldHeight) {
<span class="fc" id="L924">        return estimateKinematicsAndReturnNew(timeInterval, c, oldC, vn, ve, vd,</span>
                oldVn, oldVe, oldVd, latitude, height, oldLatitude, oldHeight);
    }

    /**
     * Estimates body kinematics (specific force applied to a body and its angular rates)
     * with respect ECEF frame and resolved along body-frame axes, averaged over time interval.
     *
     * @param timeInterval time interval between epochs.
     * @param c            body-to-NED coordinate transformation.
     * @param oldC         previous body-to-NED coordinate transformation.
     * @param vn           north coordinate of velocity of body frame with respect ECEF frame, resolved along
     *                     north, east, and down and expressed in meters per second (m/s).
     * @param ve           east coordinate of velocity of body frame with respect ECEF frame, resolved along
     *                     north, east, and down and expressed in meters per second (m/s).
     * @param vd           down coordinate of velocity of body frame with respect ECEF frame, resolved along
     *                     north, east, and down and expressed in meters per second (m/s).
     * @param oldVn        north coordinate of previous velocity of body frame with respect ECEF frame, resolved
     *                     along north, east, and down and expressed in meters per second (m/s).
     * @param oldVe        east coordinate of previous velocity of body frame with respect ECEF frame, resolved
     *                     along north, east, and down and expressed in meters per second (m/s).
     * @param oldVd        down coordinate of previous velocity of body frame with respect ECEF frame, resolved
     *                     along north, east, and down and expressed in meters per second (m/s).
     * @param latitude     current latitude.
     * @param height       current height expressed in meters (m).
     * @param oldLatitude  previous latitude.
     * @param oldHeight    previous height expressed in meters (m).
     * @return a new body kinematics instance.
     * @throws IllegalArgumentException if provided time interval is negative or coordinate transformation
     *                                  matrices are not NED frame valid.
     */
    public ECEFKinematics estimateAndReturnNew(final Time timeInterval,
                                               final CoordinateTransformation c,
                                               final CoordinateTransformation oldC,
                                               final double vn, final double ve, final double vd,
                                               final double oldVn, final double oldVe, final double oldVd,
                                               final Angle latitude, final double height,
                                               final Angle oldLatitude, final double oldHeight) {
<span class="fc" id="L962">        return estimateKinematicsAndReturnNew(timeInterval, c, oldC, vn, ve, vd,</span>
                oldVn, oldVe, oldVd, latitude, height, oldLatitude, oldHeight);
    }

    /**
     * Estimates body kinematics (specific force applied to a body and its angular rates)
     * with respect ECEF frame and resolved along body-frame axes, averaged over time interval.
     *
     * @param timeInterval time interval between epochs expressed in seconds (s).
     * @param c            body-to-NED coordinate transformation.
     * @param oldC         previous body-to-NED coordinate transformation.
     * @param vn           north coordinate of velocity of body frame with respect ECEF frame, resolved along
     *                     north, east, and down and expressed in meters per second (m/s).
     * @param ve           east coordinate of velocity of body frame with respect ECEF frame, resolved along
     *                     north, east, and down and expressed in meters per second (m/s).
     * @param vd           down coordinate of velocity of body frame with respect ECEF frame, resolved along
     *                     north, east, and down and expressed in meters per second (m/s).
     * @param oldVn        north coordinate of previous velocity of body frame with respect ECEF frame, resolved
     *                     along north, east, and down and expressed in meters per second (m/s).
     * @param oldVe        east coordinate of previous velocity of body frame with respect ECEF frame, resolved
     *                     along north, east, and down and expressed in meters per second (m/s).
     * @param oldVd        down coordinate of previous velocity of body frame with respect ECEF frame, resolved
     *                     along north, east, and down and expressed in meters per second (m/s).
     * @param latitude     current latitude expressed in radians (rad).
     * @param height       current height.
     * @param oldLatitude  previous latitude expressed in radians (rad).
     * @param oldHeight    previous height.
     * @return a new body kinematics instance.
     * @throws IllegalArgumentException if provided time interval is negative or coordinate transformation
     *                                  matrices are not NED frame valid.
     */
    public ECEFKinematics estimateAndReturnNew(final double timeInterval,
                                               final CoordinateTransformation c,
                                               final CoordinateTransformation oldC,
                                               final double vn, final double ve, final double vd,
                                               final double oldVn, final double oldVe, final double oldVd,
                                               final double latitude, final Distance height,
                                               final double oldLatitude, final Distance oldHeight) {
<span class="fc" id="L1000">        return estimateKinematicsAndReturnNew(timeInterval, c, oldC, vn, ve, vd,</span>
                oldVn, oldVe, oldVd, latitude, height, oldLatitude, oldHeight);
    }

    /**
     * Estimates body kinematics (specific force applied to a body and its angular rates)
     * with respect ECEF frame and resolved along body-frame axes, averaged over time interval.
     *
     * @param timeInterval time interval between epochs.
     * @param c            body-to-NED coordinate transformation.
     * @param oldC         previous body-to-NED coordinate transformation.
     * @param vn           north coordinate of velocity of body frame with respect ECEF frame, resolved along
     *                     north, east, and down and expressed in meters per second (m/s).
     * @param ve           east coordinate of velocity of body frame with respect ECEF frame, resolved along
     *                     north, east, and down and expressed in meters per second (m/s).
     * @param vd           down coordinate of velocity of body frame with respect ECEF frame, resolved along
     *                     north, east, and down and expressed in meters per second (m/s).
     * @param oldVn        north coordinate of previous velocity of body frame with respect ECEF frame, resolved
     *                     along north, east, and down and expressed in meters per second (m/s).
     * @param oldVe        east coordinate of previous velocity of body frame with respect ECEF frame, resolved
     *                     along north, east, and down and expressed in meters per second (m/s).
     * @param oldVd        down coordinate of previous velocity of body frame with respect ECEF frame, resolved
     *                     along north, east, and down and expressed in meters per second (m/s).
     * @param latitude     current latitude expressed in radians (rad).
     * @param height       current height.
     * @param oldLatitude  previous latitude expressed in radians (rad).
     * @param oldHeight    previous height.
     * @return a new body kinematics instance.
     * @throws IllegalArgumentException if provided time interval is negative or coordinate transformation
     *                                  matrices are not NED frame valid.
     */
    public ECEFKinematics estimateAndReturnNew(final Time timeInterval,
                                               final CoordinateTransformation c,
                                               final CoordinateTransformation oldC,
                                               final double vn, final double ve, final double vd,
                                               final double oldVn, final double oldVe, final double oldVd,
                                               final double latitude, final Distance height,
                                               final double oldLatitude, final Distance oldHeight) {
<span class="fc" id="L1038">        return estimateKinematicsAndReturnNew(timeInterval, c, oldC, vn, ve, vd,</span>
                oldVn, oldVe, oldVd, latitude, height, oldLatitude, oldHeight);
    }

    /**
     * Estimates body kinematics (specific force applied to a body and its angular rates)
     * with respect ECEF frame and resolved along body-frame axes, averaged over time interval.
     *
     * @param timeInterval time interval between epochs expressed in seconds (s).
     * @param c            body-to-NED coordinate transformation.
     * @param oldC         previous body-to-NED coordinate transformation.
     * @param vn           north coordinate of velocity of body frame with respect ECEF frame, resolved along
     *                     north, east, and down.
     * @param ve           east coordinate of velocity of body frame with respect ECEF frame, resolved along
     *                     north, east, and down.
     * @param vd           down coordinate of velocity of body frame with respect ECEF frame, resolved along
     *                     north, east, and down.
     * @param oldVn        north coordinate of previous velocity of body frame with respect ECEF frame, resolved
     *                     along north, east, and down.
     * @param oldVe        east coordinate of previous velocity of body frame with respect ECEF frame, resolved
     *                     along north, east, and down.
     * @param oldVd        down coordinate of previous velocity of body frame with respect ECEF frame, resolved
     *                     along north, east, and down.
     * @param latitude     current latitude.
     * @param height       current height.
     * @param oldLatitude  previous latitude.
     * @param oldHeight    previous height.
     * @return a new body kinematics instance.
     * @throws IllegalArgumentException if provided time interval is negative or coordinate transformation
     *                                  matrices are not NED frame valid.
     */
    public ECEFKinematics estimateAndReturnNew(final double timeInterval,
                                               final CoordinateTransformation c,
                                               final CoordinateTransformation oldC,
                                               final Speed vn, final Speed ve, final Speed vd,
                                               final Speed oldVn, final Speed oldVe, final Speed oldVd,
                                               final Angle latitude, final Distance height,
                                               final Angle oldLatitude, final Distance oldHeight) {
<span class="fc" id="L1076">        return estimateKinematicsAndReturnNew(timeInterval, c, oldC, vn, ve, vd,</span>
                oldVn, oldVe, oldVd, latitude, height, oldLatitude, oldHeight);
    }

    /**
     * Estimates body kinematics (specific force applied to a body and its angular rates)
     * with respect ECEF frame and resolved along body-frame axes, averaged over time interval.
     *
     * @param timeInterval time interval between epochs.
     * @param c            body-to-NED coordinate transformation.
     * @param oldC         previous body-to-NED coordinate transformation.
     * @param vn           north coordinate of velocity of body frame with respect ECEF frame, resolved along
     *                     north, east, and down.
     * @param ve           east coordinate of velocity of body frame with respect ECEF frame, resolved along
     *                     north, east, and down.
     * @param vd           down coordinate of velocity of body frame with respect ECEF frame, resolved along
     *                     north, east, and down.
     * @param oldVn        north coordinate of previous velocity of body frame with respect ECEF frame, resolved
     *                     along north, east, and down.
     * @param oldVe        east coordinate of previous velocity of body frame with respect ECEF frame, resolved
     *                     along north, east, and down.
     * @param oldVd        down coordinate of previous velocity of body frame with respect ECEF frame, resolved
     *                     along north, east, and down.
     * @param latitude     current latitude.
     * @param height       current height.
     * @param oldLatitude  previous latitude.
     * @param oldHeight    previous height.
     * @return a new body kinematics instance.
     * @throws IllegalArgumentException if provided time interval is negative or coordinate transformation
     *                                  matrices are not NED frame valid.
     */
    public ECEFKinematics estimateAndReturnNew(final Time timeInterval,
                                               final CoordinateTransformation c,
                                               final CoordinateTransformation oldC,
                                               final Speed vn, final Speed ve, final Speed vd,
                                               final Speed oldVn, final Speed oldVe, final Speed oldVd,
                                               final Angle latitude, final Distance height,
                                               final Angle oldLatitude, final Distance oldHeight) {
<span class="fc" id="L1114">        return estimateKinematicsAndReturnNew(timeInterval, c, oldC, vn, ve, vd,</span>
                oldVn, oldVe, oldVd, latitude, height, oldLatitude, oldHeight);
    }

    /**
     * Estimates body kinematics (specific force applied to a body and its angular rates)
     * with respect ECEF frame and resolved along body-frame axes, averaged over time interval.
     *
     * @param timeInterval time interval between epochs expressed in seconds (s).
     * @param c            body-to-NED coordinate transformation.
     * @param oldC         previous body-to-NED coordinate transformation.
     * @param vn           north coordinate of velocity of body frame with respect ECEF frame, resolved along
     *                     north, east, and down and expressed in meters per second (m/s).
     * @param ve           east coordinate of velocity of body frame with respect ECEF frame, resolved along
     *                     north, east, and down and expressed in meters per second (m/s).
     * @param vd           down coordinate of velocity of body frame with respect ECEF frame, resolved along
     *                     north, east, and down and expressed in meters per second (m/s).
     * @param oldVn        north coordinate of previous velocity of body frame with respect ECEF frame, resolved
     *                     along north, east, and down and expressed in meters per second (m/s).
     * @param oldVe        east coordinate of previous velocity of body frame with respect ECEF frame, resolved
     *                     along north, east, and down and expressed in meters per second (m/s).
     * @param oldVd        down coordinate of previous velocity of body frame with respect ECEF frame, resolved
     *                     along north, east, and down and expressed in meters per second (m/s).
     * @param latitude     current latitude expressed in radians (rad).
     * @param height       current height expressed in meters (m).
     * @param oldLatitude  previous latitude expressed in radians (rad).
     * @param oldHeight    previous height expressed in meters (m).
     * @param result       instance where estimated body kinematics will be stored.
     * @throws IllegalArgumentException if provided time interval is negative or coordinate transformation
     *                                  matrices are not NED frame valid.
     */
    public static void estimateKinematics(final double timeInterval,
                                          final CoordinateTransformation c,
                                          final CoordinateTransformation oldC,
                                          final double vn, final double ve, final double vd,
                                          final double oldVn, final double oldVe, final double oldVd,
                                          final double latitude, final double height,
                                          final double oldLatitude, final double oldHeight,
                                          final ECEFKinematics result) {

<span class="pc bpc" id="L1154" title="1 of 2 branches missed.">        if (timeInterval &lt; 0.0</span>
<span class="pc bpc" id="L1155" title="1 of 2 branches missed.">                || !NEDFrame.isValidCoordinateTransformation(c)</span>
<span class="pc bpc" id="L1156" title="1 of 2 branches missed.">                || !NEDFrame.isValidCoordinateTransformation(oldC)) {</span>
<span class="nc" id="L1157">            throw new IllegalArgumentException();</span>
        }

<span class="pc bpc" id="L1160" title="1 of 2 branches missed.">        if (timeInterval &gt; 0.0) {</span>
            try {
                // From (2.123), determine the angular rate of the ECEF frame
                // with respect the ECI frame, resolved about NED
<span class="fc" id="L1164">                final Matrix omegaIen = new Matrix(ROWS, 1);</span>
<span class="fc" id="L1165">                omegaIen.setElementAtIndex(0,</span>
<span class="fc" id="L1166">                        EARTH_ROTATION_RATE * Math.cos(oldLatitude));</span>
<span class="fc" id="L1167">                omegaIen.setElementAtIndex(1, 0.0);</span>
<span class="fc" id="L1168">                omegaIen.setElementAtIndex(2,</span>
<span class="fc" id="L1169">                        -EARTH_ROTATION_RATE * Math.sin(oldLatitude));</span>

                // From (5.44), determine the angular rate of the NED frame
                // with respect the ECEF frame, resolved about NED
<span class="fc" id="L1173">                final RadiiOfCurvature oldRadiiOfCurvature = RadiiOfCurvatureEstimator</span>
<span class="fc" id="L1174">                        .estimateRadiiOfCurvatureAndReturnNew(oldLatitude);</span>
<span class="fc" id="L1175">                final double oldRn = oldRadiiOfCurvature.getRn();</span>
<span class="fc" id="L1176">                final double oldRe = oldRadiiOfCurvature.getRe();</span>

<span class="fc" id="L1178">                final RadiiOfCurvature radiiOfCurvature = RadiiOfCurvatureEstimator</span>
<span class="fc" id="L1179">                        .estimateRadiiOfCurvatureAndReturnNew(latitude);</span>
<span class="fc" id="L1180">                final double rn = radiiOfCurvature.getRn();</span>
<span class="fc" id="L1181">                final double re = radiiOfCurvature.getRe();</span>

<span class="fc" id="L1183">                final Matrix oldOmegaEnN = new Matrix(ROWS, 1);</span>
<span class="fc" id="L1184">                oldOmegaEnN.setElementAtIndex(0,</span>
                        oldVe / (oldRe + oldHeight));
<span class="fc" id="L1186">                oldOmegaEnN.setElementAtIndex(1,</span>
                        -oldVn / (oldRn + oldHeight));
<span class="fc" id="L1188">                oldOmegaEnN.setElementAtIndex(2,</span>
<span class="fc" id="L1189">                        -oldVe * Math.tan(oldLatitude) /</span>
                                (oldRe + oldHeight));

<span class="fc" id="L1192">                final Matrix omegaEnN = new Matrix(ROWS, 1);</span>
<span class="fc" id="L1193">                omegaEnN.setElementAtIndex(0, ve / (re + height));</span>
<span class="fc" id="L1194">                omegaEnN.setElementAtIndex(1, -vn / (rn + height));</span>
<span class="fc" id="L1195">                omegaEnN.setElementAtIndex(2,</span>
<span class="fc" id="L1196">                        -ve * Math.tan(latitude) / (re + height));</span>

                // Obtain coordinate transformation matrix from the old attitude (with
                // respect the inertial frame) to the new using (5.77)
<span class="fc" id="L1200">                final Matrix cbn = c.getMatrix();</span>
<span class="fc" id="L1201">                cbn.transpose();</span>

<span class="fc" id="L1203">                final Matrix omega = omegaIen.addAndReturnNew(</span>
<span class="fc" id="L1204">                        omegaEnN.multiplyByScalarAndReturnNew(0.5));</span>
<span class="fc" id="L1205">                omega.add(oldOmegaEnN.multiplyByScalarAndReturnNew(0.5));</span>
<span class="fc" id="L1206">                final Matrix skew1 = Utils.skewMatrix(omega);</span>
<span class="fc" id="L1207">                skew1.multiplyByScalar(timeInterval);</span>

<span class="fc" id="L1209">                final Matrix tmp1 = Matrix.identity(ROWS, ROWS);</span>
<span class="fc" id="L1210">                tmp1.subtract(skew1);</span>

<span class="fc" id="L1212">                final Matrix oldCbn = oldC.getMatrix();</span>
<span class="fc" id="L1213">                cbn.multiply(tmp1);</span>
<span class="fc" id="L1214">                cbn.multiply(oldCbn);</span>
                // cbn contains transformation matrix from the old to the new attitude (cOldNew)

                // Calculate the approximate angular rate with respect an inertial frame
<span class="fc" id="L1218">                final Matrix alphaIbb = new Matrix(ROWS, 1);</span>
<span class="fc" id="L1219">                alphaIbb.setElementAtIndex(0,</span>
<span class="fc" id="L1220">                        0.5 * (cbn.getElementAt(1, 2) - cbn.getElementAt(2, 1)));</span>
<span class="fc" id="L1221">                alphaIbb.setElementAtIndex(1,</span>
<span class="fc" id="L1222">                        0.5 * (cbn.getElementAt(2, 0) - cbn.getElementAt(0, 2)));</span>
<span class="fc" id="L1223">                alphaIbb.setElementAtIndex(2,</span>
<span class="fc" id="L1224">                        0.5 * (cbn.getElementAt(0, 1) - cbn.getElementAt(1, 0)));</span>

                // Calculate and apply the scaling factor
<span class="fc" id="L1227">                final double temp = Math.acos(0.5 * (Utils.trace(cbn) - 1.0));</span>
<span class="pc bpc" id="L1228" title="1 of 2 branches missed.">                if (temp &gt; SCALING_THRESHOLD) {</span>
                    // Scaling is 1 if temp is less than this
<span class="fc" id="L1230">                    alphaIbb.multiplyByScalar(temp / Math.sin(temp));</span>
                }

                // Calculate the angular rate
<span class="fc" id="L1234">                final double angularRateX = alphaIbb.getElementAtIndex(0) / timeInterval;</span>
<span class="fc" id="L1235">                final double angularRateY = alphaIbb.getElementAtIndex(1) / timeInterval;</span>
<span class="fc" id="L1236">                final double angularRateZ = alphaIbb.getElementAtIndex(2) / timeInterval;</span>

                // Calculate the specific force resolved about ECEF-frame axes
                // From (5.54)
<span class="fc" id="L1240">                final Matrix tmp2 = new Matrix(ROWS, 1);</span>
<span class="fc" id="L1241">                tmp2.setElementAtIndex(0, (vn - oldVn) / timeInterval);</span>
<span class="fc" id="L1242">                tmp2.setElementAtIndex(1, (ve - oldVe) / timeInterval);</span>
<span class="fc" id="L1243">                tmp2.setElementAtIndex(2, (vd - oldVd) / timeInterval);</span>

<span class="fc" id="L1245">                final NEDGravity gravity = NEDGravityEstimator.estimateGravityAndReturnNew(</span>
                        oldLatitude, oldHeight);
<span class="fc" id="L1247">                final Matrix g = gravity.asMatrix();</span>

<span class="fc" id="L1249">                final Matrix oldVebn = new Matrix(ROWS, 1);</span>
<span class="fc" id="L1250">                oldVebn.setElementAtIndex(0, oldVn);</span>
<span class="fc" id="L1251">                oldVebn.setElementAtIndex(1, oldVe);</span>
<span class="fc" id="L1252">                oldVebn.setElementAtIndex(2, oldVd);</span>

<span class="fc" id="L1254">                final Matrix skew2 = Utils.skewMatrix(oldOmegaEnN.addAndReturnNew(</span>
<span class="fc" id="L1255">                        omegaIen.multiplyByScalarAndReturnNew(2.0)));</span>
<span class="fc" id="L1256">                skew2.multiply(oldVebn);</span>

<span class="fc" id="L1258">                tmp2.subtract(g);</span>
<span class="fc" id="L1259">                tmp2.add(skew2);</span>
                // tmp2 now contains specific force resolved about ECEF (fIbn)

                // Calculate the average body-to-NED coordinate transformation
                // matrix over the update interval using (5.84) and (5.86)
<span class="fc" id="L1264">                final double magAlpha = Utils.normF(alphaIbb);</span>
<span class="fc" id="L1265">                final Matrix skewAlpha = Utils.skewMatrix(alphaIbb);</span>

<span class="fc" id="L1267">                oldOmegaEnN.add(omegaIen);</span>
<span class="fc" id="L1268">                final Matrix tmp3 = Utils.skewMatrix(oldOmegaEnN);</span>
<span class="fc" id="L1269">                tmp3.multiplyByScalar(0.5);</span>
<span class="fc" id="L1270">                tmp3.multiply(oldCbn);</span>

<span class="pc bpc" id="L1272" title="1 of 2 branches missed.">                if (magAlpha &gt; ALPHA_THRESHOLD) {</span>
<span class="fc" id="L1273">                    final double magAlpha2 = magAlpha * magAlpha;</span>
<span class="fc" id="L1274">                    final double value1 = (1.0 - Math.cos(magAlpha)) / magAlpha2;</span>
<span class="fc" id="L1275">                    final double value2 = (1.0 - Math.sin(magAlpha) / magAlpha) / magAlpha2;</span>

<span class="fc" id="L1277">                    final Matrix tmp4 = skewAlpha.multiplyByScalarAndReturnNew(value1);</span>
<span class="fc" id="L1278">                    final Matrix tmp5 = skewAlpha.multiplyByScalarAndReturnNew(value2);</span>
<span class="fc" id="L1279">                    tmp5.multiply(skewAlpha);</span>

<span class="fc" id="L1281">                    final Matrix tmp6 = Matrix.identity(ROWS, ROWS);</span>
<span class="fc" id="L1282">                    tmp6.add(tmp4);</span>
<span class="fc" id="L1283">                    tmp6.add(tmp5);</span>

<span class="fc" id="L1285">                    oldCbn.multiply(tmp6);</span>
                }

<span class="fc" id="L1288">                oldCbn.subtract(tmp3);</span>
                // oldCbn now contains average body-to-NED (aveCbn)

                // Transform specific force to body-frame resolving axes using (5.81)
<span class="fc" id="L1292">                final Matrix fIbb = Utils.inverse(oldCbn);</span>
<span class="fc" id="L1293">                fIbb.multiply(tmp2);</span>

<span class="fc" id="L1295">                final double specificForceX = fIbb.getElementAtIndex(0);</span>
<span class="fc" id="L1296">                final double specificForceY = fIbb.getElementAtIndex(1);</span>
<span class="fc" id="L1297">                final double specificForceZ = fIbb.getElementAtIndex(2);</span>

                // save result data
<span class="fc" id="L1300">                result.setSpecificForceCoordinates(specificForceX, specificForceY,</span>
                        specificForceZ);
<span class="fc" id="L1302">                result.setAngularRateCoordinates(angularRateX, angularRateY,</span>
                        angularRateZ);

<span class="nc" id="L1305">            } catch (final AlgebraException ignore) {</span>
                // never happens
<span class="pc" id="L1307">            }</span>
        } else {
            // If time interval is zero, set angular rate and specific force to zero
<span class="nc" id="L1310">            result.setSpecificForceCoordinates(0.0, 0.0, 0.0);</span>
<span class="nc" id="L1311">            result.setAngularRateCoordinates(0.0, 0.0, 0.0);</span>
        }
<span class="fc" id="L1313">    }</span>

    /**
     * Estimates body kinematics (specific force applied to a body and its angular rates)
     * with respect ECEF frame and resolved along body-frame axes, averaged over time interval.
     *
     * @param timeInterval time interval between epochs.
     * @param c            body-to-NED coordinate transformation.
     * @param oldC         previous body-to-NED coordinate transformation.
     * @param vn           north coordinate of velocity of body frame with respect ECEF frame, resolved along
     *                     north, east, and down and expressed in meters per second (m/s).
     * @param ve           east coordinate of velocity of body frame with respect ECEF frame, resolved along
     *                     north, east, and down and expressed in meters per second (m/s).
     * @param vd           down coordinate of velocity of body frame with respect ECEF frame, resolved along
     *                     north, east, and down and expressed in meters per second (m/s).
     * @param oldVn        north coordinate of previous velocity of body frame with respect ECEF frame, resolved
     *                     along north, east, and down and expressed in meters per second (m/s).
     * @param oldVe        east coordinate of previous velocity of body frame with respect ECEF frame, resolved
     *                     along north, east, and down and expressed in meters per second (m/s).
     * @param oldVd        down coordinate of previous velocity of body frame with respect ECEF frame, resolved
     *                     along north, east, and down and expressed in meters per second (m/s).
     * @param latitude     current latitude expressed in radians (rad).
     * @param height       current height expressed in meters (m).
     * @param oldLatitude  previous latitude expressed in radians (rad).
     * @param oldHeight    previous height expressed in meters (m).
     * @param result       instance where estimated body kinematics will be stored.
     * @throws IllegalArgumentException if provided time interval is negative or coordinate
     */
    public static void estimateKinematics(final Time timeInterval,
                                          final CoordinateTransformation c,
                                          final CoordinateTransformation oldC,
                                          final double vn, final double ve, final double vd,
                                          final double oldVn, final double oldVe, final double oldVd,
                                          final double latitude, final double height,
                                          final double oldLatitude, final double oldHeight,
                                          final ECEFKinematics result) {
<span class="fc" id="L1349">        estimateKinematics(convertTime(timeInterval), c, oldC, vn, ve, vd,</span>
                oldVn, oldVe, oldVd, latitude, height, oldLatitude, oldHeight, result);
<span class="fc" id="L1351">    }</span>

    /**
     * Estimates body kinematics (specific force applied to a body and its angular rates)
     * with respect ECEF frame and resolved along body-frame axes, averaged over time interval.
     *
     * @param timeInterval time interval between epochs expressed in seconds (s).
     * @param frame        NED frame containing current position, velocity and body-to-NED coordinate transformation.
     * @param oldC         previous body-to-NED coordinate transformation.
     * @param oldVn        north coordinate of previous velocity of body frame with respect ECEF frame, resolved
     *                     along north, east, and down and expressed in meters per second (m/s).
     * @param oldVe        east coordinate of previous velocity of body frame with respect ECEF frame, resolved
     *                     along north, east, and down and expressed in meters per second (m/s).
     * @param oldVd        down coordinate of previous velocity of body frame with respect ECEF frame, resolved
     *                     along north, east, and down and expressed in meters per second (m/s).
     * @param oldLatitude  previous latitude expressed in radians (rad).
     * @param oldHeight    previous height expressed in meters (m).
     * @param result       instance where estimated body kinematics will be stored.
     * @throws IllegalArgumentException if provided time interval is negative or coordinate transformation
     *                                  matrices are not NED frame valid.
     */
    public static void estimateKinematics(final double timeInterval,
                                          final NEDFrame frame,
                                          final CoordinateTransformation oldC,
                                          final double oldVn, final double oldVe, final double oldVd,
                                          final double oldLatitude, final double oldHeight,
                                          final ECEFKinematics result) {
<span class="fc" id="L1378">        estimateKinematics(timeInterval, frame.getCoordinateTransformation(), oldC,</span>
<span class="fc" id="L1379">                frame.getVn(), frame.getVe(), frame.getVd(), oldVn, oldVe, oldVd,</span>
<span class="fc" id="L1380">                frame.getLatitude(), frame.getHeight(), oldLatitude, oldHeight, result);</span>
<span class="fc" id="L1381">    }</span>

    /**
     * Estimates body kinematics (specific force applied to a body and its angular rates)
     * with respect ECEF frame and resolved along body-frame axes, averaged over time interval.
     *
     * @param timeInterval time interval between epochs.
     * @param frame        NED frame containing current position, velocity and body-to-NED coordinate transformation.
     * @param oldC         previous body-to-NED coordinate transformation.
     * @param oldVn        north coordinate of previous velocity of body frame with respect ECEF frame, resolved
     *                     along north, east, and down and expressed in meters per second (m/s).
     * @param oldVe        east coordinate of previous velocity of body frame with respect ECEF frame, resolved
     *                     along north, east, and down and expressed in meters per second (m/s).
     * @param oldVd        down coordinate of previous velocity of body frame with respect ECEF frame, resolved
     *                     along north, east, and down and expressed in meters per second (m/s).
     * @param oldLatitude  previous latitude expressed in radians (rad).
     * @param oldHeight    previous height expressed in meters (m).
     * @param result       instance where estimated body kinematics will be stored.
     * @throws IllegalArgumentException if provided time interval is negative or coordinate transformation
     *                                  matrices are not NED frame valid.
     */
    public static void estimateKinematics(final Time timeInterval,
                                          final NEDFrame frame,
                                          final CoordinateTransformation oldC,
                                          final double oldVn, final double oldVe, final double oldVd,
                                          final double oldLatitude, final double oldHeight,
                                          final ECEFKinematics result) {
<span class="fc" id="L1408">        estimateKinematics(convertTime(timeInterval), frame, oldC, oldVn, oldVe, oldVd,</span>
                oldLatitude, oldHeight, result);
<span class="fc" id="L1410">    }</span>

    /**
     * Estimates body kinematics (specific force applied to a body and its angular rates)
     * with respect ECEF frame and resolved along body-frame axes, averaged over time interval.
     *
     * @param timeInterval time interval between epochs expressed in seconds (s).
     * @param c            body-to-NED coordinate transformation.
     * @param vn           north coordinate of velocity of body frame with respect ECEF frame, resolved along
     *                     north, east, and down and expressed in meters per second (m/s).
     * @param ve           east coordinate of velocity of body frame with respect ECEF frame, resolved along
     *                     north, east, and down and expressed in meters per second (m/s).
     * @param vd           down coordinate of velocity of body frame with respect ECEF frame, resolved along
     *                     north, east, and down and expressed in meters per second (m/s).
     * @param latitude     current latitude expressed in radians (rad).
     * @param height       current height expressed in meters (m).
     * @param oldFrame     NED frame containing previous position, velocity and body-to-NED coordinate transformation.
     * @param result       instance where estimated body kinematics will be stored.
     * @throws IllegalArgumentException if provided time interval is negative or coordinate transformation
     *                                  matrices are not NED frame valid.
     */
    public static void estimateKinematics(final double timeInterval,
                                          final CoordinateTransformation c,
                                          final double vn, final double ve, final double vd,
                                          final double latitude, final double height,
                                          final NEDFrame oldFrame, final ECEFKinematics result) {
<span class="fc" id="L1436">        estimateKinematics(timeInterval, c, oldFrame.getCoordinateTransformation(),</span>
<span class="fc" id="L1437">                vn, ve, vd, oldFrame.getVn(), oldFrame.getVe(), oldFrame.getVd(),</span>
<span class="fc" id="L1438">                latitude, height, oldFrame.getLatitude(), oldFrame.getHeight(), result);</span>
<span class="fc" id="L1439">    }</span>

    /**
     * Estimates body kinematics (specific force applied to a body and its angular rates)
     * with respect ECEF frame and resolved along body-frame axes, averaged over time interval.
     *
     * @param timeInterval time interval between epochs.
     * @param c            body-to-NED coordinate transformation.
     * @param vn           north coordinate of velocity of body frame with respect ECEF frame, resolved along
     *                     north, east, and down and expressed in meters per second (m/s).
     * @param ve           east coordinate of velocity of body frame with respect ECEF frame, resolved along
     *                     north, east, and down and expressed in meters per second (m/s).
     * @param vd           down coordinate of velocity of body frame with respect ECEF frame, resolved along
     *                     north, east, and down and expressed in meters per second (m/s).
     * @param latitude     current latitude expressed in radians (rad).
     * @param height       current height expressed in meters (m).
     * @param oldFrame     NED frame containing previous position, velocity and body-to-NED coordinate transformation.
     * @param result       instance where estimated body kinematics will be stored.
     * @throws IllegalArgumentException if provided time interval is negative or coordinate transformation
     *                                  matrices are not NED frame valid.
     */
    public static void estimateKinematics(final Time timeInterval,
                                          final CoordinateTransformation c,
                                          final double vn, final double ve, final double vd,
                                          final double latitude, final double height,
                                          final NEDFrame oldFrame, final ECEFKinematics result) {
<span class="fc" id="L1465">        estimateKinematics(convertTime(timeInterval), c, vn, ve, vd, latitude, height,</span>
                oldFrame, result);
<span class="fc" id="L1467">    }</span>

    /**
     * Estimates body kinematics (specific force applied to a body and its angular rates)
     * with respect ECEF frame and resolved along body-frame axes, averaged over time interval.
     *
     * @param timeInterval time interval between epochs expressed in seconds (s).
     * @param frame        NED frame containing current position, velocity and body-to-NED coordinate transformation.
     * @param oldFrame     NED frame containing previous position, velocity and body-to-NED coordinate transformation.
     * @param result       instance where estimated body kinematics will be stored.
     * @throws IllegalArgumentException if provided time interval is negative.
     */
    public static void estimateKinematics(final double timeInterval,
                                          final NEDFrame frame, final NEDFrame oldFrame,
                                          final ECEFKinematics result) {
<span class="fc" id="L1482">        estimateKinematics(timeInterval, frame.getCoordinateTransformation(),</span>
<span class="fc" id="L1483">                frame.getVn(), frame.getVe(), frame.getVd(),</span>
<span class="fc" id="L1484">                frame.getLatitude(), frame.getHeight(), oldFrame, result);</span>
<span class="fc" id="L1485">    }</span>

    /**
     * Estimates body kinematics (specific force applied to a body and its angular rates)
     * with respect ECEF frame and resolved along body-frame axes, averaged over time interval.
     *
     * @param timeInterval time interval between epochs.
     * @param frame        NED frame containing current position, velocity and body-to-NED coordinate transformation.
     * @param oldFrame     NED frame containing previous position, velocity and body-to-NED coordinate transformation.
     * @param result       instance where estimated body kinematics will be stored.
     * @throws IllegalArgumentException if provided time interval is negative.
     */
    public static void estimateKinematics(final Time timeInterval,
                                          final NEDFrame frame, final NEDFrame oldFrame,
                                          final ECEFKinematics result) {
<span class="fc" id="L1500">        estimateKinematics(convertTime(timeInterval), frame, oldFrame, result);</span>
<span class="fc" id="L1501">    }</span>

    /**
     * Estimates body kinematics (specific force applied to a body and its angular rates)
     * with respect ECEF frame and resolved along body-frame axes, averaged over time interval.
     *
     * @param timeInterval time interval between epochs expressed in seconds (s).
     * @param c            body-to-NED coordinate transformation.
     * @param oldC         previous body-to-NED coordinate transformation.
     * @param vn           north coordinate of velocity of body frame with respect ECEF frame, resolved along
     *                     north, east, and down.
     * @param ve           east coordinate of velocity of body frame with respect ECEF frame, resolved along
     *                     north, east, and down.
     * @param vd           down coordinate of velocity of body frame with respect ECEF frame, resolved along
     *                     north, east, and down.
     * @param oldVn        north coordinate of previous velocity of body frame with respect ECEF frame, resolved
     *                     along north, east, and down.
     * @param oldVe        east coordinate of previous velocity of body frame with respect ECEF frame, resolved
     *                     along north, east, and down.
     * @param oldVd        down coordinate of previous velocity of body frame with respect ECEF frame, resolved
     *                     along north, east, and down.
     * @param latitude     current latitude expressed in radians (rad).
     * @param height       current height expressed in meters (m).
     * @param oldLatitude  previous latitude expressed in radians (rad).
     * @param oldHeight    previous height expressed in meters (m).
     * @param result       instance where estimated body kinematics will be stored.
     * @throws IllegalArgumentException if provided time interval is negative or coordinate transformation
     *                                  matrices are not NED frame valid.
     */
    public static void estimateKinematics(final double timeInterval,
                                          final CoordinateTransformation c,
                                          final CoordinateTransformation oldC,
                                          final Speed vn, final Speed ve, final Speed vd,
                                          final Speed oldVn, final Speed oldVe, final Speed oldVd,
                                          final double latitude, final double height,
                                          final double oldLatitude, final double oldHeight,
                                          final ECEFKinematics result) {
<span class="fc" id="L1538">        estimateKinematics(timeInterval, c, oldC, convertSpeed(vn), convertSpeed(ve),</span>
<span class="fc" id="L1539">                convertSpeed(vd), convertSpeed(oldVn), convertSpeed(oldVe),</span>
<span class="fc" id="L1540">                convertSpeed(oldVd), latitude, height, oldLatitude, oldHeight, result);</span>
<span class="fc" id="L1541">    }</span>

    /**
     * Estimates body kinematics (specific force applied to a body and its angular rates)
     * with respect ECEF frame and resolved along body-frame axes, averaged over time interval.
     *
     * @param timeInterval time interval between epochs.
     * @param c            body-to-NED coordinate transformation.
     * @param oldC         previous body-to-NED coordinate transformation.
     * @param vn           north coordinate of velocity of body frame with respect ECEF frame, resolved along
     *                     north, east, and down.
     * @param ve           east coordinate of velocity of body frame with respect ECEF frame, resolved along
     *                     north, east, and down.
     * @param vd           down coordinate of velocity of body frame with respect ECEF frame, resolved along
     *                     north, east, and down.
     * @param oldVn        north coordinate of previous velocity of body frame with respect ECEF frame, resolved
     *                     along north, east, and down.
     * @param oldVe        east coordinate of previous velocity of body frame with respect ECEF frame, resolved
     *                     along north, east, and down.
     * @param oldVd        down coordinate of previous velocity of body frame with respect ECEF frame, resolved
     *                     along north, east, and down.
     * @param latitude     current latitude expressed in radians (rad).
     * @param height       current height expressed in meters (m).
     * @param oldLatitude  previous latitude expressed in radians (rad).
     * @param oldHeight    previous height expressed in meters (m).
     * @param result       instance where estimated body kinematics will be stored.
     * @throws IllegalArgumentException if provided time interval is negative or coordinate transformation
     *                                  matrices are not NED frame valid.
     */
    public static void estimateKinematics(final Time timeInterval,
                                          final CoordinateTransformation c,
                                          final CoordinateTransformation oldC,
                                          final Speed vn, final Speed ve, final Speed vd,
                                          final Speed oldVn, final Speed oldVe, final Speed oldVd,
                                          final double latitude, final double height,
                                          final double oldLatitude, final double oldHeight,
                                          final ECEFKinematics result) {
<span class="fc" id="L1578">        estimateKinematics(convertTime(timeInterval), c, oldC, vn, ve, vd, oldVn, oldVe, oldVd,</span>
                latitude, height, oldLatitude, oldHeight, result);
<span class="fc" id="L1580">    }</span>

    /**
     * Estimates body kinematics (specific force applied to a body and its angular rates)
     * with respect ECEF frame and resolved along body-frame axes, averaged over time interval.
     *
     * @param timeInterval time interval between epochs expressed in seconds (s).
     * @param c            body-to-NED coordinate transformation.
     * @param oldC         previous body-to-NED coordinate transformation.
     * @param vn           north coordinate of velocity of body frame with respect ECEF frame, resolved along
     *                     north, east, and down and expressed in meters per second (m/s).
     * @param ve           east coordinate of velocity of body frame with respect ECEF frame, resolved along
     *                     north, east, and down and expressed in meters per second (m/s).
     * @param vd           down coordinate of velocity of body frame with respect ECEF frame, resolved along
     *                     north, east, and down and expressed in meters per second (m/s).
     * @param oldVn        north coordinate of previous velocity of body frame with respect ECEF frame, resolved
     *                     along north, east, and down and expressed in meters per second (m/s).
     * @param oldVe        east coordinate of previous velocity of body frame with respect ECEF frame, resolved
     *                     along north, east, and down and expressed in meters per second (m/s).
     * @param oldVd        down coordinate of previous velocity of body frame with respect ECEF frame, resolved
     *                     along north, east, and down and expressed in meters per second (m/s).
     * @param latitude     current latitude.
     * @param height       current height expressed in meters (m).
     * @param oldLatitude  previous latitude.
     * @param oldHeight    previous height expressed in meters (m).
     * @param result       instance where estimated body kinematics will be stored.
     * @throws IllegalArgumentException if provided time interval is negative or coordinate transformation
     *                                  matrices are not NED frame valid.
     */
    public static void estimateKinematics(final double timeInterval,
                                          final CoordinateTransformation c,
                                          final CoordinateTransformation oldC,
                                          final double vn, final double ve, final double vd,
                                          final double oldVn, final double oldVe, final double oldVd,
                                          final Angle latitude, final double height,
                                          final Angle oldLatitude, final double oldHeight,
                                          final ECEFKinematics result) {
<span class="fc" id="L1617">        estimateKinematics(timeInterval, c, oldC, vn, ve, vd, oldVn, oldVe, oldVd,</span>
<span class="fc" id="L1618">                convertAngle(latitude), height, convertAngle(oldLatitude), oldHeight,</span>
                result);
<span class="fc" id="L1620">    }</span>

    /**
     * Estimates body kinematics (specific force applied to a body and its angular rates)
     * with respect ECEF frame and resolved along body-frame axes, averaged over time interval.
     *
     * @param timeInterval time interval between epochs.
     * @param c            body-to-NED coordinate transformation.
     * @param oldC         previous body-to-NED coordinate transformation.
     * @param vn           north coordinate of velocity of body frame with respect ECEF frame, resolved along
     *                     north, east, and down and expressed in meters per second (m/s).
     * @param ve           east coordinate of velocity of body frame with respect ECEF frame, resolved along
     *                     north, east, and down and expressed in meters per second (m/s).
     * @param vd           down coordinate of velocity of body frame with respect ECEF frame, resolved along
     *                     north, east, and down and expressed in meters per second (m/s).
     * @param oldVn        north coordinate of previous velocity of body frame with respect ECEF frame, resolved
     *                     along north, east, and down and expressed in meters per second (m/s).
     * @param oldVe        east coordinate of previous velocity of body frame with respect ECEF frame, resolved
     *                     along north, east, and down and expressed in meters per second (m/s).
     * @param oldVd        down coordinate of previous velocity of body frame with respect ECEF frame, resolved
     *                     along north, east, and down and expressed in meters per second (m/s).
     * @param latitude     current latitude.
     * @param height       current height expressed in meters (m).
     * @param oldLatitude  previous latitude.
     * @param oldHeight    previous height expressed in meters (m).
     * @param result       instance where estimated body kinematics will be stored.
     * @throws IllegalArgumentException if provided time interval is negative or coordinate transformation
     *                                  matrices are not NED frame valid.
     */
    public static void estimateKinematics(final Time timeInterval,
                                          final CoordinateTransformation c,
                                          final CoordinateTransformation oldC,
                                          final double vn, final double ve, final double vd,
                                          final double oldVn, final double oldVe, final double oldVd,
                                          final Angle latitude, final double height,
                                          final Angle oldLatitude, final double oldHeight,
                                          final ECEFKinematics result) {
<span class="fc" id="L1657">        estimateKinematics(convertTime(timeInterval), c, oldC, vn, ve, vd, oldVn, oldVe, oldVd,</span>
                latitude, height, oldLatitude, oldHeight, result);
<span class="fc" id="L1659">    }</span>

    /**
     * Estimates body kinematics (specific force applied to a body and its angular rates)
     * with respect ECEF frame and resolved along body-frame axes, averaged over time interval.
     *
     * @param timeInterval time interval between epochs expressed in seconds (s).
     * @param c            body-to-NED coordinate transformation.
     * @param oldC         previous body-to-NED coordinate transformation.
     * @param vn           north coordinate of velocity of body frame with respect ECEF frame, resolved along
     *                     north, east, and down and expressed in meters per second (m/s).
     * @param ve           east coordinate of velocity of body frame with respect ECEF frame, resolved along
     *                     north, east, and down and expressed in meters per second (m/s).
     * @param vd           down coordinate of velocity of body frame with respect ECEF frame, resolved along
     *                     north, east, and down and expressed in meters per second (m/s).
     * @param oldVn        north coordinate of previous velocity of body frame with respect ECEF frame, resolved
     *                     along north, east, and down and expressed in meters per second (m/s).
     * @param oldVe        east coordinate of previous velocity of body frame with respect ECEF frame, resolved
     *                     along north, east, and down and expressed in meters per second (m/s).
     * @param oldVd        down coordinate of previous velocity of body frame with respect ECEF frame, resolved
     *                     along north, east, and down and expressed in meters per second (m/s).
     * @param latitude     current latitude expressed in radians (rad).
     * @param height       current height.
     * @param oldLatitude  previous latitude expressed in radians (rad).
     * @param oldHeight    previous height.
     * @param result       instance where estimated body kinematics will be stored.
     * @throws IllegalArgumentException if provided time interval is negative or coordinate transformation
     *                                  matrices are not NED frame valid.
     */
    public static void estimateKinematics(final double timeInterval,
                                          final CoordinateTransformation c,
                                          final CoordinateTransformation oldC,
                                          final double vn, final double ve, final double vd,
                                          final double oldVn, final double oldVe, final double oldVd,
                                          final double latitude, final Distance height,
                                          final double oldLatitude, final Distance oldHeight,
                                          final ECEFKinematics result) {
<span class="fc" id="L1696">        estimateKinematics(timeInterval, c, oldC, vn, ve, vd, oldVn, oldVe, oldVd,</span>
<span class="fc" id="L1697">                latitude, convertDistance(height), oldLatitude,</span>
<span class="fc" id="L1698">                convertDistance(oldHeight), result);</span>
<span class="fc" id="L1699">    }</span>

    /**
     * Estimates body kinematics (specific force applied to a body and its angular rates)
     * with respect ECEF frame and resolved along body-frame axes, averaged over time interval.
     *
     * @param timeInterval time interval between epochs.
     * @param c            body-to-NED coordinate transformation.
     * @param oldC         previous body-to-NED coordinate transformation.
     * @param vn           north coordinate of velocity of body frame with respect ECEF frame, resolved along
     *                     north, east, and down and expressed in meters per second (m/s).
     * @param ve           east coordinate of velocity of body frame with respect ECEF frame, resolved along
     *                     north, east, and down and expressed in meters per second (m/s).
     * @param vd           down coordinate of velocity of body frame with respect ECEF frame, resolved along
     *                     north, east, and down and expressed in meters per second (m/s).
     * @param oldVn        north coordinate of previous velocity of body frame with respect ECEF frame, resolved
     *                     along north, east, and down and expressed in meters per second (m/s).
     * @param oldVe        east coordinate of previous velocity of body frame with respect ECEF frame, resolved
     *                     along north, east, and down and expressed in meters per second (m/s).
     * @param oldVd        down coordinate of previous velocity of body frame with respect ECEF frame, resolved
     *                     along north, east, and down and expressed in meters per second (m/s).
     * @param latitude     current latitude expressed in radians (rad).
     * @param height       current height.
     * @param oldLatitude  previous latitude expressed in radians (rad).
     * @param oldHeight    previous height.
     * @param result       instance where estimated body kinematics will be stored.
     * @throws IllegalArgumentException if provided time interval is negative or coordinate transformation
     *                                  matrices are not NED frame valid.
     */
    public static void estimateKinematics(final Time timeInterval,
                                          final CoordinateTransformation c,
                                          final CoordinateTransformation oldC,
                                          final double vn, final double ve, final double vd,
                                          final double oldVn, final double oldVe, final double oldVd,
                                          final double latitude, final Distance height,
                                          final double oldLatitude, final Distance oldHeight,
                                          final ECEFKinematics result) {
<span class="fc" id="L1736">        estimateKinematics(convertTime(timeInterval), c, oldC, vn, ve, vd, oldVn,</span>
                oldVe, oldVd, latitude, height, oldLatitude, oldHeight, result);
<span class="fc" id="L1738">    }</span>

    /**
     * Estimates body kinematics (specific force applied to a body and its angular rates)
     * with respect ECEF frame and resolved along body-frame axes, averaged over time interval.
     *
     * @param timeInterval time interval between epochs expressed in seconds (s).
     * @param c            body-to-NED coordinate transformation.
     * @param oldC         previous body-to-NED coordinate transformation.
     * @param vn           north coordinate of velocity of body frame with respect ECEF frame, resolved along
     *                     north, east, and down.
     * @param ve           east coordinate of velocity of body frame with respect ECEF frame, resolved along
     *                     north, east, and down.
     * @param vd           down coordinate of velocity of body frame with respect ECEF frame, resolved along
     *                     north, east, and down.
     * @param oldVn        north coordinate of previous velocity of body frame with respect ECEF frame, resolved
     *                     along north, east, and down.
     * @param oldVe        east coordinate of previous velocity of body frame with respect ECEF frame, resolved
     *                     along north, east, and down.
     * @param oldVd        down coordinate of previous velocity of body frame with respect ECEF frame, resolved
     *                     along north, east, and down.
     * @param latitude     current latitude.
     * @param height       current height.
     * @param oldLatitude  previous latitude.
     * @param oldHeight    previous height.
     * @param result       instance where estimated body kinematics will be stored.
     * @throws IllegalArgumentException if provided time interval is negative or coordinate transformation
     *                                  matrices are not NED frame valid.
     */
    public static void estimateKinematics(final double timeInterval,
                                          final CoordinateTransformation c,
                                          final CoordinateTransformation oldC,
                                          final Speed vn, final Speed ve, final Speed vd,
                                          final Speed oldVn, final Speed oldVe, final Speed oldVd,
                                          final Angle latitude, final Distance height,
                                          final Angle oldLatitude, final Distance oldHeight,
                                          final ECEFKinematics result) {
<span class="fc" id="L1775">        estimateKinematics(timeInterval, c, oldC, convertSpeed(vn), convertSpeed(ve),</span>
<span class="fc" id="L1776">                convertSpeed(vd), convertSpeed(oldVn), convertSpeed(oldVe),</span>
<span class="fc" id="L1777">                convertSpeed(oldVd), convertAngle(latitude), convertDistance(height),</span>
<span class="fc" id="L1778">                convertAngle(oldLatitude), convertDistance(oldHeight), result);</span>
<span class="fc" id="L1779">    }</span>

    /**
     * Estimates body kinematics (specific force applied to a body and its angular rates)
     * with respect ECEF frame and resolved along body-frame axes, averaged over time interval.
     *
     * @param timeInterval time interval between epochs.
     * @param c            body-to-NED coordinate transformation.
     * @param oldC         previous body-to-NED coordinate transformation.
     * @param vn           north coordinate of velocity of body frame with respect ECEF frame, resolved along
     *                     north, east, and down.
     * @param ve           east coordinate of velocity of body frame with respect ECEF frame, resolved along
     *                     north, east, and down.
     * @param vd           down coordinate of velocity of body frame with respect ECEF frame, resolved along
     *                     north, east, and down.
     * @param oldVn        north coordinate of previous velocity of body frame with respect ECEF frame, resolved
     *                     along north, east, and down.
     * @param oldVe        east coordinate of previous velocity of body frame with respect ECEF frame, resolved
     *                     along north, east, and down.
     * @param oldVd        down coordinate of previous velocity of body frame with respect ECEF frame, resolved
     *                     along north, east, and down.
     * @param latitude     current latitude.
     * @param height       current height.
     * @param oldLatitude  previous latitude.
     * @param oldHeight    previous height.
     * @param result       instance where estimated body kinematics will be stored.
     * @throws IllegalArgumentException if provided time interval is negative or coordinate transformation
     *                                  matrices are not NED frame valid.
     */
    public static void estimateKinematics(final Time timeInterval,
                                          final CoordinateTransformation c,
                                          final CoordinateTransformation oldC,
                                          final Speed vn, final Speed ve, final Speed vd,
                                          final Speed oldVn, final Speed oldVe, final Speed oldVd,
                                          final Angle latitude, final Distance height,
                                          final Angle oldLatitude, final Distance oldHeight,
                                          final ECEFKinematics result) {
<span class="fc" id="L1816">        estimateKinematics(convertTime(timeInterval), c, oldC, vn, ve, vd, oldVn, oldVe,</span>
                oldVd, latitude, height, oldLatitude, oldHeight, result);
<span class="fc" id="L1818">    }</span>

    /**
     * Estimates body kinematics (specific force applied to a body and its angular rates)
     * with respect ECEF frame and resolved along body-frame axes, averaged over time interval.
     *
     * @param timeInterval time interval between epochs expressed in seconds (s).
     * @param c            body-to-NED coordinate transformation.
     * @param oldC         previous body-to-NED coordinate transformation.
     * @param vn           north coordinate of velocity of body frame with respect ECEF frame, resolved along
     *                     north, east, and down and expressed in meters per second (m/s).
     * @param ve           east coordinate of velocity of body frame with respect ECEF frame, resolved along
     *                     north, east, and down and expressed in meters per second (m/s).
     * @param vd           down coordinate of velocity of body frame with respect ECEF frame, resolved along
     *                     north, east, and down and expressed in meters per second (m/s).
     * @param oldVn        north coordinate of previous velocity of body frame with respect ECEF frame, resolved
     *                     along north, east, and down and expressed in meters per second (m/s).
     * @param oldVe        east coordinate of previous velocity of body frame with respect ECEF frame, resolved
     *                     along north, east, and down and expressed in meters per second (m/s).
     * @param oldVd        down coordinate of previous velocity of body frame with respect ECEF frame, resolved
     *                     along north, east, and down and expressed in meters per second (m/s).
     * @param latitude     current latitude expressed in radians (rad).
     * @param height       current height expressed in meters (m).
     * @param oldLatitude  previous latitude expressed in radians (rad).
     * @param oldHeight    previous height expressed in meters (m).
     * @return a new body kinematics instance.
     * @throws IllegalArgumentException if provided time interval is negative or coordinate transformation
     *                                  matrices are not NED frame valid.
     */
    public static ECEFKinematics estimateKinematicsAndReturnNew(final double timeInterval,
                                                                final CoordinateTransformation c,
                                                                final CoordinateTransformation oldC,
                                                                final double vn, final double ve, final double vd,
                                                                final double oldVn, final double oldVe, final double oldVd,
                                                                final double latitude, final double height,
                                                                final double oldLatitude, final double oldHeight) {
<span class="fc" id="L1854">        final ECEFKinematics result = new ECEFKinematics();</span>
<span class="fc" id="L1855">        estimateKinematics(timeInterval, c, oldC, vn, ve, vd, oldVn, oldVe, oldVd,</span>
                latitude, height, oldLatitude, oldHeight, result);
<span class="fc" id="L1857">        return result;</span>
    }

    /**
     * Estimates body kinematics (specific force applied to a body and its angular rates)
     * with respect ECEF frame and resolved along body-frame axes, averaged over time interval.
     *
     * @param timeInterval time interval between epochs.
     * @param c            body-to-NED coordinate transformation.
     * @param oldC         previous body-to-NED coordinate transformation.
     * @param vn           north coordinate of velocity of body frame with respect ECEF frame, resolved along
     *                     north, east, and down and expressed in meters per second (m/s).
     * @param ve           east coordinate of velocity of body frame with respect ECEF frame, resolved along
     *                     north, east, and down and expressed in meters per second (m/s).
     * @param vd           down coordinate of velocity of body frame with respect ECEF frame, resolved along
     *                     north, east, and down and expressed in meters per second (m/s).
     * @param oldVn        north coordinate of previous velocity of body frame with respect ECEF frame, resolved
     *                     along north, east, and down and expressed in meters per second (m/s).
     * @param oldVe        east coordinate of previous velocity of body frame with respect ECEF frame, resolved
     *                     along north, east, and down and expressed in meters per second (m/s).
     * @param oldVd        down coordinate of previous velocity of body frame with respect ECEF frame, resolved
     *                     along north, east, and down and expressed in meters per second (m/s).
     * @param latitude     current latitude expressed in radians (rad).
     * @param height       current height expressed in meters (m).
     * @param oldLatitude  previous latitude expressed in radians (rad).
     * @param oldHeight    previous height expressed in meters (m).
     * @return a new body kinematics instance.
     * @throws IllegalArgumentException if provided time interval is negative or coordinate transformation
     *                                  matrices are not NED frame valid.
     */
    public static ECEFKinematics estimateKinematicsAndReturnNew(final Time timeInterval,
                                                                final CoordinateTransformation c,
                                                                final CoordinateTransformation oldC,
                                                                final double vn, final double ve, final double vd,
                                                                final double oldVn, final double oldVe, final double oldVd,
                                                                final double latitude, final double height,
                                                                final double oldLatitude, final double oldHeight) {
<span class="fc" id="L1894">        final ECEFKinematics result = new ECEFKinematics();</span>
<span class="fc" id="L1895">        estimateKinematics(timeInterval, c, oldC, vn, ve, vd, oldVn, oldVe, oldVd,</span>
                latitude, height, oldLatitude, oldHeight, result);
<span class="fc" id="L1897">        return result;</span>
    }

    /**
     * Estimates body kinematics (specific force applied to a body and its angular rates)
     * with respect ECEF frame and resolved along body-frame axes, averaged over time interval.
     *
     * @param timeInterval time interval between epochs expressed in seconds (s).
     * @param frame        NED frame containing current position, velocity and body-to-NED coordinate transformation.
     * @param oldC         previous body-to-NED coordinate transformation.
     * @param oldVn        north coordinate of previous velocity of body frame with respect ECEF frame, resolved
     *                     along north, east, and down and expressed in meters per second (m/s).
     * @param oldVe        east coordinate of previous velocity of body frame with respect ECEF frame, resolved
     *                     along north, east, and down and expressed in meters per second (m/s).
     * @param oldVd        down coordinate of previous velocity of body frame with respect ECEF frame, resolved
     *                     along north, east, and down and expressed in meters per second (m/s).
     * @param oldLatitude  previous latitude expressed in radians (rad).
     * @param oldHeight    previous height expressed in meters (m).
     * @return a new body kinematics instance.
     * @throws IllegalArgumentException if provided time interval is negative or coordinate transformation
     *                                  matrices are not NED frame valid.
     */
    public static ECEFKinematics estimateKinematicsAndReturnNew(final double timeInterval,
                                                                final NEDFrame frame,
                                                                final CoordinateTransformation oldC,
                                                                final double oldVn, final double oldVe, final double oldVd,
                                                                final double oldLatitude, final double oldHeight) {
<span class="fc" id="L1924">        final ECEFKinematics result = new ECEFKinematics();</span>
<span class="fc" id="L1925">        estimateKinematics(timeInterval, frame, oldC, oldVn, oldVe, oldVd,</span>
                oldLatitude, oldHeight, result);
<span class="fc" id="L1927">        return result;</span>
    }

    /**
     * Estimates body kinematics (specific force applied to a body and its angular rates)
     * with respect ECEF frame and resolved along body-frame axes, averaged over time interval.
     *
     * @param timeInterval time interval between epochs.
     * @param frame        NED frame containing current position, velocity and body-to-NED coordinate transformation.
     * @param oldC         previous body-to-NED coordinate transformation.
     * @param oldVn        north coordinate of previous velocity of body frame with respect ECEF frame, resolved
     *                     along north, east, and down and expressed in meters per second (m/s).
     * @param oldVe        east coordinate of previous velocity of body frame with respect ECEF frame, resolved
     *                     along north, east, and down and expressed in meters per second (m/s).
     * @param oldVd        down coordinate of previous velocity of body frame with respect ECEF frame, resolved
     *                     along north, east, and down and expressed in meters per second (m/s).
     * @param oldLatitude  previous latitude expressed in radians (rad).
     * @param oldHeight    previous height expressed in meters (m).
     * @return a new body kinematics instance.
     * @throws IllegalArgumentException if provided time interval is negative or coordinate transformation
     *                                  matrices are not NED frame valid.
     */
    public static ECEFKinematics estimateKinematicsAndReturnNew(final Time timeInterval,
                                                                final NEDFrame frame,
                                                                final CoordinateTransformation oldC,
                                                                final double oldVn, final double oldVe, final double oldVd,
                                                                final double oldLatitude, final double oldHeight) {
<span class="fc" id="L1954">        final ECEFKinematics result = new ECEFKinematics();</span>
<span class="fc" id="L1955">        estimateKinematics(timeInterval, frame, oldC, oldVn, oldVe, oldVd,</span>
                oldLatitude, oldHeight, result);
<span class="fc" id="L1957">        return result;</span>
    }

    /**
     * Estimates body kinematics (specific force applied to a body and its angular rates)
     * with respect ECEF frame and resolved along body-frame axes, averaged over time interval.
     *
     * @param timeInterval time interval between epochs expressed in seconds (s).
     * @param c            body-to-NED coordinate transformation.
     * @param vn           north coordinate of velocity of body frame with respect ECEF frame, resolved along
     *                     north, east, and down and expressed in meters per second (m/s).
     * @param ve           east coordinate of velocity of body frame with respect ECEF frame, resolved along
     *                     north, east, and down and expressed in meters per second (m/s).
     * @param vd           down coordinate of velocity of body frame with respect ECEF frame, resolved along
     *                     north, east, and down and expressed in meters per second (m/s).
     * @param latitude     current latitude expressed in radians (rad).
     * @param height       current height expressed in meters (m).
     * @param oldFrame     NED frame containing previous position, velocity and body-to-NED coordinate transformation.
     * @return a new body kinematics instance.
     * @throws IllegalArgumentException if provided time interval is negative or coordinate transformation
     *                                  matrices are not NED frame valid.
     */
    public static ECEFKinematics estimateKinematicsAndReturnNew(final double timeInterval,
                                                                final CoordinateTransformation c,
                                                                final double vn, final double ve, final double vd,
                                                                final double latitude, final double height,
                                                                final NEDFrame oldFrame) {
<span class="fc" id="L1984">        final ECEFKinematics result = new ECEFKinematics();</span>
<span class="fc" id="L1985">        estimateKinematics(timeInterval, c, vn, ve, vd, latitude, height, oldFrame, result);</span>
<span class="fc" id="L1986">        return result;</span>
    }

    /**
     * Estimates body kinematics (specific force applied to a body and its angular rates)
     * with respect ECEF frame and resolved along body-frame axes, averaged over time interval.
     *
     * @param timeInterval time interval between epochs.
     * @param c            body-to-NED coordinate transformation.
     * @param vn           north coordinate of velocity of body frame with respect ECEF frame, resolved along
     *                     north, east, and down and expressed in meters per second (m/s).
     * @param ve           east coordinate of velocity of body frame with respect ECEF frame, resolved along
     *                     north, east, and down and expressed in meters per second (m/s).
     * @param vd           down coordinate of velocity of body frame with respect ECEF frame, resolved along
     *                     north, east, and down and expressed in meters per second (m/s).
     * @param latitude     current latitude expressed in radians (rad).
     * @param height       current height expressed in meters (m).
     * @param oldFrame     NED frame containing previous position, velocity and body-to-NED coordinate transformation.
     * @return a new body kinematics instance.
     * @throws IllegalArgumentException if provided time interval is negative or coordinate transformation
     *                                  matrices are not NED frame valid.
     */
    public static ECEFKinematics estimateKinematicsAndReturnNew(final Time timeInterval,
                                                                final CoordinateTransformation c,
                                                                final double vn, final double ve, final double vd,
                                                                final double latitude, final double height,
                                                                final NEDFrame oldFrame) {
<span class="fc" id="L2013">        final ECEFKinematics result = new ECEFKinematics();</span>
<span class="fc" id="L2014">        estimateKinematics(timeInterval, c, vn, ve, vd, latitude, height, oldFrame,</span>
                result);
<span class="fc" id="L2016">        return result;</span>
    }

    /**
     * Estimates body kinematics (specific force applied to a body and its angular rates)
     * with respect ECEF frame and resolved along body-frame axes, averaged over time interval.
     *
     * @param timeInterval time interval between epochs expressed in seconds (s).
     * @param frame        NED frame containing current position, velocity and body-to-NED coordinate transformation.
     * @param oldFrame     NED frame containing previous position, velocity and body-to-NED coordinate transformation.
     * @return a new body kinematics instance.
     * @throws IllegalArgumentException if provided time interval is negative.
     */
    public static ECEFKinematics estimateKinematicsAndReturnNew(final double timeInterval,
                                                                final NEDFrame frame,
                                                                final NEDFrame oldFrame) {
<span class="fc" id="L2032">        final ECEFKinematics result = new ECEFKinematics();</span>
<span class="fc" id="L2033">        estimateKinematics(timeInterval, frame, oldFrame, result);</span>
<span class="fc" id="L2034">        return result;</span>
    }

    /**
     * Estimates body kinematics (specific force applied to a body and its angular rates)
     * with respect ECEF frame and resolved along body-frame axes, averaged over time interval.
     *
     * @param timeInterval time interval between epochs.
     * @param frame        NED frame containing current position, velocity and body-to-NED coordinate transformation.
     * @param oldFrame     NED frame containing previous position, velocity and body-to-NED coordinate transformation.
     * @return a new body kinematics instance.
     * @throws IllegalArgumentException if provided time interval is negative.
     */
    public static ECEFKinematics estimateKinematicsAndReturnNew(final Time timeInterval,
                                                                final NEDFrame frame,
                                                                final NEDFrame oldFrame) {
<span class="fc" id="L2050">        final ECEFKinematics result = new ECEFKinematics();</span>
<span class="fc" id="L2051">        estimateKinematics(timeInterval, frame, oldFrame, result);</span>
<span class="fc" id="L2052">        return result;</span>
    }

    /**
     * Estimates body kinematics (specific force applied to a body and its angular rates)
     * with respect ECEF frame and resolved along body-frame axes, averaged over time interval.
     *
     * @param timeInterval time interval between epochs expressed in seconds (s).
     * @param c            body-to-NED coordinate transformation.
     * @param oldC         previous body-to-NED coordinate transformation.
     * @param vn           north coordinate of velocity of body frame with respect ECEF frame, resolved along
     *                     north, east, and down.
     * @param ve           east coordinate of velocity of body frame with respect ECEF frame, resolved along
     *                     north, east, and down.
     * @param vd           down coordinate of velocity of body frame with respect ECEF frame, resolved along
     *                     north, east, and down.
     * @param oldVn        north coordinate of previous velocity of body frame with respect ECEF frame, resolved
     *                     along north, east, and down.
     * @param oldVe        east coordinate of previous velocity of body frame with respect ECEF frame, resolved
     *                     along north, east, and down.
     * @param oldVd        down coordinate of previous velocity of body frame with respect ECEF frame, resolved
     *                     along north, east, and down.
     * @param latitude     current latitude expressed in radians (rad).
     * @param height       current height expressed in meters (m).
     * @param oldLatitude  previous latitude expressed in radians (rad).
     * @param oldHeight    previous height expressed in meters (m).
     * @return a new body kinematics instance.
     * @throws IllegalArgumentException if provided time interval is negative or coordinate transformation
     *                                  matrices are not NED frame valid.
     */
    public static ECEFKinematics estimateKinematicsAndReturnNew(final double timeInterval,
                                                                final CoordinateTransformation c,
                                                                final CoordinateTransformation oldC,
                                                                final Speed vn, final Speed ve, final Speed vd,
                                                                final Speed oldVn, final Speed oldVe, final Speed oldVd,
                                                                final double latitude, final double height,
                                                                final double oldLatitude, final double oldHeight) {
<span class="fc" id="L2089">        final ECEFKinematics result = new ECEFKinematics();</span>
<span class="fc" id="L2090">        estimateKinematics(timeInterval, c, oldC, vn, ve, vd, oldVn, oldVe, oldVd,</span>
                latitude, height, oldLatitude, oldHeight, result);
<span class="fc" id="L2092">        return result;</span>
    }

    /**
     * Estimates body kinematics (specific force applied to a body and its angular rates)
     * with respect ECEF frame and resolved along body-frame axes, averaged over time interval.
     *
     * @param timeInterval time interval between epochs.
     * @param c            body-to-NED coordinate transformation.
     * @param oldC         previous body-to-NED coordinate transformation.
     * @param vn           north coordinate of velocity of body frame with respect ECEF frame, resolved along
     *                     north, east, and down.
     * @param ve           east coordinate of velocity of body frame with respect ECEF frame, resolved along
     *                     north, east, and down.
     * @param vd           down coordinate of velocity of body frame with respect ECEF frame, resolved along
     *                     north, east, and down.
     * @param oldVn        north coordinate of previous velocity of body frame with respect ECEF frame, resolved
     *                     along north, east, and down.
     * @param oldVe        east coordinate of previous velocity of body frame with respect ECEF frame, resolved
     *                     along north, east, and down.
     * @param oldVd        down coordinate of previous velocity of body frame with respect ECEF frame, resolved
     *                     along north, east, and down.
     * @param latitude     current latitude expressed in radians (rad).
     * @param height       current height expressed in meters (m).
     * @param oldLatitude  previous latitude expressed in radians (rad).
     * @param oldHeight    previous height expressed in meters (m).
     * @return a new body kinematics instance.
     * @throws IllegalArgumentException if provided time interval is negative or coordinate transformation
     *                                  matrices are not NED frame valid.
     */
    public static ECEFKinematics estimateKinematicsAndReturnNew(final Time timeInterval,
                                                                final CoordinateTransformation c,
                                                                final CoordinateTransformation oldC,
                                                                final Speed vn, final Speed ve, final Speed vd,
                                                                final Speed oldVn, final Speed oldVe, final Speed oldVd,
                                                                final double latitude, final double height,
                                                                final double oldLatitude, final double oldHeight) {
<span class="fc" id="L2129">        final ECEFKinematics result = new ECEFKinematics();</span>
<span class="fc" id="L2130">        estimateKinematics(timeInterval, c, oldC, vn, ve, vd, oldVn, oldVe, oldVd,</span>
                latitude, height, oldLatitude, oldHeight, result);
<span class="fc" id="L2132">        return result;</span>
    }

    /**
     * Estimates body kinematics (specific force applied to a body and its angular rates)
     * with respect ECEF frame and resolved along body-frame axes, averaged over time interval.
     *
     * @param timeInterval time interval between epochs expressed in seconds (s).
     * @param c            body-to-NED coordinate transformation.
     * @param oldC         previous body-to-NED coordinate transformation.
     * @param vn           north coordinate of velocity of body frame with respect ECEF frame, resolved along
     *                     north, east, and down and expressed in meters per second (m/s).
     * @param ve           east coordinate of velocity of body frame with respect ECEF frame, resolved along
     *                     north, east, and down and expressed in meters per second (m/s).
     * @param vd           down coordinate of velocity of body frame with respect ECEF frame, resolved along
     *                     north, east, and down and expressed in meters per second (m/s).
     * @param oldVn        north coordinate of previous velocity of body frame with respect ECEF frame, resolved
     *                     along north, east, and down and expressed in meters per second (m/s).
     * @param oldVe        east coordinate of previous velocity of body frame with respect ECEF frame, resolved
     *                     along north, east, and down and expressed in meters per second (m/s).
     * @param oldVd        down coordinate of previous velocity of body frame with respect ECEF frame, resolved
     *                     along north, east, and down and expressed in meters per second (m/s).
     * @param latitude     current latitude.
     * @param height       current height expressed in meters (m).
     * @param oldLatitude  previous latitude.
     * @param oldHeight    previous height expressed in meters (m).
     * @return a new body kinematics instance.
     * @throws IllegalArgumentException if provided time interval is negative or coordinate transformation
     *                                  matrices are not NED frame valid.
     */
    public static ECEFKinematics estimateKinematicsAndReturnNew(final double timeInterval,
                                                                final CoordinateTransformation c,
                                                                final CoordinateTransformation oldC,
                                                                final double vn, final double ve, final double vd,
                                                                final double oldVn, final double oldVe, final double oldVd,
                                                                final Angle latitude, final double height,
                                                                final Angle oldLatitude, final double oldHeight) {
<span class="fc" id="L2169">        final ECEFKinematics result = new ECEFKinematics();</span>
<span class="fc" id="L2170">        estimateKinematics(timeInterval, c, oldC, vn, ve, vd, oldVn, oldVe, oldVd,</span>
                latitude, height, oldLatitude, oldHeight, result);
<span class="fc" id="L2172">        return result;</span>
    }

    /**
     * Estimates body kinematics (specific force applied to a body and its angular rates)
     * with respect ECEF frame and resolved along body-frame axes, averaged over time interval.
     *
     * @param timeInterval time interval between epochs.
     * @param c            body-to-NED coordinate transformation.
     * @param oldC         previous body-to-NED coordinate transformation.
     * @param vn           north coordinate of velocity of body frame with respect ECEF frame, resolved along
     *                     north, east, and down and expressed in meters per second (m/s).
     * @param ve           east coordinate of velocity of body frame with respect ECEF frame, resolved along
     *                     north, east, and down and expressed in meters per second (m/s).
     * @param vd           down coordinate of velocity of body frame with respect ECEF frame, resolved along
     *                     north, east, and down and expressed in meters per second (m/s).
     * @param oldVn        north coordinate of previous velocity of body frame with respect ECEF frame, resolved
     *                     along north, east, and down and expressed in meters per second (m/s).
     * @param oldVe        east coordinate of previous velocity of body frame with respect ECEF frame, resolved
     *                     along north, east, and down and expressed in meters per second (m/s).
     * @param oldVd        down coordinate of previous velocity of body frame with respect ECEF frame, resolved
     *                     along north, east, and down and expressed in meters per second (m/s).
     * @param latitude     current latitude.
     * @param height       current height expressed in meters (m).
     * @param oldLatitude  previous latitude.
     * @param oldHeight    previous height expressed in meters (m).
     * @return a new body kinematics instance.
     * @throws IllegalArgumentException if provided time interval is negative or coordinate transformation
     *                                  matrices are not NED frame valid.
     */
    public static ECEFKinematics estimateKinematicsAndReturnNew(final Time timeInterval,
                                                                final CoordinateTransformation c,
                                                                final CoordinateTransformation oldC,
                                                                final double vn, final double ve, final double vd,
                                                                final double oldVn, final double oldVe, final double oldVd,
                                                                final Angle latitude, final double height,
                                                                final Angle oldLatitude, final double oldHeight) {
<span class="fc" id="L2209">        final ECEFKinematics result = new ECEFKinematics();</span>
<span class="fc" id="L2210">        estimateKinematics(timeInterval, c, oldC, vn, ve, vd, oldVn, oldVe, oldVd,</span>
                latitude, height, oldLatitude, oldHeight, result);
<span class="fc" id="L2212">        return result;</span>
    }

    /**
     * Estimates body kinematics (specific force applied to a body and its angular rates)
     * with respect ECEF frame and resolved along body-frame axes, averaged over time interval.
     *
     * @param timeInterval time interval between epochs expressed in seconds (s).
     * @param c            body-to-NED coordinate transformation.
     * @param oldC         previous body-to-NED coordinate transformation.
     * @param vn           north coordinate of velocity of body frame with respect ECEF frame, resolved along
     *                     north, east, and down and expressed in meters per second (m/s).
     * @param ve           east coordinate of velocity of body frame with respect ECEF frame, resolved along
     *                     north, east, and down and expressed in meters per second (m/s).
     * @param vd           down coordinate of velocity of body frame with respect ECEF frame, resolved along
     *                     north, east, and down and expressed in meters per second (m/s).
     * @param oldVn        north coordinate of previous velocity of body frame with respect ECEF frame, resolved
     *                     along north, east, and down and expressed in meters per second (m/s).
     * @param oldVe        east coordinate of previous velocity of body frame with respect ECEF frame, resolved
     *                     along north, east, and down and expressed in meters per second (m/s).
     * @param oldVd        down coordinate of previous velocity of body frame with respect ECEF frame, resolved
     *                     along north, east, and down and expressed in meters per second (m/s).
     * @param latitude     current latitude expressed in radians (rad).
     * @param height       current height.
     * @param oldLatitude  previous latitude expressed in radians (rad).
     * @param oldHeight    previous height.
     * @return a new body kinematics instance.
     * @throws IllegalArgumentException if provided time interval is negative or coordinate transformation
     *                                  matrices are not NED frame valid.
     */
    public static ECEFKinematics estimateKinematicsAndReturnNew(final double timeInterval,
                                                                final CoordinateTransformation c,
                                                                final CoordinateTransformation oldC,
                                                                final double vn, final double ve, final double vd,
                                                                final double oldVn, final double oldVe, final double oldVd,
                                                                final double latitude, final Distance height,
                                                                final double oldLatitude, final Distance oldHeight) {
<span class="fc" id="L2249">        final ECEFKinematics result = new ECEFKinematics();</span>
<span class="fc" id="L2250">        estimateKinematics(timeInterval, c, oldC, vn, ve, vd, oldVn, oldVe, oldVd,</span>
                latitude, height, oldLatitude, oldHeight, result);
<span class="fc" id="L2252">        return result;</span>
    }

    /**
     * Estimates body kinematics (specific force applied to a body and its angular rates)
     * with respect ECEF frame and resolved along body-frame axes, averaged over time interval.
     *
     * @param timeInterval time interval between epochs.
     * @param c            body-to-NED coordinate transformation.
     * @param oldC         previous body-to-NED coordinate transformation.
     * @param vn           north coordinate of velocity of body frame with respect ECEF frame, resolved along
     *                     north, east, and down and expressed in meters per second (m/s).
     * @param ve           east coordinate of velocity of body frame with respect ECEF frame, resolved along
     *                     north, east, and down and expressed in meters per second (m/s).
     * @param vd           down coordinate of velocity of body frame with respect ECEF frame, resolved along
     *                     north, east, and down and expressed in meters per second (m/s).
     * @param oldVn        north coordinate of previous velocity of body frame with respect ECEF frame, resolved
     *                     along north, east, and down and expressed in meters per second (m/s).
     * @param oldVe        east coordinate of previous velocity of body frame with respect ECEF frame, resolved
     *                     along north, east, and down and expressed in meters per second (m/s).
     * @param oldVd        down coordinate of previous velocity of body frame with respect ECEF frame, resolved
     *                     along north, east, and down and expressed in meters per second (m/s).
     * @param latitude     current latitude expressed in radians (rad).
     * @param height       current height.
     * @param oldLatitude  previous latitude expressed in radians (rad).
     * @param oldHeight    previous height.
     * @return a new body kinematics instance.
     * @throws IllegalArgumentException if provided time interval is negative or coordinate transformation
     *                                  matrices are not NED frame valid.
     */
    public static ECEFKinematics estimateKinematicsAndReturnNew(final Time timeInterval,
                                                                final CoordinateTransformation c,
                                                                final CoordinateTransformation oldC,
                                                                final double vn, final double ve, final double vd,
                                                                final double oldVn, final double oldVe, final double oldVd,
                                                                final double latitude, final Distance height,
                                                                final double oldLatitude, final Distance oldHeight) {
<span class="fc" id="L2289">        final ECEFKinematics result = new ECEFKinematics();</span>
<span class="fc" id="L2290">        estimateKinematics(timeInterval, c, oldC, vn, ve, vd, oldVn, oldVe, oldVd,</span>
                latitude, height, oldLatitude, oldHeight, result);
<span class="fc" id="L2292">        return result;</span>
    }

    /**
     * Estimates body kinematics (specific force applied to a body and its angular rates)
     * with respect ECEF frame and resolved along body-frame axes, averaged over time interval.
     *
     * @param timeInterval time interval between epochs expressed in seconds (s).
     * @param c            body-to-NED coordinate transformation.
     * @param oldC         previous body-to-NED coordinate transformation.
     * @param vn           north coordinate of velocity of body frame with respect ECEF frame, resolved along
     *                     north, east, and down.
     * @param ve           east coordinate of velocity of body frame with respect ECEF frame, resolved along
     *                     north, east, and down.
     * @param vd           down coordinate of velocity of body frame with respect ECEF frame, resolved along
     *                     north, east, and down.
     * @param oldVn        north coordinate of previous velocity of body frame with respect ECEF frame, resolved
     *                     along north, east, and down.
     * @param oldVe        east coordinate of previous velocity of body frame with respect ECEF frame, resolved
     *                     along north, east, and down.
     * @param oldVd        down coordinate of previous velocity of body frame with respect ECEF frame, resolved
     *                     along north, east, and down.
     * @param latitude     current latitude.
     * @param height       current height.
     * @param oldLatitude  previous latitude.
     * @param oldHeight    previous height.
     * @return a new body kinematics instance.
     * @throws IllegalArgumentException if provided time interval is negative or coordinate transformation
     *                                  matrices are not NED frame valid.
     */
    public static ECEFKinematics estimateKinematicsAndReturnNew(final double timeInterval,
                                                                final CoordinateTransformation c,
                                                                final CoordinateTransformation oldC,
                                                                final Speed vn, final Speed ve, final Speed vd,
                                                                final Speed oldVn, final Speed oldVe, final Speed oldVd,
                                                                final Angle latitude, final Distance height,
                                                                final Angle oldLatitude, final Distance oldHeight) {
<span class="fc" id="L2329">        final ECEFKinematics result = new ECEFKinematics();</span>
<span class="fc" id="L2330">        estimateKinematics(timeInterval, c, oldC, vn, ve, vd, oldVn, oldVe, oldVd,</span>
                latitude, height, oldLatitude, oldHeight, result);
<span class="fc" id="L2332">        return result;</span>
    }

    /**
     * Estimates body kinematics (specific force applied to a body and its angular rates)
     * with respect ECEF frame and resolved along body-frame axes, averaged over time interval.
     *
     * @param timeInterval time interval between epochs.
     * @param c            body-to-NED coordinate transformation.
     * @param oldC         previous body-to-NED coordinate transformation.
     * @param vn           north coordinate of velocity of body frame with respect ECEF frame, resolved along
     *                     north, east, and down.
     * @param ve           east coordinate of velocity of body frame with respect ECEF frame, resolved along
     *                     north, east, and down.
     * @param vd           down coordinate of velocity of body frame with respect ECEF frame, resolved along
     *                     north, east, and down.
     * @param oldVn        north coordinate of previous velocity of body frame with respect ECEF frame, resolved
     *                     along north, east, and down.
     * @param oldVe        east coordinate of previous velocity of body frame with respect ECEF frame, resolved
     *                     along north, east, and down.
     * @param oldVd        down coordinate of previous velocity of body frame with respect ECEF frame, resolved
     *                     along north, east, and down.
     * @param latitude     current latitude.
     * @param height       current height.
     * @param oldLatitude  previous latitude.
     * @param oldHeight    previous height.
     * @return a new body kinematics instance.
     * @throws IllegalArgumentException if provided time interval is negative or coordinate transformation
     *                                  matrices are not NED frame valid.
     */
    public static ECEFKinematics estimateKinematicsAndReturnNew(final Time timeInterval,
                                                                final CoordinateTransformation c,
                                                                final CoordinateTransformation oldC,
                                                                final Speed vn, final Speed ve, final Speed vd,
                                                                final Speed oldVn, final Speed oldVe, final Speed oldVd,
                                                                final Angle latitude, final Distance height,
                                                                final Angle oldLatitude, final Distance oldHeight) {
<span class="fc" id="L2369">        final ECEFKinematics result = new ECEFKinematics();</span>
<span class="fc" id="L2370">        estimateKinematics(timeInterval, c, oldC, vn, ve, vd, oldVn, oldVe, oldVd,</span>
                latitude, height, oldLatitude, oldHeight, result);
<span class="fc" id="L2372">        return result;</span>
    }

    /**
     * Converts a time instance into seconds.
     *
     * @param time time to be converted.
     * @return time value expressed in seconds.
     */
    private static double convertTime(final Time time) {
<span class="fc" id="L2382">        return TimeConverter.convert(time.getValue().doubleValue(), time.getUnit(),</span>
                TimeUnit.SECOND);
    }

    /**
     * Converts a speed instance into meters per second.
     *
     * @param speed speed to be converted.
     * @return speed value expressed in meters per second.
     */
    private static double convertSpeed(final Speed speed) {
<span class="fc" id="L2393">        return SpeedConverter.convert(speed.getValue().doubleValue(), speed.getUnit(),</span>
                SpeedUnit.METERS_PER_SECOND);
    }

    /**
     * Converts an angle instance into radians.
     *
     * @param angle angle to be converted.
     * @return angle value expressed in radians.
     */
    private static double convertAngle(final Angle angle) {
<span class="fc" id="L2404">        return AngleConverter.convert(angle.getValue().doubleValue(), angle.getUnit(),</span>
                AngleUnit.RADIANS);
    }

    /**
     * Converts a distance instance into meters.
     *
     * @param distance distance to be converted.
     * @return distance value expressed in meters.
     */
    private static double convertDistance(final Distance distance) {
<span class="fc" id="L2415">        return DistanceConverter.convert(distance.getValue().doubleValue(),</span>
<span class="fc" id="L2416">                distance.getUnit(), DistanceUnit.METER);</span>
    }
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.2.201808211720</span></div></body></html>